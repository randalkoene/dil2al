<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>finances.cc File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>finances.cc File Reference</h1><code>#include "<a class="el" href="dil2al_8hh-source.html">dil2al.hh</a>"</code><br>

<p>
<a href="finances_8cc-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top>bool&nbsp;</td><td valign=bottom><a class="el" href="finances_8cc.html#a0">read_financial_notes_file</a> (<a class="el" href="classPLLRoot.html">PLLRoot</a>&lt; <a class="el" href="classFinancial__Note.html">Financial_Note</a> &gt; &amp;fnotes, <a class="el" href="classString.html">String</a> &amp;finnotestop, <a class="el" href="classString.html">String</a> &amp;finnotesend)</td></tr>
<tr><td nowrap align=right valign=top>bool&nbsp;</td><td valign=bottom><a class="el" href="finances_8cc.html#a1">write_financial_notes_file</a> (<a class="el" href="classPLLRoot.html">PLLRoot</a>&lt; <a class="el" href="classFinancial__Note.html">Financial_Note</a> &gt; &amp;fnotes, <a class="el" href="classString.html">String</a> &amp;finnotestop, <a class="el" href="classString.html">String</a> &amp;finnotesend)</td></tr>
<tr><td nowrap align=right valign=top>bool&nbsp;</td><td valign=bottom><a class="el" href="finances_8cc.html#a2">financial_notes</a> ()</td></tr>
<tr><td nowrap align=right valign=top>bool&nbsp;</td><td valign=bottom><a class="el" href="finances_8cc.html#a3">financial_monthly</a> ()</td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a name="a3" doxytag="finances.cc::financial_monthly"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool financial_monthly </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="finances_8cc-source.html#l00263">263</a> of file <a class="el" href="finances_8cc-source.html">finances.cc</a>.
<p>
References <a class="el" href="finances_8cc-source.html#l00227">Financial_Monthly_Root::add</a>(), <a class="el" href="templates_8classic_8hh-source.html#l00086">PLLRoot&lt; PLLType &gt;::head</a>(), <a class="el" href="templates_8classic_8hh-source.html#l00342">PLL_LOOP_FORWARD</a>, <a class="el" href="finances_8cc-source.html#l00242">Financial_Monthly_Root::put_results</a>(), <a class="el" href="finances_8cc-source.html#l00082">read_financial_notes_file</a>(), and <a class="el" href="dil2al_8hh-source.html#l01407">VOUT</a>.
<p>
Referenced by <a class="el" href="dil2al_8cc-source.html#l00937">formalizer_commands</a>().
<p>
<div class="fragment"><pre>00263                          {
00264   <font class="comment">// Compute results from &lt;A HREF="../../doc/html/financial-notes.html"&gt;financial-notes.html&lt;/A&gt;.</font>
00265   <a class="code" href="classPLLRoot.html">PLLRoot&lt;Financial_Note&gt;</a> fnotes; <a class="code" href="classString.html">String</a> finnotestop, finnotesend;
00266   <font class="keywordflow">if</font> (!<a class="code" href="finances_8cc.html#a0">read_financial_notes_file</a>(fnotes,finnotestop,finnotesend)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00267   <font class="comment">// compute sums of categorized expenses that have not previously been handled</font>
00268   <a class="code" href="classFinancial__Monthly__Root.html">Financial_Monthly_Root</a> fmonthly;
00269   <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"If you wish to rely on monthly results from the Financial Notes, please\nverify that all non-variable expenses listed in bank statements are\naccounted for in the Financial Notes.\n\n"</font>;
00270   <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classFinancial__Note.html">Financial_Note</a>,fnotes.<a class="code" href="classPLLRoot.html#a2">head</a>(),1) {
00271     <font class="keywordflow">if</font> (!e-&gt;Handled()) fmonthly.<a class="code" href="classFinancial__Monthly__Root.html#a1">add</a>(*e);
00272   }
00273   <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; fmonthly.<a class="code" href="classFinancial__Monthly__Root.html#a2">put_results</a>();
00274 }
</pre></div>    </td>
  </tr>
</table>
<a name="a2" doxytag="finances.cc::financial_notes"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool financial_notes </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="finances_8cc-source.html#l00117">117</a> of file <a class="el" href="finances_8cc-source.html">finances.cc</a>.
<p>
References <a class="el" href="utilities_8cc-source.html#l01907">confirmation</a>(), <a class="el" href="BigString_8cc-source.html#l00843">String::del</a>(), <a class="el" href="BigString_8hh-source.html#l00494">String::empty</a>(), <a class="el" href="BigString_8hh-source.html#l00493">String::length</a>(), <a class="el" href="finances_8cc-source.html#l00057">Financial_Note::link_sorted</a>(), <a class="el" href="finances_8cc-source.html#l00082">read_financial_notes_file</a>(), <a class="el" href="utilities_8cc-source.html#l01882">time_stamp_time_date</a>(), <a class="el" href="dil2al_8hh-source.html#l01407">VOUT</a>, and <a class="el" href="finances_8cc-source.html#l00111">write_financial_notes_file</a>().
<p>
Referenced by <a class="el" href="dil2al_8cc-source.html#l00937">formalizer_commands</a>().
<p>
<div class="fragment"><pre>00117                        {
00118   <font class="comment">// Edit notes in &lt;A HREF="../../doc/html/financial-notes.html"&gt;financial-notes.html&lt;/A&gt;.</font>
00119   <a class="code" href="classPLLRoot.html">PLLRoot&lt;Financial_Note&gt;</a> fnotes; <a class="code" href="classString.html">String</a> finnotestop, finnotesend;
00120   <font class="keywordflow">if</font> (!<a class="code" href="finances_8cc.html#a0">read_financial_notes_file</a>(fnotes,finnotestop,finnotesend)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00121   <font class="comment">// add new notes (currently just by hand)</font>
00122   <a class="code" href="classFinancial__Note.html">Financial_Note</a> * f;
00123   time_t d; <font class="keywordtype">double</font> e; <font class="keywordtype">bool</font> h; <a class="code" href="classString.html">String</a> dstr(curdate), t, n, c;
00124   <font class="keyword">const</font> <font class="keywordtype">int</font> LLEN = 10240;
00125   <font class="keywordtype">char</font> lbuf[LLEN];
00126   d = <a class="code" href="utilities_8cc.html#a25">time_stamp_time_date</a>(dstr+<font class="stringliteral">"0000"</font>);
00127   <font class="keywordflow">while</font> (1) {
00128     <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"date ["</font> &lt;&lt; dstr &lt;&lt; <font class="stringliteral">"] (done=exit): "</font>;
00129     cin.getline(lbuf,LLEN); n = lbuf;
00130     <font class="keywordflow">if</font> (!n.<a class="code" href="classString.html#a106">empty</a>()) {
00131       <font class="keywordflow">if</font> (n==<font class="stringliteral">"done"</font>) <font class="keywordflow">break</font>;
00132       dstr = n;
00133       n += <font class="stringliteral">"0000"</font>; n.<a class="code" href="classString.html#a83">del</a>(12,n.<a class="code" href="classString.html#a105">length</a>()-12);
00134       d = <a class="code" href="utilities_8cc.html#a25">time_stamp_time_date</a>(n);
00135     }
00136     <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"expense: "</font>;
00137     cin.getline(lbuf,LLEN);
00138     e = atof(lbuf);
00139     <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"type [variable]: "</font>;
00140     cin.getline(lbuf,LLEN); t = lbuf;
00141     <font class="keywordflow">if</font> (t.<a class="code" href="classString.html#a106">empty</a>()) t = <font class="stringliteral">"variable"</font>;
00142     <font class="keywordflow">if</font> (t==<a class="code" href="classString.html">String</a>(<font class="stringliteral">"variable"</font>)) h = <font class="keyword">true</font>;
00143     <font class="keywordflow">else</font> h = !<a class="code" href="utilities_8cc.html#a28">confirmation</a>(<font class="stringliteral">"handled [n]: "</font>,<font class="charliteral">'y'</font>);
00144     <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"note: "</font>;
00145     cin.getline(lbuf,LLEN); n = lbuf;
00146     <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"comment: "</font>;
00147     cin.getline(lbuf,LLEN); c = lbuf;
00148     f = <font class="keyword">new</font> <a class="code" href="classFinancial__Note.html">Financial_Note</a>(d,e,t,h,n,c);
00149     f-&gt;<a class="code" href="classFinancial__Note.html#a5">link_sorted</a>(fnotes);
00150   }
00151   <font class="comment">// write financial notes file</font>
00152   <font class="keywordflow">return</font> <a class="code" href="finances_8cc.html#a1">write_financial_notes_file</a>(fnotes,finnotestop,finnotesend);
00153 }
</pre></div>    </td>
  </tr>
</table>
<a name="a0" doxytag="finances.cc::read_financial_notes_file"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool read_financial_notes_file </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classPLLRoot.html">PLLRoot</a>&lt; <a class="el" href="classFinancial__Note.html">Financial_Note</a> &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>fnotes</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>finnotestop</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>finnotesend</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="finances_8cc-source.html#l00082">82</a> of file <a class="el" href="finances_8cc-source.html">finances.cc</a>.
<p>
References <a class="el" href="BigString_8cc-source.html#l00896">String::before</a>(), <a class="el" href="BigString_8cc-source.html#l00843">String::del</a>(), <a class="el" href="dil2al_8hh-source.html#l01406">EOUT</a>, <a class="el" href="BigString_8cc-source.html#l00911">String::from</a>(), <a class="el" href="BigString_8hh-source.html#l01093">String::index</a>(), <a class="el" href="BigString_8hh-source.html#l00493">String::length</a>(), <a class="el" href="finances_8cc-source.html#l00057">Financial_Note::link_sorted</a>(), <a class="el" href="utilities_8cc-source.html#l02074">read_file_into_String</a>(), <a class="el" href="classString.html#s2s1">String::SEARCH_END</a>, <a class="el" href="utilities_8cc-source.html#l01824">Time</a>(), and <a class="el" href="dil2al_8hh-source.html#l01407">VOUT</a>.
<p>
Referenced by <a class="el" href="finances_8cc-source.html#l00263">financial_monthly</a>(), and <a class="el" href="finances_8cc-source.html#l00117">financial_notes</a>().
<p>
<div class="fragment"><pre>00082                                                                                                              {
00083   <a class="code" href="classString.html">String</a> finnotesstr;
00084   <font class="comment">// read financial notes file</font>
00085   <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a39">read_file_into_String</a>(finnotesfile,finnotesstr)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00086   <font class="comment">// extract financial notes table</font>
00087   <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Parsing Financial Notes file\n"</font>;
00088   <font class="keywordtype">int</font> i, j;
00089   <font class="keywordflow">if</font> ((i=finnotesstr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"&lt;!-- dil2al: start items --&gt;"</font>,<a class="code" href="classString.html#s2s1">String::SEARCH_END</a>,0))&lt;0) {
00090     <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"formalizer: Missing start of financial notes items table\n"</font>;
00091     <font class="keywordflow">return</font> <font class="keyword">false</font>;
00092   }
00093   <font class="keywordflow">if</font> ((j=finnotesstr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"&lt;!-- dil2al: end items --&gt;"</font>,0))&lt;0) {
00094     <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"formalizer: Missing end of financial notes items table\n"</font>;
00095     <font class="keywordflow">return</font> <font class="keyword">false</font>;
00096   }
00097   finnotestop = finnotesstr.<a class="code" href="classString.html#a58">before</a>(i)+<font class="charliteral">'\n'</font>;
00098   finnotesend = finnotesstr.<a class="code" href="classString.html#a70">from</a>(j);
00099   finnotesstr.<a class="code" href="classString.html#a83">del</a>(j,finnotesstr.<a class="code" href="classString.html#a105">length</a>()-j);
00100   finnotesstr.<a class="code" href="classString.html#a83">del</a>(0,i); <font class="comment">// finnotesstr contains table</font>
00101   <font class="comment">// extract financial notes items while keeping track of dates and sorting by date</font>
00102   time_t notedate = <a class="code" href="utilities_8cc.html#a19">Time</a>(NULL);
00103   <font class="keywordflow">for</font> (i=0; i&gt;=0; ) {
00104     <a class="code" href="classFinancial__Note.html">Financial_Note</a> * fn = <font class="keyword">new</font> <a class="code" href="classFinancial__Note.html">Financial_Note</a>(finnotesstr,notedate,i);
00105     <font class="keywordflow">if</font> (i&lt;0) <font class="keyword">delete</font> fn;
00106     <font class="keywordflow">else</font> fn-&gt;<a class="code" href="classFinancial__Note.html#a5">link_sorted</a>(fnotes);
00107   }
00108   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00109 }
</pre></div>    </td>
  </tr>
</table>
<a name="a1" doxytag="finances.cc::write_financial_notes_file"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool write_financial_notes_file </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classPLLRoot.html">PLLRoot</a>&lt; <a class="el" href="classFinancial__Note.html">Financial_Note</a> &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>fnotes</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>finnotestop</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>finnotesend</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="finances_8cc-source.html#l00111">111</a> of file <a class="el" href="finances_8cc-source.html">finances.cc</a>.
<p>
References <a class="el" href="templates_8classic_8hh-source.html#l00086">PLLRoot&lt; PLLType &gt;::head</a>(), <a class="el" href="templates_8classic_8hh-source.html#l00342">PLL_LOOP_FORWARD</a>, and <a class="el" href="utilities_8cc-source.html#l02116">write_file_from_String</a>().
<p>
Referenced by <a class="el" href="finances_8cc-source.html#l00117">financial_notes</a>().
<p>
<div class="fragment"><pre>00111                                                                                                               {
00112   <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classFinancial__Note.html">Financial_Note</a>,fnotes.<a class="code" href="classPLLRoot.html#a2">head</a>(),1) finnotestop += e-&gt;put();
00113   finnotestop += finnotesend;
00114   <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a41">write_file_from_String</a>(finnotesfile,finnotestop,<font class="stringliteral">"Financial notes"</font>);
00115 }
</pre></div>    </td>
  </tr>
</table>
<hr><address align="right"><small>Generated on Mon Sep 13 14:53:15 2004 for dil2al by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
