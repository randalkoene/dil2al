<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>note.cc File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>note.cc File Reference</h1><code>#include "<a class="el" href="dil2al_8hh-source.html">dil2al.hh</a>"</code><br>

<p>
<a href="note_8cc-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="note_8cc.html#a0">process_HTML</a> (<a class="el" href="classString.html">String</a> &amp;notestr)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="note_8cc.html#a1">pre_process_note</a> (<a class="el" href="classString.html">String</a> notefile, <a class="el" href="classString.html">String</a> notedst, <a class="el" href="classString.html">String</a> typestr, <a class="el" href="classString.html">String</a> &amp;notestr, <a class="el" href="classString.html">String</a> &amp;notedststr, bool &amp;isnew)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="note_8cc.html#a2">post_process_note</a> (<a class="el" href="classString.html">String</a> notedst, <a class="el" href="classString.html">String</a> &amp;notestr, <a class="el" href="classString.html">String</a> &amp;notedststr, int insertindex, bool isnew)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="note_8cc.html#a3">process_note_TL</a> (<a class="el" href="classString.html">String</a> notefile, <a class="el" href="classString.html">String</a> notedst)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="note_8cc.html#a4">process_note_HTML</a> (<a class="el" href="classString.html">String</a> notefile, <a class="el" href="classString.html">String</a> notedst)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="note_8cc.html#a5">process_note_TeX</a> (<a class="el" href="classString.html">String</a> notefile, <a class="el" href="classString.html">String</a> notedst)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="note_8cc.html#a6">process_note_CC</a> (<a class="el" href="classString.html">String</a> notefile, <a class="el" href="classString.html">String</a> notedst)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="note_8cc.html#a7">process_note_generic</a> (<a class="el" href="classString.html">String</a> notefile, <a class="el" href="classString.html">String</a> notedst)</td></tr>
<tr><td nowrap align=right valign=top>bool&nbsp;</td><td valign=bottom><a class="el" href="note_8cc.html#a8">process_note</a> (<a class="el" href="classString.html">String</a> notefile, <a class="el" href="classString.html">String</a> notedst)</td></tr>
<tr><td nowrap align=right valign=top>bool&nbsp;</td><td valign=bottom><a class="el" href="note_8cc.html#a9">make_note</a> ()</td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a name="a9" doxytag="note.cc::make_note"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool make_note </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="note_8cc-source.html#l00384">384</a> of file <a class="el" href="note_8cc-source.html">note.cc</a>.
<p>
References <a class="el" href="BigString_8cc-source.html#l00906">String::after</a>(), <a class="el" href="dil2al_8hh-source.html#l01245">ANSI_BOLD_OFF</a>, <a class="el" href="dil2al_8hh-source.html#l01244">ANSI_BOLD_ON</a>, <a class="el" href="dil2al_8hh-source.html#l01247">ANSI_UNDERLINE_OFF</a>, <a class="el" href="dil2al_8hh-source.html#l01246">ANSI_UNDERLINE_ON</a>, <a class="el" href="BigString_8cc-source.html#l00896">String::before</a>(), <a class="el" href="utilities_8cc-source.html#l02248">copy_until_line</a>(), <a class="el" href="BigString_8cc-source.html#l00843">String::del</a>(), <a class="el" href="dil2al_8hh-source.html#l01406">EOUT</a>, <a class="el" href="utilities_8cc-source.html#l02217">find_line</a>(), <a class="el" href="tladmin_8cc-source.html#l00006">get_TL_head</a>(), <a class="el" href="BigString_8hh-source.html#l01234">String::gsub</a>(), <a class="el" href="BigString_8hh-source.html#l01192">String::matches</a>(), <a class="el" href="utilities_8cc-source.html#l01997">prepare_temporary_file</a>(), <a class="el" href="BigString_8hh-source.html#l00849">String::prepend</a>(), <a class="el" href="note_8cc-source.html#l00330">process_note</a>(), <a class="el" href="utilities_8cc-source.html#l01927">relurl</a>(), <a class="el" href="templates_8defines_8hh-source.html#l00277">res</a>, <a class="el" href="utilities_8cc-source.html#l01834">time_stamp</a>(), and <a class="el" href="dil2al_8hh-source.html#l01407">VOUT</a>.
<p>
Referenced by <a class="el" href="controller_8cc-source.html#l00006">chunk_controller</a>(), and <a class="el" href="dil2al_8cc-source.html#l00655">dil2al_commands</a>().
<p>
<div class="fragment"><pre>00384                  {
00385         <font class="keyword">const</font> <font class="keywordtype">int</font> LLEN = 65525; <font class="comment">// was 10240</font>
00386         <font class="keywordtype">char</font> lbuf[LLEN];
00387         <font class="keywordtype">int</font> q,<a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00388         <font class="comment">// open an editor for a plain text entry</font>
00389         <a class="code" href="classString.html">String</a> noteinit;
00390         <font class="keywordflow">if</font> (suggestnameref) {
00391                 noteinit = <font class="stringliteral">"&lt;A NAME=\"TL-ref-"</font> + curtime + <font class="stringliteral">"\" HREF=\"@TLURL@#@TLNEXTENTRY@\"&gt;_&lt;/A&gt;"</font>;
00392                 <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Note: If destination is Task Log and suggested reference is not altered,\nthen "</font> &lt;&lt; noteinit &lt;&lt; <font class="stringliteral">" will be cleaned up automatically.\n"</font>;
00393         }
00394         <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a35">prepare_temporary_file</a>(notetmpfile,noteinit)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00395         <font class="keywordflow">if</font> (system(editor+<font class="stringliteral">" "</font>+notetmpfile)&lt;0) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00396         <font class="comment">// refresh curtime to avoid misrepresentations due to constantly open note editing window</font>
00397         curtime = <a class="code" href="utilities_8cc.html#a20">time_stamp</a>(<font class="stringliteral">"%Y%m%d%H%M"</font>);
00398         <font class="comment">// request destination of note</font>
00399         <font class="keywordflow">if</font> (useansi) cout &lt;&lt; <a class="code" href="dil2al_8hh.html#a93">ANSI_UNDERLINE_ON</a>; <font class="comment">// underline on</font>
00400         cout &lt;&lt; <font class="stringliteral">"Destination of note (default = Task Log)\n"</font>;
00401         <font class="keywordflow">if</font> (useansi) cout &lt;&lt; <a class="code" href="dil2al_8hh.html#a94">ANSI_UNDERLINE_OFF</a>; <font class="comment">// underline off</font>
00402         <font class="comment">// get quick-chooser options from configuration file</font>
00403         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;quicknotedstnum; i++) cout &lt;&lt; i &lt;&lt; <font class="charliteral">' '</font> &lt;&lt; quicknotedsttitle[i] &lt;&lt; quicknotedescr[i] &lt;&lt; <font class="charliteral">'\n'</font>;
00404         <font class="keywordflow">if</font> (useansi) cout &lt;&lt; <a class="code" href="dil2al_8hh.html#a91">ANSI_BOLD_ON</a>; <font class="comment">// bold on</font>
00405         cout &lt;&lt; <font class="stringliteral">"or enter file path: "</font>;
00406         <font class="keywordflow">if</font> (useansi) cout &lt;&lt; <a class="code" href="dil2al_8hh.html#a92">ANSI_BOLD_OFF</a>; <font class="comment">// bold off</font>
00407         cin.getline(lbuf,LLEN);
00408         <a class="code" href="classString.html">String</a> notedst = lbuf;
00409         <font class="keywordflow">if</font> (notedst == <font class="stringliteral">""</font>) {
00410                 notedst = tasklog;
00411                 cout &lt;&lt; <font class="stringliteral">"notedst = "</font> &lt;&lt; notedst &lt;&lt; <font class="charliteral">'\n'</font>;
00412                 <font class="keywordflow">if</font> (suggestnameref) {
00413                         <font class="comment">// clean up unnecessary (self-)reference NAME tag</font>
00414                         ifstream ntf(notetmpfile);
00415                         <font class="keywordflow">if</font> (!ntf) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to open "</font> &lt;&lt; notetmpfile &lt;&lt; <font class="stringliteral">" for removal of spurious NAME tag in make_note(), continuing as is\n"</font>;
00416                         <font class="keywordflow">else</font> {
00417                                 ofstream ntfnew(notetmpfile+<font class="stringliteral">".tlref_cleaned"</font>);
00418                                 <font class="keywordflow">if</font> (!ntfnew) {
00419                                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to create "</font> &lt;&lt; notetmpfile &lt;&lt; <font class="stringliteral">".tlref_cleaned in make_note(), continuing as is\n"</font>;
00420                                         ntf.close();
00421                                 } <font class="keywordflow">else</font> {
00422                                         <font class="keywordflow">if</font> ((<a class="code" href="templates_8defines_8hh.html#a11">res</a>=<a class="code" href="utilities_8cc.html#a47">copy_until_line</a>(&amp;ntf,&amp;ntfnew,noteinit,lbuf,LLEN))==1) {
00423                                                 <a class="code" href="classString.html">String</a> noteline(lbuf); noteline.<a class="code" href="classString.html#a83">del</a>(noteinit);
00424                                                 ntfnew &lt;&lt; noteline &lt;&lt; <font class="charliteral">'\n'</font>;
00425                                                 ntfnew &lt;&lt; ntf.rdbuf();
00426                                                 ntf.close(); ntfnew.close();
00427                                                 <font class="keywordflow">if</font> (rename(notetmpfile+<font class="stringliteral">".tlref_cleaned"</font>,notetmpfile)&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to rename "</font> &lt;&lt; notetmpfile &lt;&lt; <font class="stringliteral">".tlref_cleaned to "</font> &lt;&lt; notetmpfile &lt;&lt; <font class="stringliteral">"\nin make_note(), continuing as is\n"</font>;
00428                                         } <font class="keywordflow">else</font> {
00429                                                 ntf.close(); ntfnew.close();
00430                                                 <font class="keywordflow">if</font> (<a class="code" href="templates_8defines_8hh.html#a11">res</a>&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to remove unnecessary NAME tag in make_note(), continuing as is\n"</font>;
00431                                                 <font class="keywordflow">if</font> (unlink(notetmpfile+<font class="stringliteral">".tlref_cleaned"</font>)&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to remove "</font> &lt;&lt; notetmpfile &lt;&lt; <font class="stringliteral">".tlref_cleaned in make_note(), continuing as is\n"</font>;
00432                                         }
00433                                 }
00434                         }
00435                 }
00436         } <font class="keywordflow">else</font> {
00437                 <font class="comment">// default destination document title is file name</font>
00438                 <a class="code" href="classString.html">String</a> notedsttitle = notedst; notedsttitle.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">".*/"</font>),<font class="stringliteral">""</font>);
00439                 <font class="comment">// obtain quick-chooser destinations</font>
00440                 <font class="keywordflow">if</font> (notedst.<a class="code" href="classString.html#a42">matches</a>(BRXint)) {
00441                         q = atoi((<font class="keyword">const</font> <font class="keywordtype">char</font> *) notedst);
00442                         <font class="keywordflow">if</font> ((q&gt;=0) &amp;&amp; (q&lt;quicknotedstnum)) {
00443                                 notedst = quicknotedst[q];
00444                                 notedsttitle = quicknotedsttitle[q];
00445                         } <font class="keywordflow">else</font> {
00446                                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Selection "</font> &lt;&lt; q &lt;&lt; <font class="stringliteral">" is not a predefined note destination\n"</font>;
00447                                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
00448                         }
00449                 }
00450                 <font class="comment">// if not task log, request task log reference line, suggest reference to note</font>
00451                 <font class="keywordflow">if</font> (notedst[0]!=<font class="charliteral">'/'</font>) notedst.<a class="code" href="classString.html#a22">prepend</a>(homedir);
00452                 <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Note destination to process: "</font> &lt;&lt; notedst &lt;&lt; <font class="charliteral">'\n'</font>;
00453                 <a class="code" href="classString.html">String</a> tlentryinit = <font class="stringliteral">"&lt;A HREF=\""</font>+<a class="code" href="utilities_8cc.html#a30">relurl</a>(<a class="code" href="tladmin_8cc.html#a316">get_TL_head</a>(),notedst);
00454                 ifstream ntf(notetmpfile);
00455                 <font class="keywordflow">if</font> (!ntf) { <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to open "</font> &lt;&lt; notetmpfile &lt;&lt; <font class="stringliteral">" in make_note()\n"</font>; <font class="keywordflow">return</font> <font class="keyword">false</font>; }
00456                 <font class="comment">// this NAME could be the suggested one, or one modified/set manually</font>
00457                 <font class="keywordflow">if</font> (<a class="code" href="utilities_8cc.html#a46">find_line</a>(&amp;ntf,<font class="stringliteral">"[&lt;][Aa][    ]+[^&gt;]*[Nn][As][Mm][Ee]=[       ]*\"[^&gt;]+[&gt;]"</font>,lbuf,LLEN)) {
00458                         <a class="code" href="classString.html">String</a> tlref(lbuf); tlref = tlref.<a class="code" href="classString.html#a76">after</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Aa][      ]+[^&gt;]*[Nn][As][Mm][Ee]=[       ]*\""</font>));
00459                         tlentryinit = tlentryinit + <font class="charliteral">'#'</font> +tlref.<a class="code" href="classString.html#a58">before</a>(<font class="stringliteral">"\""</font>);
00460                 }
00461                 ntf.close();
00462                 tlentryinit +=<font class="stringliteral">"\"&gt;("</font>+notedsttitle+<font class="stringliteral">")&lt;/A&gt;"</font>;
00463                 <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a35">prepare_temporary_file</a>(tlentrytmpfile,tlentryinit)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00464                 <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Task Log entry referring to note (if any)...\n"</font>;
00465                 <font class="keywordflow">if</font> (system(editor+<font class="stringliteral">" "</font>+tlentrytmpfile)&lt;0) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00466                 newTLID = <font class="stringliteral">""</font>; <font class="comment">// clear to test if properly generated</font>
00467                 <font class="keywordflow">if</font> (!<a class="code" href="note_8cc.html#a8">process_note</a>(tlentrytmpfile,tasklog)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00468                 <font class="keywordflow">if</font> (newTLID==<font class="stringliteral">""</font>) {
00469                         <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"No new Task Log entry ID, perhaps entry was empty (removing @TLURL@ and\n@TLNEXTENTRY@ references)\n"</font>;
00470                         <font class="comment">// remove HREF="@TLURL@#@TLNEXTENTRY@" references from notedst</font>
00471                         ntf.open(notetmpfile);
00472                         <font class="keywordflow">if</font> (!ntf) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to remove spurious @TLURL@ and @TLNEXTENTRY@ references in\nmake_note(), continuing as is\n"</font>;
00473                         <font class="keywordflow">else</font> {
00474                                 ofstream ntfnew(notetmpfile+<font class="stringliteral">".tlurl_cleaned"</font>);
00475                                 <font class="keywordflow">if</font> (!ntfnew) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to creaete "</font> &lt;&lt; notetmpfile &lt;&lt; <font class="stringliteral">".tlurl_cleaned in make_note(),\ncontinuing as is\n"</font>;
00476                                 <font class="keywordflow">else</font> {
00477                                         <font class="keywordflow">while</font> (ntf) {
00478                                                 <font class="keywordflow">if</font> ((<a class="code" href="templates_8defines_8hh.html#a11">res</a>=<a class="code" href="utilities_8cc.html#a47">copy_until_line</a>(&amp;ntf,&amp;ntfnew,<font class="stringliteral">"@TLURL@|@TLNEXTENTRY@"</font>,lbuf,LLEN))==1) {
00479                                                         tlentryinit = lbuf;
00480                                                         tlentryinit.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Aa][     ]+[Hh][Rr][Ee][Ff][     ]*=[    ]*\"[^\"]*\\(@TLURL@\\|@TLNEXTENTRY@\\)[^\"]*\"[        ]*[&gt;][^&lt;]*[&lt;]/[Aa][&gt;]"</font>),<font class="stringliteral">""</font>);
00481                                                         tlentryinit.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[    ]+[Hh][Rr][Ee][Ff][     ]*=[    ]*\"[^\"]*\\(@TLURL@\\|@TLNEXTENTRY@\\)[^\"]*\"[        ]*"</font>),<font class="stringliteral">""</font>);
00482                                                         ntfnew &lt;&lt; tlentryinit &lt;&lt; <font class="charliteral">'\n'</font>;
00483                                                 } <font class="keywordflow">else</font> <font class="keywordflow">break</font>;
00484                                         }
00485                                         ntfnew.close();
00486                                         <font class="keywordflow">if</font> (<a class="code" href="templates_8defines_8hh.html#a11">res</a>&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to remove spurious @TLURL@ and @TLNEXTENTRY@ references in\nmake_note(), continuing as is\n"</font>;
00487                                         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (rename(notetmpfile+<font class="stringliteral">".tlurl_cleaned"</font>,notetmpfile)&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to rename "</font> &lt;&lt; notetmpfile &lt;&lt; <font class="stringliteral">".tlurl_cleaned to "</font> &lt;&lt; notetmpfile &lt;&lt; <font class="stringliteral">"\nin make_note(), continuing as is\n"</font>;
00488                                 }
00489                                 ntf.close();
00490                         }
00491                 } <font class="keywordflow">else</font> {
00492                         <font class="comment">// parse notedst to fill in @TLURL@ and @TLNEXTENTRY@</font>
00493                         ntf.open(notetmpfile);
00494                         <font class="keywordflow">if</font> (!ntf) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to fill in @TLURL@ and @TLNEXTENTRY@ references in\nmake_note(), continuing as is\n"</font>;
00495                         <font class="keywordflow">else</font> {
00496                                 ofstream ntfnew(notetmpfile+<font class="stringliteral">".tlurl"</font>);
00497                                 <font class="keywordflow">if</font> (!ntfnew) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to create "</font> &lt;&lt; notetmpfile &lt;&lt; <font class="stringliteral">".tlurl in make_note(),\ncontinuing as is\n"</font>;
00498                                 <font class="keywordflow">else</font> {
00499                                         <a class="code" href="classString.html">String</a> tlurl(<a class="code" href="utilities_8cc.html#a30">relurl</a>(notedst,<a class="code" href="tladmin_8cc.html#a316">get_TL_head</a>()));
00500                                         <font class="keywordflow">while</font> (ntf) {
00501                                                 <font class="keywordflow">if</font> ((<a class="code" href="templates_8defines_8hh.html#a11">res</a>=<a class="code" href="utilities_8cc.html#a47">copy_until_line</a>(&amp;ntf,&amp;ntfnew,<font class="stringliteral">"@TLURL@|@TLNEXTENTRY@"</font>,lbuf,LLEN))==1) {
00502                                                         tlentryinit = lbuf;
00503                                                         tlentryinit.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"@TLURL@"</font>,tlurl);
00504                                                         tlentryinit.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"@TLNEXTENTRY@"</font>,newTLID);
00505                                                         ntfnew &lt;&lt; tlentryinit &lt;&lt; <font class="charliteral">'\n'</font>;
00506                                                 } <font class="keywordflow">else</font> <font class="keywordflow">break</font>;
00507                                         }
00508                                         ntfnew.close();
00509                                         <font class="keywordflow">if</font> (<a class="code" href="templates_8defines_8hh.html#a11">res</a>&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to fill in @TLURL@ and @TLNEXTENTRY@ references in\nmake_note(), continuing as is\n"</font>;
00510                                         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (rename(notetmpfile+<font class="stringliteral">".tlurl"</font>,notetmpfile)&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to rename "</font> &lt;&lt; notetmpfile &lt;&lt; <font class="stringliteral">".tlurl to "</font> &lt;&lt; notetmpfile &lt;&lt; <font class="stringliteral">"\nin make_note(), continuing as is\n"</font>;
00511                                 }
00512                                 ntf.close();
00513                         }
00514                 }
00515         }
00516         <font class="keywordflow">return</font> <a class="code" href="note_8cc.html#a8">process_note</a>(notetmpfile,notedst);
00517 }
</pre></div>    </td>
  </tr>
</table>
<a name="a2" doxytag="note.cc::post_process_note"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int post_process_note </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notedst</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notestr</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notedststr</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>insertindex</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>bool&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>isnew</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="note_8cc-source.html#l00066">66</a> of file <a class="el" href="note_8cc-source.html">note.cc</a>.
<p>
References <a class="el" href="BigString_8cc-source.html#l00886">String::at</a>(), <a class="el" href="BigString_8hh-source.html#l00493">String::length</a>(), and <a class="el" href="utilities_8cc-source.html#l02116">write_file_from_String</a>().
<p>
Referenced by <a class="el" href="note_8cc-source.html#l00220">process_note_CC</a>(), <a class="el" href="note_8cc-source.html#l00298">process_note_generic</a>(), <a class="el" href="note_8cc-source.html#l00108">process_note_HTML</a>(), and <a class="el" href="note_8cc-source.html#l00128">process_note_TeX</a>().
<p>
<div class="fragment"><pre>00066                                                                                                           {
00067         <font class="comment">// insert note into notedst</font>
00068         <font class="keywordflow">if</font> (insertindex&gt;=0) {
00069                 <a class="code" href="classString.html">String</a> c = notedststr.<a class="code" href="classString.html#a51">at</a>(insertindex,1);
00070                 notedststr.<a class="code" href="classString.html#a51">at</a>(insertindex,1) = notestr+c;
00071         } <font class="keywordflow">else</font> {
00072                 insertindex = notedststr.<a class="code" href="classString.html#a105">length</a>();
00073                 notedststr += notestr;
00074         }
00075         <font class="comment">// store and backup</font>
00076         <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a41">write_file_from_String</a>(notedst,notedststr,<font class="stringliteral">"Note destination"</font>,isnew)) <font class="keywordflow">return</font> -1;
00077         <font class="keywordflow">return</font> insertindex;
00078 }
</pre></div>    </td>
  </tr>
</table>
<a name="a1" doxytag="note.cc::pre_process_note"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int pre_process_note </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notefile</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notedst</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>typestr</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notestr</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notedststr</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>bool &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>isnew</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="note_8cc-source.html#l00053">53</a> of file <a class="el" href="note_8cc-source.html">note.cc</a>.
<p>
References <a class="el" href="note_8cc-source.html#l00006">process_HTML</a>(), <a class="el" href="utilities_8cc-source.html#l02074">read_file_into_String</a>(), and <a class="el" href="dil2al_8hh-source.html#l01407">VOUT</a>.
<p>
Referenced by <a class="el" href="note_8cc-source.html#l00220">process_note_CC</a>(), <a class="el" href="note_8cc-source.html#l00298">process_note_generic</a>(), <a class="el" href="note_8cc-source.html#l00108">process_note_HTML</a>(), <a class="el" href="note_8cc-source.html#l00128">process_note_TeX</a>(), and <a class="el" href="note_8cc-source.html#l00080">process_note_TL</a>().
<p>
<div class="fragment"><pre>00053                                                                                                                            {
00054         <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a39">read_file_into_String</a>(notefile,notestr)) <font class="keywordflow">return</font> -1;
00055         <font class="keywordflow">if</font> (notestr==<font class="stringliteral">""</font>) { <font class="comment">// if note is empty, don't do anything, but return true</font>
00056                 <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Note is empty, no change\n"</font>;
00057                 <font class="keywordflow">return</font> 0;
00058         }
00059         <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Processing destination file as "</font> &lt;&lt; typestr &lt;&lt; <font class="charliteral">'\n'</font>;
00060         <a class="code" href="note_8cc.html#a0">process_HTML</a>(notestr);
00061         <font class="comment">// read note destination into memory</font>
00062         <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a39">read_file_into_String</a>(isnew,notedst,notedststr)) <font class="keywordflow">return</font> -1;
00063         <font class="keywordflow">return</font> 1;
00064 }
</pre></div>    </td>
  </tr>
</table>
<a name="a0" doxytag="note.cc::process_HTML"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void process_HTML </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classString.html">String</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>notestr</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="note_8cc-source.html#l00006">6</a> of file <a class="el" href="note_8cc-source.html">note.cc</a>.
<p>
References <a class="el" href="BigString_8cc-source.html#l00906">String::after</a>(), <a class="el" href="BigString_8cc-source.html#l00886">String::at</a>(), <a class="el" href="BigString_8cc-source.html#l00896">String::before</a>(), <a class="el" href="BigString_8hh-source.html#l01126">String::contains</a>(), <a class="el" href="dil2al_8hh-source.html#l01406">EOUT</a>, <a class="el" href="BigString_8hh-source.html#l01234">String::gsub</a>(), <a class="el" href="BigString_8hh-source.html#l01093">String::index</a>(), and <a class="el" href="BigString_8hh-source.html#l00493">String::length</a>().
<p>
Referenced by <a class="el" href="note_8cc-source.html#l00053">pre_process_note</a>(), and <a class="el" href="note_8cc-source.html#l00080">process_note_TL</a>().
<p>
<div class="fragment"><pre>00006                                     {
00007 <font class="comment">// Process note shorthand codes to HTML and fill in @tags@</font>
00008         <font class="comment">// line breaks</font>
00009         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"\n"</font>,<font class="stringliteral">"&lt;BR&gt;\n"</font>);
00010         <font class="comment">// paragraphs</font>
00011         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"&lt;BR&gt;\n\\(&lt;BR&gt;\n\\)+"</font>),<font class="stringliteral">"\n&lt;P&gt;\n"</font>);
00012         <font class="comment">// lists with `-' or `*' item indicators</font>
00013         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"^[       ]*-[    ]+"</font>),<font class="stringliteral">"&lt;LI&gt;"</font>);
00014         <font class="keywordtype">int</font> lstart, lend;
00015         <font class="keywordflow">while</font> ((lstart=notestr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"^[       ]*[*][  ]+"</font>)))&gt;=0) {
00016                 notestr.<a class="code" href="classString.html#a51">at</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"^[         ]*[*][  ]+"</font>),lstart)=<font class="stringliteral">"&lt;UL&gt;\n&lt;LI&gt;"</font>;
00017                 <font class="keywordflow">while</font> ((lend=notestr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"\n"</font>,lstart))&gt;=0) {
00018                         lstart = lend+1;
00019                         <font class="keywordflow">if</font> (notestr.<a class="code" href="classString.html#a32">contains</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"\n\\([   ]+[^    ]+\\|[  ]*[*][  ]+\\)"</font>),lend)) {
00020                                 notestr.<a class="code" href="classString.html#a51">at</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"\n[        ]*[*][  ]+"</font>),lend) = <font class="stringliteral">"\n&lt;LI&gt;"</font>;
00021                         } <font class="keywordflow">else</font> <font class="keywordflow">break</font>;
00022                 }
00023                 <font class="keywordflow">if</font> (lend&lt;0) { lend = notestr.<a class="code" href="classString.html#a105">length</a>(); notestr += <font class="stringliteral">"\n"</font>; }
00024                 notestr.<a class="code" href="classString.html#a51">at</a>(<font class="stringliteral">"\n"</font>,lend) = <font class="stringliteral">"\n&lt;/UL&gt;\n"</font>;
00025         }
00026         <font class="comment">// note that HTML references are already correct</font>
00027         <font class="comment">// tag definitions</font>
00028         <font class="comment">// NOVELTY tags</font>
00029         <font class="keywordtype">int</font> novcount = 0;
00030         lstart = -1;
00031         <font class="keywordflow">while</font> ((lstart=notestr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"@NOV@"</font>,lstart+1))&gt;=0) {
00032                 <font class="keywordflow">if</font> ((lend=notestr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"@/NOV@"</font>,lstart))&gt;=0) {
00033                         <a class="code" href="classString.html">String</a> tmp1,tmp2;
00034                         novcount++;
00035                         tmp1 = notestr.<a class="code" href="classString.html#a51">at</a>(lstart+5,lend-(lstart+4));
00036                         tmp2 = notestr.<a class="code" href="classString.html#a76">after</a>(lend+6);
00037                         notestr = notestr.<a class="code" href="classString.html#a58">before</a>(lstart) + <font class="stringliteral">"&lt;A NAME=\"NOVELTY-"</font>+((curtime+<font class="charliteral">'-'</font>)+dec(novcount))+<font class="stringliteral">"\"&gt;[&lt;B&gt;N&lt;/B&gt;]&lt;/A&gt; "</font>
00038                                         + tmp1 + <font class="stringliteral">"&lt;!-- @NOVELTY-"</font>+((curtime+<font class="charliteral">'-'</font>)+dec(novcount))+<font class="stringliteral">"@ --&gt;"</font> + tmp2;
00039                 } <font class="keywordflow">else</font> <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: @NOV@ without matching @/NOV@ in process_HTML(), continuing as is\n"</font>;
00040         }
00041 <font class="comment">//*** add code here to replace @tags@ and tags defined in the configuration file</font>
00042         <font class="comment">// clean up</font>
00043         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&lt;BR&gt;&lt;BR&gt;"</font>,<font class="stringliteral">"&lt;BR&gt;"</font>);
00044         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&lt;BR&gt;&lt;P&gt;"</font>,<font class="stringliteral">"&lt;P&gt;"</font>);
00045         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&lt;P&gt;&lt;BR&gt;"</font>,<font class="stringliteral">"&lt;P&gt;"</font>);
00046         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&lt;BR&gt;\n&lt;P&gt;"</font>,<font class="stringliteral">"\n&lt;P&gt;"</font>);
00047         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&lt;P&gt;\n&lt;P&gt;"</font>,<font class="stringliteral">"&lt;P&gt;"</font>);
00048         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&lt;BR&gt;\n&lt;UL&gt;"</font>,<font class="stringliteral">"\n&lt;UL&gt;"</font>);
00049         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&lt;BR&gt;\n&lt;LI&gt;"</font>,<font class="stringliteral">"\n&lt;LI&gt;"</font>);
00050         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&lt;BR&gt;\n&lt;/UL&gt;"</font>,<font class="stringliteral">"\n&lt;/UL&gt;"</font>);
00051 }
</pre></div>    </td>
  </tr>
</table>
<a name="a8" doxytag="note.cc::process_note"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool process_note </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notefile</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notedst</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="note_8cc-source.html#l00330">330</a> of file <a class="el" href="note_8cc-source.html">note.cc</a>.
<p>
References <a class="el" href="dil2al_8hh-source.html#l01406">EOUT</a>, <a class="el" href="tladmin_8cc-source.html#l00006">get_TL_head</a>(), <a class="el" href="BigString_8hh-source.html#l01234">String::gsub</a>(), <a class="el" href="BigString_8hh-source.html#l01192">String::matches</a>(), <a class="el" href="note_8cc-source.html#l00220">process_note_CC</a>(), <a class="el" href="note_8cc-source.html#l00298">process_note_generic</a>(), <a class="el" href="note_8cc-source.html#l00108">process_note_HTML</a>(), <a class="el" href="note_8cc-source.html#l00128">process_note_TeX</a>(), <a class="el" href="note_8cc-source.html#l00080">process_note_TL</a>(), <a class="el" href="templates_8defines_8hh-source.html#l00277">res</a>, and <a class="el" href="dil2al_8hh-source.html#l01234">UNIE_ASK</a>.
<p>
Referenced by <a class="el" href="note_8cc-source.html#l00384">make_note</a>().
<p>
<div class="fragment"><pre>00330                                                    {
00331         <font class="keyword">const</font> <font class="keywordtype">int</font> LLEN = 10240;
00332         <font class="keywordtype">char</font> lbuf[LLEN];
00333         <font class="comment">// determine destination file type</font>
00334         <font class="keywordtype">int</font> filetype = 0; <font class="comment">// generic type</font>
00335         <font class="keywordflow">if</font> (notedst==tasklog) {
00336                 filetype = 1; <font class="comment">// Task Log type</font>
00337                 <font class="keywordflow">if</font> ((notedst = <a class="code" href="tladmin_8cc.html#a316">get_TL_head</a>())==<font class="stringliteral">""</font>) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00338         } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (notedst.<a class="code" href="classString.html#a42">matches</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">".*[.][Hh][Tt][Mm][Ll]?\\([---_.].*\\)?"</font>))) filetype = 2; <font class="comment">// HTML type</font>
00339         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (notedst.<a class="code" href="classString.html#a42">matches</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">".*[.][Tt][Ee][Xx]\\([---_.].*\\)?"</font>))) filetype = 3; <font class="comment">// TeX type</font>
00340         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (notedst.<a class="code" href="classString.html#a42">matches</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">".*[.]\\([Cc][Cc]|[Hh][Hh]\\)\\([---_.].*\\)?"</font>))) filetype = 4; <font class="comment">// C++ type</font>
00341         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (askprocesstype) {
00342                 filetype = -1;
00343                 <font class="keywordflow">while</font> ((filetype&lt;0) || (filetype&gt;4)) {
00344                         cout &lt;&lt; <font class="stringliteral">"Destination file type (0=generic,1=Task Log,2=HTML,3=TeX,4=C++): "</font>;
00345                         cin.getline(lbuf,LLEN);
00346                         <a class="code" href="classString.html">String</a> ftstr = lbuf;
00347                         <font class="keywordflow">if</font> (ftstr.<a class="code" href="classString.html#a42">matches</a>(BRXint)) filetype = atoi((<font class="keyword">const</font> <font class="keywordtype">char</font> *) ftstr);
00348                 }
00349         }
00350         <font class="comment">// process and insert note in destination file</font>
00351         <font class="keywordtype">int</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00352         <font class="keywordflow">switch</font> (filetype) {
00353                 <font class="keywordflow">case</font> 0: <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<a class="code" href="note_8cc.html#a7">process_note_generic</a>(notefile,notedst); <font class="keywordflow">break</font>;
00354                 <font class="keywordflow">case</font> 1: <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<a class="code" href="note_8cc.html#a3">process_note_TL</a>(notefile,notedst); <font class="keywordflow">break</font>;
00355                 <font class="keywordflow">case</font> 2: <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<a class="code" href="note_8cc.html#a4">process_note_HTML</a>(notefile,notedst); <font class="keywordflow">break</font>;
00356                 <font class="keywordflow">case</font> 3: <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<a class="code" href="note_8cc.html#a5">process_note_TeX</a>(notefile,notedst); <font class="keywordflow">break</font>;
00357                 <font class="keywordflow">case</font> 4: <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<a class="code" href="note_8cc.html#a6">process_note_CC</a>(notefile,notedst); <font class="keywordflow">break</font>;
00358                 <font class="keywordflow">default</font>: {
00359                                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unknown destination file type in process_note()\n"</font>;
00360                                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
00361                         }
00362         }
00363         <font class="keywordflow">if</font> (<a class="code" href="templates_8defines_8hh.html#a11">res</a>&lt;0) {
00364                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to process destination file in process_note()\n"</font>;
00365                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
00366         }
00367         <font class="comment">// update and open notedst in an editor</font>
00368         <font class="keywordtype">bool</font> updateineditor = updatenoteineditor;
00369         <font class="keywordflow">if</font> (updateineditor==<a class="code" href="dil2al_8hh.html#a84">UNIE_ASK</a>) {
00370                 cout &lt;&lt; <font class="stringliteral">"\nUpdate and open "</font> &lt;&lt; notedst &lt;&lt; <font class="stringliteral">" in editor? (Y/n) "</font>;
00371                 cin.getline(lbuf,LLEN);
00372                 updateineditor = (!((lbuf[0]==<font class="charliteral">'n'</font>) || (lbuf[0]==<font class="charliteral">'N'</font>)));
00373         }
00374         <font class="keywordflow">if</font> (updateineditor) {
00375                 <a class="code" href="classString.html">String</a> uniecmd = updatenoteineditorcmd;
00376                 uniecmd.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"@res@"</font>,dec(<a class="code" href="templates_8defines_8hh.html#a11">res</a>));
00377                 <font class="keywordflow">if</font> (filetype==1) notedst=tasklog; <font class="comment">// revert to symbolic link in case new Task Log section was added</font>
00378                 uniecmd.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"@notedst@"</font>,notedst);
00379                 <font class="keywordflow">if</font> (system(uniecmd)&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to update and open "</font> &lt;&lt; notedst &lt;&lt; <font class="stringliteral">" in editor in process_note(), continuing\n"</font>;
00380         }
00381         <font class="keywordflow">return</font> <font class="keyword">true</font>;
00382 }
</pre></div>    </td>
  </tr>
</table>
<a name="a6" doxytag="note.cc::process_note_CC"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int process_note_CC </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notefile</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notedst</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="note_8cc-source.html#l00220">220</a> of file <a class="el" href="note_8cc-source.html">note.cc</a>.
<p>
References <a class="el" href="BigString_8cc-source.html#l00906">String::after</a>(), <a class="el" href="BigString_8cc-source.html#l00886">String::at</a>(), <a class="el" href="BigString_8cc-source.html#l00896">String::before</a>(), <a class="el" href="BigString_8hh-source.html#l01234">String::gsub</a>(), <a class="el" href="BigString_8hh-source.html#l01093">String::index</a>(), <a class="el" href="BigString_8hh-source.html#l00493">String::length</a>(), <a class="el" href="note_8cc-source.html#l00066">post_process_note</a>(), <a class="el" href="note_8cc-source.html#l00053">pre_process_note</a>(), <a class="el" href="templates_8defines_8hh-source.html#l00277">res</a>, and <a class="el" href="dil2al_8hh-source.html#l01407">VOUT</a>.
<p>
Referenced by <a class="el" href="note_8cc-source.html#l00330">process_note</a>().
<p>
<div class="fragment"><pre>00220                                                      {
00221         <a class="code" href="classString.html">String</a> notestr, notedststr; <font class="keywordtype">bool</font> isnew; <font class="keywordtype">int</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00222         <font class="keywordflow">if</font> ((<a class="code" href="templates_8defines_8hh.html#a11">res</a> = <a class="code" href="note_8cc.html#a1">pre_process_note</a>(notefile,notedst,<font class="stringliteral">"C++"</font>,notestr,notedststr,isnew))&lt;=0) <font class="keywordflow">return</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00223         <font class="comment">// find a possible // &lt;!-- @INSERT-AT:&lt;tag&gt;@ --&gt;</font>
00224         <font class="keywordtype">int</font> insertindex = -1;
00225         <a class="code" href="classString.html">String</a> inserttag = notestr.<a class="code" href="classString.html#a51">at</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[         ]*@INSERT-AT:[^@]+@[    ]*--[&gt;]"</font>));
00226         <font class="keywordflow">if</font> (inserttag!=<font class="stringliteral">""</font>) {
00227                 inserttag = inserttag.<a class="code" href="classString.html#a76">after</a>(<font class="stringliteral">"INSERT-AT:"</font>);
00228                 inserttag = inserttag.<a class="code" href="classString.html#a58">before</a>(<font class="stringliteral">"@"</font>,-1);
00229                 insertindex = notedststr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"//[\n]*[&lt;]!--[         ]*@"</font>+inserttag+<font class="stringliteral">"@[      ]*--[&gt;]"</font>));
00230         }
00231         <font class="comment">// find a possible // &lt;!-- @INSERT-TL-NOTE@ --&gt;</font>
00232         <font class="keywordflow">if</font> (insertindex&lt;0) insertindex = notedststr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"//[\n]*[&lt;]!--[      ]*@INSERT-TL-NOTE@[     ]*--[&gt;]"</font>));
00233         <font class="keywordflow">if</font> ((insertindex&lt;0) &amp;&amp; (verbose))  <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"No specific insertion location in "</font> &lt;&lt; notedst &lt;&lt; <font class="stringliteral">", appending note to end\n"</font>;
00234         <font class="comment">// convert to C++</font>
00235         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Bb][Rr][     ]*[^&gt;][&gt;]\n?"</font>),<font class="stringliteral">"\n"</font>); <font class="comment">// &lt;BR&gt;</font>
00236         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"\n?[&lt;][Pp][      ]*[^&gt;]*[&gt;]\n?"</font>),<font class="stringliteral">"\n\n"</font>); <font class="comment">// &lt;P&gt;</font>
00237         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Uu][Ll][     ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">""</font>); <font class="comment">// &lt;UL&gt;</font>
00238         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Uu][Ll][    ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">""</font>); <font class="comment">// &lt;/UL&gt;</font>
00239         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Oo][Ll][     ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">""</font>); <font class="comment">// &lt;OL&gt;</font>
00240         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Oo][Ll][    ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">""</font>); <font class="comment">// &lt;/OL&gt;</font>
00241         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Ll][Ii][     ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">"- "</font>); <font class="comment">// &lt;LI&gt;</font>
00242         <font class="comment">// &lt;A HREF="http://the-reference-url/"&gt;the-reference-text&lt;/A&gt;</font>
00243         <font class="comment">// &lt;A NAME="the-reference-name-tag"&gt;the-reference-anchor&lt;/A&gt;</font>
00244         <font class="keywordtype">int</font> i = 0, j = 0, k;
00245         <font class="keywordflow">while</font> (i&gt;=0) {
00246                 i = notestr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Aa][    ]+[^&gt;]*\\([Hh][Rr][Ee][Ff]\\|[Nn][Aa][Mm][Ee]\\)[       ]*=[    ]*[^&gt;]*[&gt;].*[&lt;]/[Aa][   ]*[^&gt;]*[&gt;]"</font>),j);
00247                 <font class="keywordflow">if</font> (i&gt;=0) {
00248                         j = notestr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"//[^\n]*"</font>),i-notestr.<a class="code" href="classString.html#a105">length</a>()); <font class="comment">// check if already // commented</font>
00249                         <font class="keywordflow">if</font> (j&lt;0) {
00250                                 j = notestr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"/*"</font>,i-notestr.<a class="code" href="classString.html#a105">length</a>());
00251                                 <font class="keywordflow">if</font> (j&gt;=0) {
00252                                         k = notestr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"*/"</font>,i-notestr.<a class="code" href="classString.html#a105">length</a>());
00253                                         <font class="keywordflow">if</font> (k&gt;j) j = -1;
00254                                 }
00255                         }
00256                         <font class="keywordflow">if</font> (j&lt;0) {
00257                                 j = notestr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Aa][   ]*[^&gt;]*[&gt;]"</font>),i);
00258                                 j = notestr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"&gt;"</font>,j);
00259                                 <a class="code" href="classString.html">String</a> tmpstr = <font class="stringliteral">"/* "</font>+notestr.<a class="code" href="classString.html#a51">at</a>(i,(j-i)+1)+<font class="stringliteral">" */"</font>+notestr.<a class="code" href="classString.html#a76">after</a>(j);
00260                                 notestr = notestr.<a class="code" href="classString.html#a58">before</a>(i)+tmpstr;
00261                                 <font class="comment">//notestr.at(j,1) = "&gt; */";</font>
00262                                 <font class="comment">//notestr.at(i,1) = "/* &lt;";</font>
00263                         }
00264                 }
00265         }
00266         <font class="comment">// other &lt;...&gt; tags</font>
00267         i = 0; j = 0;
00268         <font class="keywordflow">while</font> (i&gt;=0) {
00269                 i = notestr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][^&gt;]*[&gt;]"</font>),j);
00270                 <font class="keywordflow">if</font> (i&gt;=0) {
00271                         j = notestr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"//[^\n]*"</font>),i-notestr.<a class="code" href="classString.html#a105">length</a>()); <font class="comment">// check if already // commented</font>
00272                         <font class="keywordflow">if</font> (j&lt;0) {
00273                                 j = notestr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"/*"</font>,i-notestr.<a class="code" href="classString.html#a105">length</a>());
00274                                 <font class="keywordflow">if</font> (j&gt;=0) {
00275                                         k = notestr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"*/"</font>,i-notestr.<a class="code" href="classString.html#a105">length</a>());
00276                                         <font class="keywordflow">if</font> (k&gt;j) j = -1;
00277                                 }
00278                         }
00279                         <font class="keywordflow">if</font> (j&lt;0) { <font class="comment">// convert tag to comment</font>
00280                                 j = notestr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"&gt;"</font>,i);
00281                                 <a class="code" href="classString.html">String</a> tmpstr = <font class="stringliteral">"/* "</font>+notestr.<a class="code" href="classString.html#a51">at</a>(i,(j-i)+1)+<font class="stringliteral">" */"</font>+notestr.<a class="code" href="classString.html#a76">after</a>(j);
00282                                 notestr = notestr.<a class="code" href="classString.html#a58">before</a>(i)+tmpstr;
00283                                 <font class="comment">//notestr.at(j,1) = "&gt; */";</font>
00284                                 <font class="comment">//notestr.at(i,1) = "/* &lt;";</font>
00285                         }
00286                 }
00287         }
00288         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;lt;"</font>,<font class="stringliteral">"&lt;"</font>); <font class="comment">// &amp;lt;</font>
00289         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;gt;"</font>,<font class="stringliteral">"&gt;"</font>); <font class="comment">// &amp;gt;</font>
00290         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;amp;"</font>,<font class="stringliteral">"&amp;"</font>); <font class="comment">// &amp;amp;</font>
00291         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;nbsp;"</font>,<font class="stringliteral">" "</font>); <font class="comment">// &amp;nbsp;</font>
00292         <font class="comment">// clean up</font>
00293         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[        ]+\n"</font>),<font class="stringliteral">"\n"</font>);
00294         <font class="comment">// insert note into notedst</font>
00295         <font class="keywordflow">return</font> <a class="code" href="note_8cc.html#a2">post_process_note</a>(notedst,notestr,notedststr,insertindex,isnew);
00296 }
</pre></div>    </td>
  </tr>
</table>
<a name="a7" doxytag="note.cc::process_note_generic"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int process_note_generic </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notefile</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notedst</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="note_8cc-source.html#l00298">298</a> of file <a class="el" href="note_8cc-source.html">note.cc</a>.
<p>
References <a class="el" href="BigString_8cc-source.html#l00906">String::after</a>(), <a class="el" href="BigString_8cc-source.html#l00886">String::at</a>(), <a class="el" href="BigString_8cc-source.html#l00896">String::before</a>(), <a class="el" href="BigString_8hh-source.html#l01234">String::gsub</a>(), <a class="el" href="BigString_8hh-source.html#l01093">String::index</a>(), <a class="el" href="note_8cc-source.html#l00066">post_process_note</a>(), <a class="el" href="note_8cc-source.html#l00053">pre_process_note</a>(), <a class="el" href="templates_8defines_8hh-source.html#l00277">res</a>, and <a class="el" href="dil2al_8hh-source.html#l01407">VOUT</a>.
<p>
Referenced by <a class="el" href="note_8cc-source.html#l00330">process_note</a>().
<p>
<div class="fragment"><pre>00298                                                           {
00299         <a class="code" href="classString.html">String</a> notestr, notedststr; <font class="keywordtype">bool</font> isnew; <font class="keywordtype">int</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00300         <font class="keywordflow">if</font> ((<a class="code" href="templates_8defines_8hh.html#a11">res</a> = <a class="code" href="note_8cc.html#a1">pre_process_note</a>(notefile,notedst,<font class="stringliteral">"generic text"</font>,notestr,notedststr,isnew))&lt;=0) <font class="keywordflow">return</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00301         <font class="comment">// find a possible &lt;!-- @INSERT-AT:&lt;tag&gt;@ --&gt;</font>
00302         <font class="keywordtype">int</font> insertindex = -1;
00303         <a class="code" href="classString.html">String</a> inserttag = notestr.<a class="code" href="classString.html#a51">at</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[         ]*@INSERT-AT:[^@]+@[    ]*--[&gt;]"</font>));
00304         <font class="keywordflow">if</font> (inserttag!=<font class="stringliteral">""</font>) {
00305                 inserttag = inserttag.<a class="code" href="classString.html#a76">after</a>(<font class="stringliteral">"INSERT-AT:"</font>);
00306                 inserttag = inserttag.<a class="code" href="classString.html#a58">before</a>(<font class="stringliteral">"@"</font>,-1);
00307                 insertindex = notedststr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[        ]*@"</font>+inserttag+<font class="stringliteral">"@[      ]*--[&gt;]"</font>));
00308         }
00309         <font class="comment">// find a possible &lt;!-- @INSERT-TL-NOTE@ --&gt;</font>
00310         <font class="keywordflow">if</font> (insertindex&lt;0) insertindex = notedststr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[     ]*@INSERT-TL-NOTE@[     ]*--[&gt;]"</font>));
00311         <font class="keywordflow">if</font> ((insertindex&lt;0) &amp;&amp; (verbose))  <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"No specific insertion location in "</font> &lt;&lt; notedst &lt;&lt; <font class="stringliteral">", appending note to end\n"</font>;
00312         <font class="comment">// convert to generic text</font>
00313         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Bb][Rr][     ]*[^&gt;][&gt;]\n?"</font>),<font class="stringliteral">"\n"</font>); <font class="comment">// &lt;BR&gt;</font>
00314         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"\n?[&lt;][Pp][      ]*[^&gt;]*[&gt;]\n?"</font>),<font class="stringliteral">"\n\n"</font>); <font class="comment">// &lt;P&gt;</font>
00315         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Uu][Ll][     ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">""</font>); <font class="comment">// &lt;UL&gt;</font>
00316         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Uu][Ll][    ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">""</font>); <font class="comment">// &lt;/UL&gt;</font>
00317         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Oo][Ll][     ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">""</font>); <font class="comment">// &lt;OL&gt;</font>
00318         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Oo][Ll][    ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">""</font>); <font class="comment">// &lt;/OL&gt;</font>
00319         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Ll][Ii][     ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">"- "</font>); <font class="comment">// &lt;LI&gt;</font>
00320         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;lt;"</font>,<font class="stringliteral">"&lt;"</font>); <font class="comment">// &amp;lt;</font>
00321         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;gt;"</font>,<font class="stringliteral">"&gt;"</font>); <font class="comment">// &amp;gt;</font>
00322         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;amp;"</font>,<font class="stringliteral">"&amp;"</font>); <font class="comment">// &amp;amp;</font>
00323         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;nbsp;"</font>,<font class="stringliteral">" "</font>); <font class="comment">// &amp;nbsp;</font>
00324         <font class="comment">// clean up</font>
00325         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[        ]+\n"</font>),<font class="stringliteral">"\n"</font>);
00326         <font class="comment">// insert note into notedst</font>
00327         <font class="keywordflow">return</font> <a class="code" href="note_8cc.html#a2">post_process_note</a>(notedst,notestr,notedststr,insertindex,isnew);
00328 }
</pre></div>    </td>
  </tr>
</table>
<a name="a4" doxytag="note.cc::process_note_HTML"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int process_note_HTML </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notefile</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notedst</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="note_8cc-source.html#l00108">108</a> of file <a class="el" href="note_8cc-source.html">note.cc</a>.
<p>
References <a class="el" href="BigString_8cc-source.html#l00906">String::after</a>(), <a class="el" href="BigString_8cc-source.html#l00886">String::at</a>(), <a class="el" href="BigString_8cc-source.html#l00896">String::before</a>(), <a class="el" href="dil2al_8hh-source.html#l01406">EOUT</a>, <a class="el" href="BigString_8hh-source.html#l01093">String::index</a>(), <a class="el" href="note_8cc-source.html#l00066">post_process_note</a>(), <a class="el" href="note_8cc-source.html#l00053">pre_process_note</a>(), and <a class="el" href="templates_8defines_8hh-source.html#l00277">res</a>.
<p>
Referenced by <a class="el" href="note_8cc-source.html#l00330">process_note</a>().
<p>
<div class="fragment"><pre>00108                                                        {
00109         <a class="code" href="classString.html">String</a> notestr, notedststr; <font class="keywordtype">bool</font> isnew; <font class="keywordtype">int</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00110         <font class="keywordflow">if</font> ((<a class="code" href="templates_8defines_8hh.html#a11">res</a> = <a class="code" href="note_8cc.html#a1">pre_process_note</a>(notefile,notedst,<font class="stringliteral">"HTML"</font>,notestr,notedststr,isnew))&lt;=0) <font class="keywordflow">return</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00111         <font class="comment">// find a possible &lt;!-- @INSERT-AT:&lt;tag&gt;@ --&gt;</font>
00112         <font class="keywordtype">int</font> insertindex = -1;
00113         <a class="code" href="classString.html">String</a> inserttag = notestr.<a class="code" href="classString.html#a51">at</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[         ]*@INSERT-AT:[^@]+@[    ]*--[&gt;]"</font>));
00114         <font class="keywordflow">if</font> (inserttag!=<font class="stringliteral">""</font>) {
00115                 inserttag = inserttag.<a class="code" href="classString.html#a76">after</a>(<font class="stringliteral">"INSERT-AT:"</font>);
00116                 inserttag = inserttag.<a class="code" href="classString.html#a58">before</a>(<font class="stringliteral">"@"</font>,-1);
00117                 insertindex = notedststr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[        ]*@"</font>+inserttag+<font class="stringliteral">"@[      ]*--[&gt;]"</font>));
00118         }
00119         <font class="comment">// find a possible &lt;!-- @INSERT-TL-NOTE@ --&gt;</font>
00120         <font class="keywordflow">if</font> (insertindex&lt;0) insertindex = notedststr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[     ]*@INSERT-TL-NOTE@[     ]*--[&gt;]"</font>));
00121         <font class="comment">// find &lt;/BODY&gt;</font>
00122         <font class="keywordflow">if</font> (insertindex&lt;0) insertindex = notedststr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"&lt;/BODY&gt;"</font>);
00123         <font class="keywordflow">if</font> (insertindex&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Note destination "</font> &lt;&lt; notedst &lt;&lt; <font class="stringliteral">" missing &lt;/BODY&gt; tag, continuing\n"</font>;
00124         <font class="comment">// insert note into notedst</font>
00125         <font class="keywordflow">return</font> <a class="code" href="note_8cc.html#a2">post_process_note</a>(notedst,notestr,notedststr,insertindex,isnew);
00126 }
</pre></div>    </td>
  </tr>
</table>
<a name="a5" doxytag="note.cc::process_note_TeX"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int process_note_TeX </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notefile</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notedst</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="note_8cc-source.html#l00128">128</a> of file <a class="el" href="note_8cc-source.html">note.cc</a>.
<p>
References <a class="el" href="BigString_8cc-source.html#l00906">String::after</a>(), <a class="el" href="BigString_8cc-source.html#l00886">String::at</a>(), <a class="el" href="BigString_8cc-source.html#l00896">String::before</a>(), <a class="el" href="dil2al_8hh-source.html#l01406">EOUT</a>, <a class="el" href="BigString_8cc-source.html#l00911">String::from</a>(), <a class="el" href="BigString_8hh-source.html#l01234">String::gsub</a>(), <a class="el" href="BigString_8hh-source.html#l01093">String::index</a>(), <a class="el" href="note_8cc-source.html#l00066">post_process_note</a>(), <a class="el" href="note_8cc-source.html#l00053">pre_process_note</a>(), and <a class="el" href="templates_8defines_8hh-source.html#l00277">res</a>.
<p>
Referenced by <a class="el" href="note_8cc-source.html#l00330">process_note</a>().
<p>
<div class="fragment"><pre>00128                                                       {
00129         <a class="code" href="classString.html">String</a> notestr, notedststr; <font class="keywordtype">bool</font> isnew; <font class="keywordtype">int</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00130         <font class="keywordflow">if</font> ((<a class="code" href="templates_8defines_8hh.html#a11">res</a> = <a class="code" href="note_8cc.html#a1">pre_process_note</a>(notefile,notedst,<font class="stringliteral">"TeX"</font>,notestr,notedststr,isnew))&lt;=0) <font class="keywordflow">return</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00131         <font class="comment">// find a possible % &lt;!-- @INSERT-AT:&lt;tag&gt;@ --&gt;</font>
00132         <font class="keywordtype">int</font> insertindex = -1;
00133         <a class="code" href="classString.html">String</a> inserttag = notestr.<a class="code" href="classString.html#a51">at</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[         ]*@INSERT-AT:[^@]+@[    ]*--[&gt;]"</font>));
00134         <font class="keywordflow">if</font> (inserttag!=<font class="stringliteral">""</font>) {
00135                 inserttag = inserttag.<a class="code" href="classString.html#a76">after</a>(<font class="stringliteral">"INSERT-AT:"</font>);
00136                 inserttag = inserttag.<a class="code" href="classString.html#a58">before</a>(<font class="stringliteral">"@"</font>,-1);
00137                 insertindex = notedststr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"%[\n]*[&lt;]!--[  ]*@"</font>+inserttag+<font class="stringliteral">"@[      ]*--[&gt;]"</font>));
00138         }
00139         <font class="comment">// find a possible % &lt;!-- @INSERT-TL-NOTE@ --&gt;</font>
00140         <font class="keywordflow">if</font> (insertindex&lt;0) insertindex = notedststr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"%[\n]*[&lt;]!--[       ]*@INSERT-TL-NOTE@[     ]*--[&gt;]"</font>));
00141         <font class="comment">// find \end{document}</font>
00142         <font class="keywordflow">if</font> (insertindex&lt;0) insertindex = notedststr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"\\end{document}"</font>);
00143         <font class="comment">// find \endinput</font>
00144         <font class="keywordflow">if</font> (insertindex&lt;0) insertindex = notedststr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"\\endinput"</font>);
00145         <font class="keywordflow">if</font> (insertindex&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Note destination "</font> &lt;&lt; notedst &lt;&lt; <font class="stringliteral">" missing \\end{document} and \\endinput tags, continuing\n"</font>;
00146         <font class="comment">// convert to TeX</font>
00147         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Bb][Rr]\\([  ]+[^&gt;][&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\\\\"</font>); <font class="comment">// &lt;BR&gt;</font>
00148         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Pp]\\([      ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\n\n"</font>); <font class="comment">// &lt;P&gt;</font>
00149         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Uu][Ll]\\([  ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\\begin{itemize}"</font>); <font class="comment">// &lt;UL&gt;</font>
00150         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Uu][Ll]\\([         ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\\end{itemize}"</font>); <font class="comment">// &lt;/UL&gt;</font>
00151         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Oo][Ll]\\([  ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\\begin{enumerate}"</font>); <font class="comment">// &lt;OL&gt;</font>
00152         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Oo][Ll]\\([         ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\\end{enumerate}"</font>); <font class="comment">// &lt;/OL&gt;</font>
00153         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Ll][Ii]\\([  ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\\item "</font>); <font class="comment">// &lt;LI&gt;</font>
00154         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Hh]1\\([     ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\\section{"</font>); <font class="comment">// &lt;H1&gt;</font>
00155         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Hh]2\\([     ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\\subsection{"</font>); <font class="comment">// &lt;H2&gt;</font>
00156         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Hh]3\\([     ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\\subsubsection{"</font>); <font class="comment">// &lt;H3&gt;</font>
00157         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Hh]4\\([     ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\\paragraph{"</font>); <font class="comment">// &lt;H3&gt;</font>
00158         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Hh][1-4]\\([        ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"}"</font>); <font class="comment">// &lt;/H1&gt;,&lt;/H2&gt;,&lt;/H3&gt;,&lt;/H4&gt;</font>
00159         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Hh][Rr]\\([  ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\\hline "</font>); <font class="comment">// &lt;HR&gt;</font>
00160         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--"</font>),<font class="stringliteral">"% &lt;!--"</font>); <font class="comment">// &lt;!-- --&gt;</font>
00161         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Tt][Aa][Bb][Ll][Ee][         ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">"\\begin{tabular}{???}"</font>); <font class="comment">// &lt;TABLE&gt;</font>
00162         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Tt][Aa][Bb][Ll][Ee][        ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">"\\end{tabular}"</font>); <font class="comment">// &lt;/TABLE&gt;</font>
00163         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Tt][Rr][     ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">"\\\\\n"</font>); <font class="comment">// &lt;TR&gt;</font>
00164         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Tt][Rr][    ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">""</font>); <font class="comment">// &lt;TR&gt;</font>
00165         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Tt][Dd][     ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">" &amp; "</font>); <font class="comment">// &lt;TD&gt;</font>
00166         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Tt][Dd][    ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">""</font>); <font class="comment">// &lt;TD&gt;</font>
00167         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Tt][Hh][     ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">" &amp; {\\bf "</font>); <font class="comment">// &lt;TH&gt;</font>
00168         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Tt][Hh][    ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">"}"</font>); <font class="comment">// &lt;TH&gt;</font>
00169         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Bb]\\([      ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"{\\bf "</font>); <font class="comment">// &lt;B&gt;</font>
00170         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Ii]\\([      ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"{\\em "</font>); <font class="comment">// &lt;I&gt;</font>
00171         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Uu]\\([      ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"\\underline{"</font>); <font class="comment">// &lt;U&gt;</font>
00172         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[BbIiUu]\\([         ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"}"</font>); <font class="comment">// &lt;/B&gt;,&lt;/I&gt;,&lt;/U&gt;</font>
00173         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Ee][Mm]\\([  ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"{\\em "</font>); <font class="comment">// &lt;EM&gt;</font>
00174         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Ee][Mm]\\([         ]+[^&gt;]*[&gt;]\\|[&gt;]\\)"</font>),<font class="stringliteral">"}"</font>); <font class="comment">// &lt;/EM&gt;</font>
00175         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Ss][Tt][Rr][Oo][Nn][Gg][     ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">"{\\bf "</font>); <font class="comment">// &lt;STRONG&gt;</font>
00176         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Ss][Tt][Rr][Oo][Nn][Gg][    ]*[^&gt;]*[&gt;]"</font>),<font class="stringliteral">"}"</font>); <font class="comment">// &lt;/STRONG&gt;</font>
00177         <font class="comment">// &lt;A HREF="http://the-reference-url/"&gt;the-reference-text&lt;/A&gt;</font>
00178         <font class="comment">// &lt;A NAME="the-reference-name-tag"&gt;the-reference-anchor&lt;/A&gt;</font>
00179         <font class="keywordtype">int</font> i = 0, j = 0, k;
00180         <font class="keywordflow">while</font> (i&gt;=0) {
00181                 i = notestr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][Aa][    ]+[^&gt;]*\\([Hh][Rr][Ee][Ff]\\|[Nn][Aa][Mm][Ee]\\)[       ]*=[    ]*[^&gt;]*[&gt;].*[&lt;]/[Aa][   ]*[^&gt;]*[&gt;]"</font>),j);
00182                 <font class="keywordflow">if</font> (i&gt;=0) {
00183                         k = notestr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"&gt;"</font>,i) + 1;
00184                         j = notestr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Aa][   ]*[^&gt;]*[&gt;]"</font>),i);
00185                         <font class="keywordflow">if</font> (k&lt;j) {
00186                                 <a class="code" href="classString.html">String</a> tmpstr = <font class="stringliteral">"&lt;/A&gt;&lt;!--\n"</font>+notestr.<a class="code" href="classString.html#a51">at</a>(k,j-k)+<font class="charliteral">'\n'</font>+notestr.<a class="code" href="classString.html#a76">after</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Aa][   ]*[^&gt;]*[&gt;]"</font>),j);
00187                                 notestr = notestr.<a class="code" href="classString.html#a58">before</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]/[Aa][    ]*[^&gt;]*[&gt;]"</font>),j);
00188                                 notestr += tmpstr;
00189                                 <font class="comment">//notestr.at(BigRegex("[&lt;]/[Aa][        ]*[^&gt;]*[&gt;]"),j)="&lt;/A&gt;&lt;!--\n"+notestr.at(k,j-k)+'\n';</font>
00190                         }
00191                         <a class="code" href="classString.html">String</a> tmpstr = <font class="stringliteral">"% --&gt;"</font>+notestr.<a class="code" href="classString.html#a70">from</a>(i);
00192                         notestr = notestr.<a class="code" href="classString.html#a58">before</a>(i);
00193                         notestr += tmpstr;
00194                         <font class="comment">//notestr.at(i,1)="% --&gt;&lt;";</font>
00195                 }
00196         }
00197         <font class="comment">// other &lt;...&gt; tags</font>
00198         i = 0; j = 0;
00199         <font class="keywordflow">while</font> (i&gt;=0) {
00200                 i = notestr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][^&gt;]*[&gt;]"</font>),j);
00201                 <font class="keywordflow">if</font> (i&gt;=0) {
00202                         j = notestr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"&gt;"</font>,i);
00203                         <a class="code" href="classString.html">String</a> tmpstr = <font class="stringliteral">"% "</font>+notestr.<a class="code" href="classString.html#a51">at</a>(i,(j-i)+1)+<font class="stringliteral">"\n"</font>+notestr.<a class="code" href="classString.html#a76">after</a>(j);
00204                         notestr = notestr.<a class="code" href="classString.html#a58">before</a>(i)+tmpstr;
00205                         <font class="comment">//notestr.at(j,1) = "&gt;\n";</font>
00206                         <font class="comment">//notestr.at(i,1) = "% &lt;";</font>
00207                 }
00208         }
00209         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;lt;"</font>,<font class="stringliteral">"&lt;"</font>); <font class="comment">// &amp;lt;</font>
00210         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;gt;"</font>,<font class="stringliteral">"&gt;"</font>); <font class="comment">// &amp;gt;</font>
00211         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;amp;"</font>,<font class="stringliteral">"\\&amp;"</font>); <font class="comment">// &amp;amp;</font>
00212         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;nbsp;"</font>,<font class="stringliteral">"\\relax"</font>); <font class="comment">// &amp;nbsp;</font>
00213         <font class="comment">// clean up</font>
00214         notestr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"\n\n"</font>,<font class="stringliteral">"\n"</font>);
00215         notestr.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[        ]+\n"</font>),<font class="stringliteral">"\n"</font>);
00216         <font class="comment">// insert note into notedst</font>
00217         <font class="keywordflow">return</font> <a class="code" href="note_8cc.html#a2">post_process_note</a>(notedst,notestr,notedststr,insertindex,isnew);
00218 }
</pre></div>    </td>
  </tr>
</table>
<a name="a3" doxytag="note.cc::process_note_TL"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int process_note_TL </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notefile</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classString.html">String</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>notedst</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="note_8cc-source.html#l00080">80</a> of file <a class="el" href="note_8cc-source.html">note.cc</a>.
<p>
References <a class="el" href="tladmin_8cc-source.html#l00485">add_TL_chunk_or_entry</a>(), <a class="el" href="tladmin_8cc-source.html#l00971">decide_add_TL_chunk</a>(), <a class="el" href="dil2al_8hh-source.html#l01406">EOUT</a>, <a class="el" href="BigString_8hh-source.html#l01093">String::index</a>(), <a class="el" href="BigString_8hh-source.html#l00493">String::length</a>(), <a class="el" href="note_8cc-source.html#l00053">pre_process_note</a>(), <a class="el" href="note_8cc-source.html#l00006">process_HTML</a>(), and <a class="el" href="templates_8defines_8hh-source.html#l00277">res</a>.
<p>
Referenced by <a class="el" href="note_8cc-source.html#l00330">process_note</a>().
<p>
<div class="fragment"><pre>00080                                                      {
00081 <font class="comment">// A task log entry will be added to the current TL chunk, or to the TL chunk</font>
00082 <font class="comment">// immediately preceding a @INSERT-TL-NOTE@ tag, or optionally to a new TL chunk,</font>
00083 <font class="comment">// possibly in a new TL section.</font>
00084         <a class="code" href="classString.html">String</a> notestr, tl; <font class="keywordtype">bool</font> isnew; <font class="keywordtype">int</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00085         <font class="keywordflow">if</font> ((<a class="code" href="templates_8defines_8hh.html#a11">res</a> = <a class="code" href="note_8cc.html#a1">pre_process_note</a>(notefile,notedst,<font class="stringliteral">"Task Log"</font>,notestr,tl,isnew))&lt;=0) <font class="keywordflow">return</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00086         <font class="keyword">const</font> <font class="keywordtype">int</font> LLEN = 10240;
00087         <font class="keywordtype">char</font> lbuf[LLEN];
00088         <font class="comment">// search for &lt;!-- @INSERT-TL-NOTE@ --&gt; in TL</font>
00089         <font class="keywordtype">int</font> tlinsertloc; <font class="keywordtype">bool</font> comparetimes = <font class="keyword">true</font>;
00090         <font class="keywordflow">if</font> ((tlinsertloc = tl.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"&lt;!-- @INSERT-TL-NOTE@ --&gt;"</font>))&gt;=0) {
00091                 tlinsertloc -= tl.<a class="code" href="classString.html#a105">length</a>();
00092                 comparetimes = <font class="keyword">false</font>;
00093         }
00094         <font class="comment">// determine whether to add a new Task Log chunk</font>
00095         <a class="code" href="classString.html">String</a> chunkid;
00096         <font class="keywordflow">if</font> ((chunkid=<a class="code" href="tladmin_8cc.html#a12">decide_add_TL_chunk</a>(tl,tlinsertloc,comparetimes))==<font class="stringliteral">""</font>) <font class="keywordflow">return</font> -1;
00097         <font class="comment">// HTML process entry (and fill in @tag@ codes)</font>
00098         <a class="code" href="note_8cc.html#a0">process_HTML</a>(notestr);
00099         <font class="comment">// add entry to Task Log chunk</font>
00100         newTLID = <a class="code" href="tladmin_8cc.html#a9">add_TL_chunk_or_entry</a>(tl,notestr,<font class="keyword">false</font>,chunkid,tlinsertloc);
00101         <font class="keywordflow">if</font> (newTLID==<font class="stringliteral">""</font>) {
00102                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to add new Task Log entry in process_note_TL()\n"</font>;
00103                 <font class="keywordflow">return</font> -1;
00104         }
00105         <font class="keywordflow">return</font> tlinsertloc;
00106 }
</pre></div>    </td>
  </tr>
</table>
<hr><address align="right"><small>Generated on Mon Sep 13 14:53:15 2004 for dil2al by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
