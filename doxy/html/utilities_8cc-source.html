<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>utilities.cc Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>utilities.cc</h1><a href="utilities_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">// utilities.cc</font>
00002 <font class="comment">// Randal A. Koene, 20000304</font>
00003 
00004 <font class="preprocessor">#include "<a class="code" href="dil2al_8hh.html">dil2al.hh</a>"</font>
00005 
00006 <font class="comment">//#define DEBUG_NOVELTYMARKER</font>
00007 <font class="comment">//#define TEST_CACHE_READ</font>
00008 
<a name="l00009"></a><a class="code" href="utilities_8cc.html#a0">00009</a> <font class="preprocessor">#define READSOMETYPE char*</font>
00010 <font class="preprocessor"></font>
<a name="l00011"></a><a class="code" href="utilities_8cc.html#a1">00011</a> <font class="preprocessor">#define TEST_LBUF_BOUNDS(slen,funcname) if (slen&gt;=LLEN) { EOUT &lt;&lt; "dil2al: Number of characters exceeds lbuf bounds in " &lt;&lt; funcname &lt;&lt; '\n'; return false; }</font>
00012 <font class="preprocessor"></font>
<a name="l00013"></a><a class="code" href="utilities_8cc.html#a2">00013</a> <font class="preprocessor">#define PLAN_ENTRY_IDENTIFIER_TAG "&lt;!-- @begin: PLAN DIL TEMPLATE: "</font>
<a name="l00014"></a><a class="code" href="utilities_8cc.html#a3">00014</a> <font class="preprocessor"></font><font class="preprocessor">#define PLAN_ENTRY_IDENTIFIER_TAG_LENGTH 32</font>
<a name="l00015"></a><a class="code" href="utilities_8cc.html#a4">00015</a> <font class="preprocessor"></font><font class="preprocessor">#define PLAN_ENTRY_DECISION_TAG "&lt;BR&gt;&lt;B&gt;decision:"</font>
<a name="l00016"></a><a class="code" href="utilities_8cc.html#a5">00016</a> <font class="preprocessor"></font><font class="preprocessor">#define PLAN_ENTRY_STRING_ACTION "action"</font>
<a name="l00017"></a><a class="code" href="utilities_8cc.html#a6">00017</a> <font class="preprocessor"></font><font class="preprocessor">#define PLAN_ENTRY_STRING_GOAL "goal"</font>
<a name="l00018"></a><a class="code" href="utilities_8cc.html#a7">00018</a> <font class="preprocessor"></font><font class="preprocessor">#define PLAN_ENTRY_STRING_OBJECTIVE "objective"</font>
<a name="l00019"></a><a class="code" href="utilities_8cc.html#a8">00019</a> <font class="preprocessor"></font><font class="preprocessor">#define PLAN_ENTRY_STRING_OUTCOME "outcome"</font>
<a name="l00020"></a><a class="code" href="utilities_8cc.html#a9">00020</a> <font class="preprocessor"></font><font class="preprocessor">#define PLAN_ENTRY_STRING_VARIABLE "variable"</font>
<a name="l00021"></a><a class="code" href="utilities_8cc.html#a10">00021</a> <font class="preprocessor"></font><font class="preprocessor">#define NUM_PLAN_ENTRY_TYPES 5</font>
00022 <font class="preprocessor"></font>
<a name="l00023"></a><a class="code" href="utilities_8cc.html#a11">00023</a> <font class="keyword">const</font> <font class="keywordtype">char</font> <a class="code" href="utilities_8cc.html#a11">plan_entry_type_strings</a>[<a class="code" href="utilities_8cc.html#a10">NUM_PLAN_ENTRY_TYPES</a>][10] = {<a class="code" href="utilities_8cc.html#a5">PLAN_ENTRY_STRING_ACTION</a>,<a class="code" href="utilities_8cc.html#a6">PLAN_ENTRY_STRING_GOAL</a>,<a class="code" href="utilities_8cc.html#a7">PLAN_ENTRY_STRING_OBJECTIVE</a>,<a class="code" href="utilities_8cc.html#a8">PLAN_ENTRY_STRING_OUTCOME</a>,<a class="code" href="utilities_8cc.html#a9">PLAN_ENTRY_STRING_VARIABLE</a>};
00024 
<a name="l00025"></a><a class="code" href="classTime.html#a5">00025</a> <a class="code" href="classString.html">String</a> <a class="code" href="classTime.html#a5">Time::caltime2local</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> * dateformat) {
00026         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a20">time_stamp</a>(dateformat,<a class="code" href="classTime.html#n0">t</a>);
00027 }
00028 
<a name="l00029"></a><a class="code" href="classStringList.html#a4">00029</a> <a class="code" href="classStringList.html#a1">StringList::StringList</a>(<a class="code" href="classString.html">String</a> cs, <font class="keyword">const</font> <font class="keywordtype">char</font> sep) {
00030 <font class="comment">// initialize list from a string with a specified separator</font>
00031 <font class="comment">// (Note: In the current implementation this leaves an unused</font>
00032 <font class="comment">// list element at the end of the list.</font>
00033 <font class="comment">// Beware! If you fix this to leave no unused list element at</font>
00034 <font class="comment">// the end of the list you must check all source code where</font>
00035 <font class="comment">// this initialization function is used to insure that the</font>
00036 <font class="comment">// code is modified so as not to depend on this "feature"!)</font>
00037         <a class="code" href="classStringList.html#n0">Next</a>=NULL;
00038         <a class="code" href="classStringList.html#a14">split</a>(0,cs,sep);
00039 }
00040 
<a name="l00041"></a><a class="code" href="classStringList.html#a5">00041</a> <a class="code" href="classString.html">String</a> &amp; <a class="code" href="classStringList.html#a5">StringList::operator[]</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n) {
00042         <font class="keywordflow">if</font> (!n) <font class="keywordflow">return</font> <a class="code" href="classStringList.html#n1">s</a>;
00043         <font class="keywordflow">if</font> (!<a class="code" href="classStringList.html#n0">Next</a>) <a class="code" href="classStringList.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classStringList.html#a1">StringList</a>();
00044         <font class="keywordflow">return</font> (*Next)[n-1];
00045 }
00046 
<a name="l00047"></a><a class="code" href="classStringList.html#a7">00047</a> <a class="code" href="classStringList.html">StringList</a> * <a class="code" href="classStringList.html#a7">StringList::List_Index</a>(<font class="keywordtype">long</font> n) {
00048   <font class="keywordflow">if</font> (n&lt;0) <font class="keywordflow">return</font> NULL;
00049   <font class="keywordflow">if</font> (!n) <font class="keywordflow">return</font> <font class="keyword">this</font>;
00050   <font class="keywordflow">if</font> (!<a class="code" href="classStringList.html#n0">Next</a>) <font class="keywordflow">return</font> NULL;
00051   <font class="keywordflow">return</font> <a class="code" href="classStringList.html#n0">Next</a>-&gt;<a class="code" href="classStringList.html#a7">List_Index</a>(n-1);
00052 }
00053 
<a name="l00054"></a><a class="code" href="classStringList.html#a8">00054</a> <font class="keywordtype">void</font> <a class="code" href="classStringList.html#a8">StringList::append</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n, <a class="code" href="classString.html">String</a> &amp; ins) {
00055         <font class="keywordflow">if</font> (!n) <a class="code" href="classStringList.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classStringList.html#a1">StringList</a>(ins,<a class="code" href="classStringList.html#n0">Next</a>);
00056         <font class="keywordflow">else</font>
00057                 <font class="keywordflow">if</font> (Next) <a class="code" href="classStringList.html#n0">Next</a>-&gt;<a class="code" href="classStringList.html#a8">append</a>(n-1,ins);
00058                 <font class="keywordflow">else</font> {
00059                         <a class="code" href="classStringList.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classStringList.html#a1">StringList</a>();
00060                         <a class="code" href="classStringList.html#n0">Next</a>-&gt;<a class="code" href="classStringList.html#a8">append</a>(n-1,ins);
00061                 }
00062 }
00063 
<a name="l00064"></a><a class="code" href="classStringList.html#a9">00064</a> <font class="keywordtype">void</font> <a class="code" href="classStringList.html#a9">StringList::insert</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n, <a class="code" href="classString.html">String</a> &amp; ins) {
00065         <font class="keywordflow">if</font> (!n) { <a class="code" href="classStringList.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classStringList.html#a1">StringList</a>(<a class="code" href="classStringList.html#n1">s</a>,<a class="code" href="classStringList.html#n0">Next</a>); <a class="code" href="classStringList.html#n1">s</a> = ins; }
00066         <font class="keywordflow">else</font>
00067                 <font class="keywordflow">if</font> (Next) <a class="code" href="classStringList.html#n0">Next</a>-&gt;<a class="code" href="classStringList.html#a9">insert</a>(n-1,ins);
00068                 <font class="keywordflow">else</font> 
00069                         <font class="keywordflow">if</font> (n&gt;1) {
00070                                 <a class="code" href="classStringList.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classStringList.html#a1">StringList</a>();
00071                                 <a class="code" href="classStringList.html#n0">Next</a>-&gt;<a class="code" href="classStringList.html#a9">insert</a>(n-1,ins);
00072                         } <font class="keywordflow">else</font> <a class="code" href="classStringList.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classStringList.html#a1">StringList</a>(ins);
00073 }
00074 
<a name="l00075"></a><a class="code" href="classStringList.html#a11">00075</a> <font class="keywordtype">long</font> <a class="code" href="classStringList.html#a11">StringList::iselement</a>(<a class="code" href="classString.html">String</a> el, <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n = 0) {
00076         <font class="keywordflow">if</font> (el == <a class="code" href="classStringList.html#n1">s</a>) <font class="keywordflow">return</font> n;
00077         <font class="keywordflow">else</font> {
00078                 <font class="keywordflow">if</font> (Next) <font class="keywordflow">return</font> <a class="code" href="classStringList.html#n0">Next</a>-&gt;<a class="code" href="classStringList.html#a11">iselement</a>(el,n+1);
00079                 <font class="keywordflow">else</font> <font class="keywordflow">return</font> -1;
00080         }
00081 }
00082 
<a name="l00083"></a><a class="code" href="classStringList.html#a12">00083</a> <font class="keywordtype">long</font> <a class="code" href="classStringList.html#a12">StringList::contains</a>(<a class="code" href="classString.html">String</a> substr, <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n = 0) {
00084         <font class="keywordflow">if</font> (<a class="code" href="classStringList.html#n1">s</a>.<a class="code" href="classString.html#a32">contains</a>(substr)) <font class="keywordflow">return</font> n;
00085         <font class="keywordflow">else</font> {
00086                 <font class="keywordflow">if</font> (Next) <font class="keywordflow">return</font> <a class="code" href="classStringList.html#n0">Next</a>-&gt;<a class="code" href="classStringList.html#a12">contains</a>(substr,n+1);
00087                 <font class="keywordflow">else</font> <font class="keywordflow">return</font> -1;
00088         }
00089 }
00090 
<a name="l00091"></a><a class="code" href="classStringList.html#a13">00091</a> <font class="keywordtype">long</font> <a class="code" href="classStringList.html#a13">StringList::first_contained_in</a>(<a class="code" href="classString.html">String</a> &amp; sourcestr, <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n = 0) {
00092   <font class="keywordflow">if</font> (sourcestr.<a class="code" href="classString.html#a32">contains</a>(<a class="code" href="classStringList.html#n1">s</a>)) <font class="keywordflow">return</font> n;
00093   <font class="keywordflow">else</font> {
00094     <font class="keywordflow">if</font> (Next) <font class="keywordflow">return</font> <a class="code" href="classStringList.html#n0">Next</a>-&gt;<a class="code" href="classStringList.html#a13">first_contained_in</a>(sourcestr,n+1);
00095     <font class="keywordflow">else</font> <font class="keywordflow">return</font> -1;
00096   }
00097 }
00098 
<a name="l00099"></a><a class="code" href="classStringList.html#a14">00099</a> <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> <a class="code" href="classStringList.html#a14">StringList::split</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n, <a class="code" href="classString.html">String</a> cs, <font class="keyword">const</font> <font class="keywordtype">char</font> sep = <font class="charliteral">'\n'</font>) {
00100 <font class="comment">// insert list elements from a string with a specified separator</font>
00101         <font class="keywordflow">if</font> (cs.<a class="code" href="classString.html#a105">length</a>()&lt;=0) <font class="keywordflow">return</font> <a class="code" href="classStringList.html#a10">length</a>();
00102         <a class="code" href="classString.html">String</a> el;
00103         <font class="keywordflow">if</font> (cs.<a class="code" href="classString.html#a26">index</a>(sep)&gt;=0) el = cs.<a class="code" href="classString.html#a58">before</a>(sep); <font class="keywordflow">else</font> el = cs;
00104         <font class="comment">// *** this is not a speed optimized implementation</font>
00105         <a class="code" href="classStringList.html#a9">insert</a>(n,el);
00106         <a class="code" href="classStringList.html#a14">split</a>(n+1,cs.<a class="code" href="classString.html#a76">after</a>(sep),sep);
00107         <font class="keywordflow">return</font> <a class="code" href="classStringList.html#a10">length</a>();
00108 }
00109 
<a name="l00110"></a><a class="code" href="classStringList.html#a15">00110</a> <a class="code" href="classString.html">String</a> <a class="code" href="classStringList.html#a15">StringList::concatenate</a>(<a class="code" href="classString.html">String</a> sepstr = <font class="stringliteral">""</font>) {
00111         <font class="keywordflow">if</font> (Next) <font class="keywordflow">return</font> <a class="code" href="classStringList.html#n1">s</a>+sepstr+<a class="code" href="classStringList.html#n0">Next</a>-&gt;<a class="code" href="classStringList.html#a15">concatenate</a>(sepstr);
00112         <font class="keywordflow">else</font> <font class="keywordflow">return</font> <a class="code" href="classStringList.html#n1">s</a>;
00113 }
00114 
<a name="l00115"></a><a class="code" href="classLongList.html#a4">00115</a> <a class="code" href="classLongList.html#a1">LongList::LongList</a>(<a class="code" href="classString.html">String</a> cs, <font class="keyword">const</font> <font class="keywordtype">char</font> sep) {
00116 <font class="comment">// initialize list from a string with a specified separator</font>
00117 <font class="comment">// (Note: In the current implementation this leaves an unused</font>
00118 <font class="comment">// list element at the end of the list.)</font>
00119         <a class="code" href="classLongList.html#n0">Next</a>=NULL;
00120         <a class="code" href="classLongList.html#a12">split</a>(0,cs,sep);
00121 }
00122 
<a name="l00123"></a><a class="code" href="classLongList.html#a5">00123</a> <font class="keywordtype">long</font> &amp; <a class="code" href="classLongList.html#a5">LongList::operator[]</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n) {
00124         <font class="keywordflow">if</font> (!n) <font class="keywordflow">return</font> <a class="code" href="classLongList.html#n1">s</a>;
00125         <font class="keywordflow">if</font> (!<a class="code" href="classLongList.html#n0">Next</a>) <a class="code" href="classLongList.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classLongList.html#a1">LongList</a>();
00126         <font class="keywordflow">return</font> (*Next)[n-1];
00127 }
00128 
<a name="l00129"></a><a class="code" href="classLongList.html#a7">00129</a> <font class="keywordtype">void</font> <a class="code" href="classLongList.html#a7">LongList::append</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n, <font class="keywordtype">long</font> &amp; ins) {
00130         <font class="keywordflow">if</font> (!n) <a class="code" href="classLongList.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classLongList.html#a1">LongList</a>(ins,<a class="code" href="classLongList.html#n0">Next</a>);
00131         <font class="keywordflow">else</font>
00132                 <font class="keywordflow">if</font> (Next) <a class="code" href="classLongList.html#n0">Next</a>-&gt;<a class="code" href="classLongList.html#a7">append</a>(n-1,ins);
00133                 <font class="keywordflow">else</font> {
00134                         <a class="code" href="classLongList.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classLongList.html#a1">LongList</a>();
00135                         <a class="code" href="classLongList.html#n0">Next</a>-&gt;<a class="code" href="classLongList.html#a7">append</a>(n-1,ins);
00136                 }
00137 }
00138 
<a name="l00139"></a><a class="code" href="classLongList.html#a8">00139</a> <font class="keywordtype">void</font> <a class="code" href="classLongList.html#a8">LongList::insert</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n, <font class="keywordtype">long</font> &amp; ins) {
00140         <font class="keywordflow">if</font> (!n) { <a class="code" href="classLongList.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classLongList.html#a1">LongList</a>(<a class="code" href="classLongList.html#n1">s</a>,<a class="code" href="classLongList.html#n0">Next</a>); <a class="code" href="classLongList.html#n1">s</a> = ins; }
00141         <font class="keywordflow">else</font>
00142                 <font class="keywordflow">if</font> (Next) <a class="code" href="classLongList.html#n0">Next</a>-&gt;<a class="code" href="classLongList.html#a8">insert</a>(n-1,ins);
00143                 <font class="keywordflow">else</font> 
00144                         <font class="keywordflow">if</font> (n&gt;1) {
00145                                 <a class="code" href="classLongList.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classLongList.html#a1">LongList</a>();
00146                                 <a class="code" href="classLongList.html#n0">Next</a>-&gt;<a class="code" href="classLongList.html#a8">insert</a>(n-1,ins);
00147                         } <font class="keywordflow">else</font> <a class="code" href="classLongList.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classLongList.html#a1">LongList</a>(ins);
00148 }
00149 
<a name="l00150"></a><a class="code" href="classLongList.html#a10">00150</a> <font class="keywordtype">long</font> <a class="code" href="classLongList.html#a10">LongList::iselement</a>(<font class="keywordtype">long</font> el, <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n = 0) {
00151         <font class="keywordflow">if</font> (el == <a class="code" href="classLongList.html#n1">s</a>) <font class="keywordflow">return</font> n;
00152         <font class="keywordflow">else</font> {
00153                 <font class="keywordflow">if</font> (Next) <font class="keywordflow">return</font> <a class="code" href="classLongList.html#n0">Next</a>-&gt;<a class="code" href="classLongList.html#a10">iselement</a>(el,n+1);
00154                 <font class="keywordflow">else</font> <font class="keywordflow">return</font> -1;
00155         }
00156 }
00157 
<a name="l00158"></a><a class="code" href="classLongList.html#a11">00158</a> <font class="keywordtype">long</font> <a class="code" href="classLongList.html#a11">LongList::contains</a>(<font class="keywordtype">long</font> substr, <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n = 0) {
00159         <font class="keywordflow">return</font> <a class="code" href="classLongList.html#a10">iselement</a>(substr,n);
00160 }
00161 
<a name="l00162"></a><a class="code" href="classLongList.html#a12">00162</a> <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> <a class="code" href="classLongList.html#a12">LongList::split</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n, <a class="code" href="classString.html">String</a> cs, <font class="keyword">const</font> <font class="keywordtype">char</font> sep = <font class="charliteral">'\n'</font>) {
00163 <font class="comment">// insert list elements from a string with a specified separator</font>
00164         <font class="keywordflow">if</font> (cs.<a class="code" href="classString.html#a105">length</a>()&lt;=0) <font class="keywordflow">return</font> <a class="code" href="classLongList.html#a9">length</a>();
00165         <a class="code" href="classString.html">String</a> el;
00166         <font class="keywordflow">if</font> (cs.<a class="code" href="classString.html#a26">index</a>(sep)&gt;=0) el = cs.<a class="code" href="classString.html#a58">before</a>(sep); <font class="keywordflow">else</font> el = cs;
00167         <font class="comment">// *** this is not a speed optimized implementation</font>
00168         <font class="keywordtype">long</font> elval = atol(el.<a class="code" href="classString.html#a104">chars</a>());
00169         <a class="code" href="classLongList.html#a8">insert</a>(n,elval);
00170         <a class="code" href="classLongList.html#a12">split</a>(n+1,cs.<a class="code" href="classString.html#a76">after</a>(sep),sep);
00171         <font class="keywordflow">return</font> <a class="code" href="classLongList.html#a9">length</a>();
00172 }
00173 
<a name="l00174"></a><a class="code" href="classLongList.html#a13">00174</a> <a class="code" href="classString.html">String</a> <a class="code" href="classLongList.html#a13">LongList::concatenate</a>(<a class="code" href="classString.html">String</a> sepstr = <font class="stringliteral">""</font>) {
00175         <font class="keywordflow">if</font> (Next) <font class="keywordflow">return</font> <a class="code" href="classString.html">String</a>(<a class="code" href="classLongList.html#n1">s</a>)+sepstr+<a class="code" href="classLongList.html#n0">Next</a>-&gt;<a class="code" href="classLongList.html#a13">concatenate</a>(sepstr);
00176         <font class="keywordflow">else</font> <font class="keywordflow">return</font> <a class="code" href="classString.html">String</a>(<a class="code" href="classLongList.html#n1">s</a>);
00177 }
00178 
<a name="l00179"></a><a class="code" href="classQuick__String__Hash.html#b0">00179</a> <a class="code" href="classQuick__String__Hash.html">Quick_String_Hash</a> * <a class="code" href="classQuick__String__Hash.html#b0">Quick_String_Hash::add_list_element</a>(<font class="keywordtype">int</font> i) {
00180 <font class="comment">// Note: currently there is no way for this to return NULL, since allocation</font>
00181 <font class="comment">// errors are not caught.</font>
00182         <font class="keywordflow">if</font> (i&lt;0) i = 0; <font class="comment">// reduce the impact of roll-over errors</font>
00183         <font class="keywordflow">if</font> (!<a class="code" href="classQuick__String__Hash.html#n0">list</a>) { <font class="comment">// allocate list of pointers</font>
00184                 <a class="code" href="classQuick__String__Hash.html#n2">len</a> = 1;
00185                 <a class="code" href="classQuick__String__Hash.html#n0">list</a> = <font class="keyword">new</font> <a class="code" href="classQuick__String__Hash.html">Quick_String_Hash</a>*[<a class="code" href="classQuick__String__Hash.html#n2">len</a>];
00186 <font class="preprocessor">#ifdef CONST_QUICK_STRING_HASH_ENDNODE</font>
00187 <font class="preprocessor"></font>                <a class="code" href="classQuick__String__Hash.html#n0">list</a>[0] = const_cast&lt;Quick_String_Hash *&gt;(&amp;_qsh_endnode);
00188 <font class="preprocessor">#else</font>
00189 <font class="preprocessor"></font>                <a class="code" href="classQuick__String__Hash.html#n0">list</a>[0] = <font class="keyword">new</font> <a class="code" href="classQuick__String__Hash.html#a0">Quick_String_Hash</a>();
00190 <font class="preprocessor">#endif</font>
00191 <font class="preprocessor"></font>                <a class="code" href="classQuick__String__Hash.html#n1">offset</a> = i;
00192                 <font class="keywordflow">return</font> <a class="code" href="classQuick__String__Hash.html#n0">list</a>[0];
00193         }
00194         <font class="keywordflow">if</font> (i&lt;<a class="code" href="classQuick__String__Hash.html#n1">offset</a>) { <font class="comment">// prepend to the list</font>
00195                 <font class="keywordtype">int</font> oldlen = <a class="code" href="classQuick__String__Hash.html#n2">len</a>;
00196                 <a class="code" href="classQuick__String__Hash.html#n2">len</a> += (<a class="code" href="classQuick__String__Hash.html#n1">offset</a>-i);
00197                 <a class="code" href="classQuick__String__Hash.html#n1">offset</a> = i;
00198                 <a class="code" href="classQuick__String__Hash.html">Quick_String_Hash</a> ** oldlist = <a class="code" href="classQuick__String__Hash.html#n0">list</a>;
00199                 list = <font class="keyword">new</font> <a class="code" href="classQuick__String__Hash.html">Quick_String_Hash</a>*[<a class="code" href="classQuick__String__Hash.html#n2">len</a>];
00200                 <font class="keywordflow">for</font> (<font class="keywordtype">int</font> j = 0; j&lt;<a class="code" href="classQuick__String__Hash.html#n2">len</a>; j++) list[j] = NULL; <font class="comment">// initialize list</font>
00201 <font class="preprocessor">#ifdef CONST_QUICK_STRING_HASH_ENDNODE</font>
00202 <font class="preprocessor"></font>                list[0] = const_cast&lt;Quick_String_Hash *&gt;(&amp;_qsh_endnode);
00203 <font class="preprocessor">#else</font>
00204 <font class="preprocessor"></font>                list[0] = <font class="keyword">new</font> <a class="code" href="classQuick__String__Hash.html#a0">Quick_String_Hash</a>();
00205 <font class="preprocessor">#endif</font>
00206 <font class="preprocessor"></font>                <font class="keywordflow">for</font> (<font class="keywordtype">int</font> j = oldlen-1, k = <a class="code" href="classQuick__String__Hash.html#n2">len</a>-1; j&gt;=0; j--, k--) list[k] = oldlist[j];
00207                 <font class="keyword">delete</font>[] oldlist;
00208                 <font class="keywordflow">return</font> list[0];
00209         }
00210         i -= <a class="code" href="classQuick__String__Hash.html#n1">offset</a>;
00211         <font class="keywordflow">if</font> (i&gt;=<a class="code" href="classQuick__String__Hash.html#n2">len</a>) { <font class="comment">// append to the list</font>
00212                 <font class="keywordtype">int</font> oldlen = <a class="code" href="classQuick__String__Hash.html#n2">len</a>;
00213                 <a class="code" href="classQuick__String__Hash.html#n2">len</a> = i+1;
00214                 <a class="code" href="classQuick__String__Hash.html">Quick_String_Hash</a> ** oldlist = <a class="code" href="classQuick__String__Hash.html#n0">list</a>;
00215                 list = <font class="keyword">new</font> <a class="code" href="classQuick__String__Hash.html">Quick_String_Hash</a>*[<a class="code" href="classQuick__String__Hash.html#n2">len</a>];
00216                 <font class="keywordflow">for</font> (<font class="keywordtype">int</font> j = 0; j&lt;<a class="code" href="classQuick__String__Hash.html#n2">len</a>; j++) list[j] = NULL; <font class="comment">// initialize list</font>
00217 <font class="preprocessor">#ifdef CONST_QUICK_STRING_HASH_ENDNODE</font>
00218 <font class="preprocessor"></font>                list[i] = const_cast&lt;Quick_String_Hash *&gt;(&amp;_qsh_endnode);
00219 <font class="preprocessor">#else</font>
00220 <font class="preprocessor"></font>                list[i] = <font class="keyword">new</font> <a class="code" href="classQuick__String__Hash.html#a0">Quick_String_Hash</a>();
00221 <font class="preprocessor">#endif</font>
00222 <font class="preprocessor"></font>                <font class="keywordflow">for</font> (<font class="keywordtype">int</font> j = 0; j&lt;oldlen; j++) list[j] = oldlist[j];
00223                 <font class="keyword">delete</font>[] oldlist;
00224                 <font class="keywordflow">return</font> list[i];
00225         }
00226         <font class="keywordflow">if</font> (!<a class="code" href="classQuick__String__Hash.html#n0">list</a>[i]) { <font class="comment">// add list element</font>
00227 <font class="preprocessor">#ifdef CONST_QUICK_STRING_HASH_ENDNODE</font>
00228 <font class="preprocessor"></font>                <a class="code" href="classQuick__String__Hash.html#n0">list</a>[i] = const_cast&lt;Quick_String_Hash *&gt;(&amp;_qsh_endnode);
00229 <font class="preprocessor">#else</font>
00230 <font class="preprocessor"></font>                <a class="code" href="classQuick__String__Hash.html#n0">list</a>[i] = <font class="keyword">new</font> <a class="code" href="classQuick__String__Hash.html#a0">Quick_String_Hash</a>();
00231 <font class="preprocessor">#endif</font>
00232 <font class="preprocessor"></font>                <font class="keywordflow">return</font> <a class="code" href="classQuick__String__Hash.html#n0">list</a>[i];
00233         }
00234 }
00235 
<a name="l00236"></a><a class="code" href="classQuick__String__Hash.html#a2">00236</a> <a class="code" href="classQuick__String__Hash.html">Quick_String_Hash</a> &amp; <a class="code" href="classQuick__String__Hash.html#a2">Quick_String_Hash::insert</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> * s) {
00237 <font class="comment">// *** can adapt this to the faster method according to results obtained with read and read_recursive</font>
00238         <font class="keywordflow">if</font> (s[0]==<font class="charliteral">'\0'</font>) <font class="keywordflow">return</font> (*this);
00239         <font class="keywordtype">int</font> i = ((int) s[0]);   <font class="comment">// implied list coordinate</font>
00240         <font class="keywordtype">int</font> r = i - <a class="code" href="classQuick__String__Hash.html#n1">offset</a>;             <font class="comment">// real list coordinate</font>
00241         <font class="keywordflow">if</font> (r&lt;0) {
00242                 <font class="keywordflow">if</font> (<a class="code" href="classQuick__String__Hash.html#b0">add_list_element</a>(i)==NULL) <font class="keywordflow">return</font> (*this);
00243                 r = i - <a class="code" href="classQuick__String__Hash.html#n1">offset</a>; <font class="comment">// adjust to new offset</font>
00244         } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (r&gt;=<a class="code" href="classQuick__String__Hash.html#n2">len</a>) {
00245                 <font class="keywordflow">if</font> (<a class="code" href="classQuick__String__Hash.html#b0">add_list_element</a>(i)==NULL) <font class="keywordflow">return</font> (*this); <font class="comment">// this also takes care of the case where the list is unallocated</font>
00246                 r = i - <a class="code" href="classQuick__String__Hash.html#n1">offset</a>; <font class="comment">// adjust to new offset</font>
00247         } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (!<a class="code" href="classQuick__String__Hash.html#n0">list</a>[r]) {
00248                 <font class="keywordflow">if</font> (<a class="code" href="classQuick__String__Hash.html#b0">add_list_element</a>(i)==NULL) <font class="keywordflow">return</font> (*this);
00249         }
00250 <font class="preprocessor">#ifdef CONST_QUICK_STRING_HASH_ENDNODE</font>
00251 <font class="preprocessor"></font>        <font class="keywordflow">if</font> ((s[1]!=<font class="charliteral">'\0'</font>) &amp;&amp; (<a class="code" href="classQuick__String__Hash.html#n0">list</a>[r]==&amp;_qsh_endnode)) <a class="code" href="classQuick__String__Hash.html#n0">list</a>[r] = <font class="keyword">new</font> <a class="code" href="classQuick__String__Hash.html#a0">Quick_String_Hash</a>(); <font class="comment">// allocate so that list can be made</font>
00252 <font class="preprocessor">#endif</font>
00253 <font class="preprocessor"></font>        <a class="code" href="classQuick__String__Hash.html#n0">list</a>[r]-&gt;<a class="code" href="classQuick__String__Hash.html#a2">insert</a>(&amp;s[1]);
00254         <font class="keywordflow">return</font> (*this);
00255 }
00256 
00257 <font class="preprocessor">#ifdef RECURSIVE_QUICK_STRING_HASH</font>
<a name="l00258"></a><a class="code" href="classQuick__String__Hash.html#a4">00258</a> <font class="preprocessor"></font><font class="keywordtype">int</font> <a class="code" href="classQuick__String__Hash.html#a4">Quick_String_Hash::read</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> * s)<font class="keyword"> const </font>{
00259         <font class="comment">// Determines if the next character in s exists in the tree</font>
00260         <font class="keywordflow">if</font> (s[0]==<font class="charliteral">'\0'</font>) <font class="keywordflow">return</font> 1;
00261         <font class="keywordtype">int</font> i = ((int) s[0]);   <font class="comment">// implied list coordinate</font>
00262         <font class="keywordflow">if</font> (i&lt;<a class="code" href="classQuick__String__Hash.html#n1">offset</a>) <font class="keywordflow">return</font> 0;
00263         i -= <a class="code" href="classQuick__String__Hash.html#n1">offset</a>;                    <font class="comment">// real list coordinate</font>
00264         <font class="keywordflow">if</font> (i&gt;=<a class="code" href="classQuick__String__Hash.html#n2">len</a>) <font class="keywordflow">return</font> 0;   <font class="comment">// this also takes care of the case where the list is unallocated</font>
00265         <font class="keywordflow">if</font> (<a class="code" href="classQuick__String__Hash.html#n0">list</a>[i]) <font class="keywordflow">return</font> <a class="code" href="classQuick__String__Hash.html#n0">list</a>[i]-&gt;<a class="code" href="classQuick__String__Hash.html#a4">read</a>(&amp;s[1]);
00266         <font class="keywordflow">return</font> 0;
00267 }
00268 <font class="preprocessor">#else</font>
00269 <font class="preprocessor"></font><font class="keywordtype">int</font> <a class="code" href="classQuick__String__Hash.html#a4">Quick_String_Hash::read</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> * s)<font class="keyword"> const </font>{
00270         <font class="comment">// Determines if the next character in s exists in the tree</font>
00271         <font class="keywordtype">int</font> i; <font class="keyword">const</font> <a class="code" href="classQuick__String__Hash.html">Quick_String_Hash</a> * qsh = <font class="keyword">this</font>;
00272         <font class="keywordflow">for</font> (<font class="keyword">const</font> <font class="keywordtype">char</font> * c = s; (*c!=<font class="charliteral">'\0'</font>); c++) {
00273                 i = ((int) *c); <font class="comment">// implied list coordinate</font>
00274                 <font class="keywordflow">if</font> (i&lt;qsh-&gt;<a class="code" href="classQuick__String__Hash.html#n1">offset</a>) <font class="keywordflow">return</font> 0;
00275                 i -= qsh-&gt;<a class="code" href="classQuick__String__Hash.html#n1">offset</a>;       <font class="comment">// real list coordinate</font>
00276                 <font class="keywordflow">if</font> (i&gt;=qsh-&gt;<a class="code" href="classQuick__String__Hash.html#n2">len</a>) <font class="keywordflow">return</font> 0; <font class="comment">// this also takes care of the case where the list is unallocated</font>
00277                 <font class="keywordflow">if</font> (!qsh-&gt;<a class="code" href="classQuick__String__Hash.html#n0">list</a>[i]) <font class="keywordflow">return</font> 0;
00278                 qsh = qsh-&gt;<a class="code" href="classQuick__String__Hash.html#n0">list</a>[i];     <font class="comment">// traverse tree</font>
00279         }
00280         <font class="keywordflow">return</font> 1;
00281 }
00282 <font class="preprocessor">#endif</font>
00283 <font class="preprocessor"></font>
<a name="l00284"></a><a class="code" href="classQuick__String__Hash.html#a6">00284</a> <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> <a class="code" href="classQuick__String__Hash.html#a6">Quick_String_Hash::nodes</a>()<font class="keyword"> const </font>{
00285 <font class="preprocessor">#ifdef CONST_QUICK_STRING_HASH_ENDNODE</font>
00286 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (<font class="keyword">this</font>==&amp;_qsh_endnode) <font class="keywordflow">return</font> 0;
00287 <font class="preprocessor">#endif</font>
00288 <font class="preprocessor"></font>        <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a> = 1;
00289         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;<a class="code" href="classQuick__String__Hash.html#n2">len</a>; i++) <font class="keywordflow">if</font> (<a class="code" href="classQuick__String__Hash.html#n0">list</a>[i]) <a class="code" href="templates_8defines_8hh.html#a11">res</a> += <a class="code" href="classQuick__String__Hash.html#n0">list</a>[i]-&gt;<a class="code" href="classQuick__String__Hash.html#a6">nodes</a>();
00290         <font class="keywordflow">return</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00291 }
00292 
<a name="l00293"></a><a class="code" href="classQuick__String__Hash.html#a7">00293</a> <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> <a class="code" href="classQuick__String__Hash.html#a7">Quick_String_Hash::size</a>()<font class="keyword"> const </font>{
00294 <font class="preprocessor">#ifdef CONST_QUICK_STRING_HASH_ENDNODE</font>
00295 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (<font class="keyword">this</font>==&amp;_qsh_endnode) <font class="keywordflow">return</font> 0;
00296 <font class="preprocessor">#endif</font>
00297 <font class="preprocessor"></font>        <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">sizeof</font>(*this);
00298         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;<a class="code" href="classQuick__String__Hash.html#n2">len</a>; i++) <font class="keywordflow">if</font> (<a class="code" href="classQuick__String__Hash.html#n0">list</a>[i]) <a class="code" href="templates_8defines_8hh.html#a11">res</a> += <a class="code" href="classQuick__String__Hash.html#n0">list</a>[i]-&gt;<a class="code" href="classQuick__String__Hash.html#a7">size</a>();
00299         <font class="keywordflow">return</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
00300 }
00301 <font class="preprocessor">#ifdef CONST_QUICK_STRING_HASH_ENDNODE</font>
00302 <font class="preprocessor"></font><font class="keyword">const</font> <a class="code" href="classQuick__String__Hash.html">Quick_String_Hash</a> _qsh_endnode;
00303 <font class="preprocessor">#endif</font>
00304 <font class="preprocessor"></font>
<a name="l00305"></a><a class="code" href="classDirectory__Access.html#a1">00305</a> <font class="keywordtype">int</font> <a class="code" href="classDirectory__Access.html#a1">Directory_Access::read</a>(<a class="code" href="classString.html">String</a> &amp; filenames, <font class="keywordtype">char</font> separator = <font class="charliteral">'/'</font>) {
00306         <font class="comment">// reads the directory into a String</font>
00307         <font class="comment">// (using String as the buffer keeps Directory_Access independent</font>
00308         <font class="comment">// of more specialized classes, such as StringList)</font>
00309         <font class="comment">// note: the separator character is placed at the start of each</font>
00310         <font class="comment">// filename - calls to read can therefore concatenate directories</font>
00311         <font class="comment">// into one String</font>
00312         <font class="comment">// returns -1 if an error occurred, otherwise returns number of</font>
00313         <font class="comment">// filenames found</font>
00314         <font class="keyword">struct </font>dirent *d;
00315         DIR * D = opendir(<a class="code" href="classDirectory__Access.html#n0">dirpath</a>);
00316         <font class="keywordflow">if</font> (!D) <font class="keywordflow">return</font> -1;
00317         <font class="keywordtype">int</font> num;
00318         <font class="keywordflow">for</font> (num = 0; (d = readdir(D)); num++) filenames += separator+<a class="code" href="classString.html">String</a>(d-&gt;d_name);
00319         <font class="keywordflow">return</font> num;
00320 }
00321 
<a name="l00322"></a><a class="code" href="classNovelty__Marker.html#a0">00322</a> <a class="code" href="classNovelty__Marker.html#a0">Novelty_Marker::Novelty_Marker</a>(<font class="keywordtype">int</font> hdepth = 0): id(""), marktext(""), inclurl(""), imp(NULL), impnum(0), len(0.0), hierdepth(hdepth), nmtype(NM_NOVELTY_ITEM) {
00323         <a class="code" href="classNovelty__Marker.html#m4">context</a>[0] = <font class="stringliteral">""</font>;
00324         <a class="code" href="classNovelty__Marker.html#m8">section</a>[0] = <font class="stringliteral">""</font>;
00325 }
00326 
<a name="l00327"></a><a class="code" href="classNovelty__Marker.html#a2">00327</a> <font class="keywordtype">int</font> <a class="code" href="classNovelty__Marker.html#a2">Novelty_Marker::Get_Novelty_from_Paper_Plan</a>(<a class="code" href="classString.html">String</a> &amp; pptext, <font class="keywordtype">int</font> startp, <font class="keywordtype">int</font> starthierdepth = 0) {
00328 <font class="comment">// searches for Novelty marker data in a paper plan, returns the location at</font>
00329 <font class="comment">// which one was found and sets all object variables to match, returns -1 if</font>
00330 <font class="comment">// none was found, starts searching at character number startp in pptext</font>
00331         <font class="keywordtype">int</font> nmidx, hierstart, hierend = -1;
00332 <font class="comment">//      if (starthierdepth&gt;0) {</font>
00333         <a class="code" href="classNovelty__Marker.html#m9">hierdepth</a> = starthierdepth; <font class="comment">// set to current depth</font>
00334         hierend = pptext.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"&lt;/UL&gt;"</font>,startp);
00335 <font class="comment">//      }</font>
00336         nmidx = pptext.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]B[&gt;][         ]*Section[      ]*[&lt;]/B[&gt;][     ]*:"</font>),startp);
00337         hierstart = pptext.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[      ]*@TOPICAL CONTEXT@[    ]*--[&gt;]"</font>),startp);
00338         <font class="keywordflow">if</font> ((hierend&lt;0) &amp;&amp; (nmidx&lt;0) &amp;&amp; (hierstart&lt;0)) <font class="keywordflow">return</font> -1;
00339         <font class="keywordflow">if</font> (((<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>) nmidx &lt; (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>) hierstart) &amp;&amp; ((<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>) nmidx &lt; (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>) hierend)) { <font class="comment">// get item</font>
00340 <font class="preprocessor">#ifdef DEBUG_NOVELTYMARKER</font>
00341 <font class="preprocessor"></font>                cout &lt;&lt; <font class="charliteral">'!'</font>;
00342 <font class="preprocessor">#endif</font>
00343 <font class="preprocessor"></font>                <a class="code" href="classNovelty__Marker.html#m10">nmtype</a> = <a class="code" href="classNovelty__Marker.html#s8s0">NM_NOVELTY_ITEM</a>;
00344                 <font class="keywordtype">int</font> nmend = pptext.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">")"</font>,nmidx);
00345 <font class="preprocessor">#ifdef DEBUG_NOVELTYMARKER</font>
00346 <font class="preprocessor"></font>                <font class="keywordflow">if</font> (nmend&lt;0) cout &lt;&lt; '&gt;';
00347 <font class="preprocessor">#endif</font>
00348 <font class="preprocessor"></font>                <font class="keywordflow">if</font> (nmend&lt;0) <font class="keywordflow">return</font> -1;
00349                 nmidx = pptext.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"&lt;LI&gt;"</font>,nmidx-pptext.<a class="code" href="classString.html#a105">length</a>());
00350 <font class="preprocessor">#ifdef DEBUG_NOVELTYMARKER</font>
00351 <font class="preprocessor"></font>                <font class="keywordflow">if</font> (nmidx&lt;startp) cout &lt;&lt; <font class="charliteral">'&lt;'</font>;
00352 <font class="preprocessor">#endif</font>
00353 <font class="preprocessor"></font>                <font class="keywordflow">if</font> (nmidx&lt;startp) <font class="keywordflow">return</font> -1;
00354                 <a class="code" href="classString.html">String</a> nmexcerpt = pptext.<a class="code" href="classString.html#a51">at</a>(nmidx,(nmend-nmidx)+1);
00355                 <font class="comment">// get marked text</font>
00356                 <a class="code" href="classNovelty__Marker.html#m2">marktext</a> = nmexcerpt.<a class="code" href="classString.html#a58">before</a>(<font class="stringliteral">"("</font>,-1);
00357                 <a class="code" href="classNovelty__Marker.html#m2">marktext</a>.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&lt;BR&gt;\n"</font>,<font class="stringliteral">""</font>);
00358                 <font class="comment">// identify REQUIRED item</font>
00359                 <font class="keywordflow">if</font> (<a class="code" href="classNovelty__Marker.html#m2">marktext</a>.<a class="code" href="classString.html#a32">contains</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]LI[&gt;][       ]*\\([&lt;][^&gt;]*[&gt;]\\)?[   ]*REQUIRE[      ]*:"</font>))) {
00360                         <a class="code" href="classNovelty__Marker.html#m10">nmtype</a> = <a class="code" href="classNovelty__Marker.html#s8s6">NM_REQUIRED_ITEM</a>;
00361                         <a class="code" href="classNovelty__Marker.html#m2">marktext</a>.<a class="code" href="classString.html#a83">del</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]LI[&gt;][        ]*\\([&lt;][^&gt;]*[&gt;]\\)?[   ]*REQUIRE[      ]*:[    ]*\\([&lt;][^&gt;]*[&gt;]\\)?[   ]*"</font>));
00362                 } <font class="keywordflow">else</font> {
00363                         <font class="comment">// get source file</font>
00364                         <a class="code" href="classNovelty__Marker.html#m1">source</a> = <a class="code" href="classNovelty__Marker.html#m2">marktext</a>.<a class="code" href="classString.html#a51">at</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]A[    ]+[^&gt;]*[Hh][Rr][Ee][Ff][^\"]*\"[^\"]+\""</font>));
00365                         <a class="code" href="classNovelty__Marker.html#m1">source</a>.<a class="code" href="classString.html#a83">del</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]A[      ]+[^&gt;]*[Hh][Rr][Ee][Ff][^\"]*\""</font>));
00366                         <a class="code" href="classNovelty__Marker.html#m1">source</a>.<a class="code" href="classString.html#a83">del</a>(<font class="stringliteral">"\""</font>);
00367                         <font class="comment">// get NOVELTY ID</font>
00368                         <a class="code" href="classNovelty__Marker.html#m0">id</a> = <a class="code" href="classNovelty__Marker.html#m1">source</a>.<a class="code" href="classString.html#a76">after</a>(<font class="stringliteral">"#"</font>);
00369 <font class="comment">//cout &lt;&lt; "NMID=" &lt;&lt; id &lt;&lt; '\n'; cout.flush();</font>
00370                         <font class="comment">// clean up source file</font>
00371                         <font class="keywordflow">if</font> (<a class="code" href="classNovelty__Marker.html#m0">id</a>!=<font class="stringliteral">""</font>) <a class="code" href="classNovelty__Marker.html#m1">source</a> = <a class="code" href="classNovelty__Marker.html#m1">source</a>.<a class="code" href="classString.html#a58">before</a>(<font class="stringliteral">"#"</font>);
00372                         <font class="comment">// clean up marked text</font>
00373                         <a class="code" href="classNovelty__Marker.html#m2">marktext</a>.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[[][^]]*NOVELTY-[^]]*[]]"</font>),<font class="stringliteral">""</font>);
00374                 }
00375                 <font class="comment">// clean up marked text</font>
00376                 <a class="code" href="classNovelty__Marker.html#m2">marktext</a>.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][^&gt;]*[&gt;]"</font>),<font class="stringliteral">""</font>);
00377                 <font class="comment">// get contexts</font>
00378                 nmexcerpt = nmexcerpt.<a class="code" href="classString.html#a76">after</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"([^C]*Context[^:]*:[      ]*"</font>),-1);
00379                 <a class="code" href="classString.html">String</a> c = nmexcerpt.<a class="code" href="classString.html#a58">before</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"\\([&lt;][^&gt;]*[&gt;]\\)?[       ]*Importance[   ]*\\([&lt;][^&gt;]*[&gt;]\\)?[   ]*:"</font>));
00380                 <font class="keywordtype">int</font> cidx = 0; <a class="code" href="classString.html">String</a> cc;
00381                 <font class="keywordflow">while</font> ((cc = c.<a class="code" href="classString.html#a51">at</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[^  ][^,]*"</font>)))!=<font class="stringliteral">""</font>) {
00382                         cc.<a class="code" href="classString.html#a83">del</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[      ]*$"</font>));
00383                         <a class="code" href="classNovelty__Marker.html#m4">context</a>[cidx] = cc;
00384                         cidx++;
00385                         c = c.<a class="code" href="classString.html#a76">after</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[^        ][^,]*,?"</font>));
00386                 }
00387                 <font class="comment">// get importances</font>
00388                 nmexcerpt = nmexcerpt.<a class="code" href="classString.html#a76">after</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"\\([&lt;][^&gt;]*[&gt;]\\)?[       ]*Importance[   ]*\\([&lt;][^&gt;]*[&gt;]\\)?[   ]*:[    ]*"</font>));
00389                 c = nmexcerpt.<a class="code" href="classString.html#a58">before</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"\\([&lt;][^&gt;]*[&gt;]\\)?[      ]*Length[       ]*\\([&lt;][^&gt;]*[&gt;]\\)?[   ]*:"</font>));
00390                 <font class="keywordflow">if</font> (imp) <font class="keyword">delete</font>[] <a class="code" href="classNovelty__Marker.html#m5">imp</a>;
00391                 <a class="code" href="classNovelty__Marker.html#m6">impnum</a> = <a class="code" href="classNovelty__Marker.html#m4">context</a>.<a class="code" href="classStringList.html#a10">length</a>();
00392                 <a class="code" href="classNovelty__Marker.html#m5">imp</a> = <font class="keyword">new</font> <font class="keywordtype">float</font>[<a class="code" href="classNovelty__Marker.html#m6">impnum</a>];
00393                 <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;<a class="code" href="classNovelty__Marker.html#m6">impnum</a>; i++) <a class="code" href="classNovelty__Marker.html#m5">imp</a>[i] = 0.0;
00394                 cidx = 0;
00395                 <font class="keywordflow">while</font> ((cc = c.<a class="code" href="classString.html#a51">at</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[^  ][^,]*"</font>)))!=<font class="stringliteral">""</font>) {
00396                         cc.<a class="code" href="classString.html#a83">del</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[      ]*$"</font>));
00397                         <a class="code" href="classNovelty__Marker.html#m5">imp</a>[cidx] = (float) atof((<font class="keyword">const</font> <font class="keywordtype">char</font> *) cc);
00398                         cidx++;
00399                         c = c.<a class="code" href="classString.html#a76">after</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[^        ][^,]*,?"</font>));
00400                 }
00401                 <font class="keywordflow">if</font> (!cidx) {
00402                         <font class="keyword">delete</font>[] <a class="code" href="classNovelty__Marker.html#m5">imp</a>;
00403                         <a class="code" href="classNovelty__Marker.html#m5">imp</a> = NULL;
00404                         <a class="code" href="classNovelty__Marker.html#m6">impnum</a> = 0;
00405                 }
00406                 <font class="keywordflow">if</font> (cidx==1) {
00407                         <font class="keywordtype">float</font> * impone = <font class="keyword">new</font> <font class="keywordtype">float</font>[1];
00408                         impone[0] = <a class="code" href="classNovelty__Marker.html#m5">imp</a>[0];
00409                         <font class="keyword">delete</font>[] <a class="code" href="classNovelty__Marker.html#m5">imp</a>;
00410                         <a class="code" href="classNovelty__Marker.html#m5">imp</a> = impone;
00411                         <a class="code" href="classNovelty__Marker.html#m6">impnum</a> = 1;
00412                 }
00413                 <font class="comment">// get length</font>
00414                 nmexcerpt = nmexcerpt.<a class="code" href="classString.html#a76">after</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"\\([&lt;][^&gt;]*[&gt;]\\)?[       ]*Length[       ]*\\([&lt;][^&gt;]*[&gt;]\\)?[   ]*:[    ]*"</font>));
00415                 c = nmexcerpt.<a class="code" href="classString.html#a58">before</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"\\([&lt;][^&gt;]*[&gt;]\\)?[      ]*Section[      ]*\\([&lt;][^&gt;]*[&gt;]\\)?[   ]*:"</font>));
00416                 <font class="keywordflow">if</font> ((cc = c.<a class="code" href="classString.html#a51">at</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[^     ][^,]*"</font>)))!=<font class="stringliteral">""</font>) {
00417                         cc.<a class="code" href="classString.html#a83">del</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[      ]*$"</font>));
00418                         <a class="code" href="classNovelty__Marker.html#m7">len</a> = (float) atof((<font class="keyword">const</font> <font class="keywordtype">char</font> *) cc);
00419                 }
00420                 <font class="comment">// get sections</font>
00421                 nmexcerpt = nmexcerpt.<a class="code" href="classString.html#a76">after</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"\\([&lt;][^&gt;]*[&gt;]\\)?[       ]*Section[      ]*\\([&lt;][^&gt;]*[&gt;]\\)?[   ]*:[    ]*"</font>));
00422                 c = nmexcerpt.<a class="code" href="classString.html#a58">before</a>(<font class="stringliteral">")"</font>);
00423                 cidx = 0;
00424                 <font class="keywordflow">while</font> ((cc = c.<a class="code" href="classString.html#a51">at</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[^  ][^,]*"</font>)))!=<font class="stringliteral">""</font>) {
00425                         cc.<a class="code" href="classString.html#a83">del</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[      ]*$"</font>));
00426                         <a class="code" href="classNovelty__Marker.html#m8">section</a>[cidx] = cc;
00427                         cidx++;
00428                         c = c.<a class="code" href="classString.html#a76">after</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[^        ][^,]*,?"</font>));
00429                 }
00430                 <font class="keywordflow">return</font> nmend;
00431         } <font class="keywordflow">else</font> <font class="keywordflow">if</font> ((<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>) hierstart &lt; (<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>) hierend) { <font class="comment">// increase hierarchy depth</font>
00432 <font class="preprocessor">#ifdef DEBUG_NOVELTYMARKER</font>
00433 <font class="preprocessor"></font>                cout &lt;&lt; <font class="charliteral">'^'</font>;
00434 <font class="preprocessor">#endif</font>
00435 <font class="preprocessor"></font>                <a class="code" href="classNovelty__Marker.html#m10">nmtype</a> = <a class="code" href="classNovelty__Marker.html#s8s1">NM_TCH_DEPTH_INC</a>;
00436                 <a class="code" href="classString.html">String</a> nmexcerpt = pptext.<a class="code" href="classString.html#a51">at</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&gt;][^\n]+"</font>),hierstart);
00437                 <font class="keywordflow">if</font> (nmexcerpt==<font class="stringliteral">""</font>) {
00438                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Incomplete @TOPICAL CONTEXT@ detected in Novelty_Marker::Get_Novelty_from_Paper_Plan()\n"</font>;
00439                         <font class="keywordflow">return</font> -1;
00440                 }
00441                 nmexcerpt.<a class="code" href="classString.html#a83">del</a>(<font class="stringliteral">"&gt;"</font>);
00442                 nmexcerpt.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;][^&gt;]*[&gt;]"</font>),<font class="stringliteral">""</font>);
00443                 <a class="code" href="classNovelty__Marker.html#m4">context</a>[0] = nmexcerpt;
00444                 <a class="code" href="classNovelty__Marker.html#m9">hierdepth</a>++;
00445                 <font class="keywordflow">return</font> hierstart+nmexcerpt.<a class="code" href="classString.html#a105">length</a>()+1;
00446         } <font class="keywordflow">else</font> { <font class="comment">// decrease hierarchy depth</font>
00447 <font class="preprocessor">#ifdef DEBUG_NOVELTYMARKER</font>
00448 <font class="preprocessor"></font>                cout &lt;&lt; <font class="charliteral">'v'</font>;
00449 <font class="preprocessor">#endif</font>
00450 <font class="preprocessor"></font>                <a class="code" href="classNovelty__Marker.html#m10">nmtype</a> = <a class="code" href="classNovelty__Marker.html#s8s2">NM_TCH_DEPTH_DEC</a>;
00451                 <a class="code" href="classNovelty__Marker.html#m9">hierdepth</a>--;
00452                 <font class="keywordflow">if</font> (<a class="code" href="classNovelty__Marker.html#m9">hierdepth</a>&lt;0) <font class="keywordflow">return</font> -1;     <font class="comment">// beyond end of TCH</font>
00453                 <font class="keywordflow">return</font> hierend+4;
00454         }
00455 }
00456 
<a name="l00457"></a><a class="code" href="classNovelty__Marker__List.html#a4">00457</a> <a class="code" href="classNovelty__Marker.html">Novelty_Marker</a> &amp; <a class="code" href="classNovelty__Marker__List.html#a4">Novelty_Marker_List::operator[]</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n) {
00458         <font class="keywordflow">if</font> (!n) <font class="keywordflow">return</font> <a class="code" href="classNovelty__Marker__List.html#n1">s</a>;
00459         <font class="keywordflow">if</font> (!<a class="code" href="classNovelty__Marker__List.html#n0">Next</a>) <a class="code" href="classNovelty__Marker__List.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classNovelty__Marker__List.html#a1">Novelty_Marker_List</a>();
00460         <font class="keywordflow">return</font> (*Next)[n-1];
00461 }
00462 
<a name="l00463"></a><a class="code" href="classNovelty__Marker__List.html#a6">00463</a> <font class="keywordtype">void</font> <a class="code" href="classNovelty__Marker__List.html#a6">Novelty_Marker_List::append</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n, <a class="code" href="classNovelty__Marker.html">Novelty_Marker</a> &amp; ins) {
00464         <font class="keywordflow">if</font> (!n) <a class="code" href="classNovelty__Marker__List.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classNovelty__Marker__List.html#a1">Novelty_Marker_List</a>(ins,<a class="code" href="classNovelty__Marker__List.html#n0">Next</a>);
00465         <font class="keywordflow">else</font>
00466                 <font class="keywordflow">if</font> (Next) <a class="code" href="classNovelty__Marker__List.html#n0">Next</a>-&gt;<a class="code" href="classNovelty__Marker__List.html#a6">append</a>(n-1,ins);
00467                 <font class="keywordflow">else</font> {
00468                         <a class="code" href="classNovelty__Marker__List.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classNovelty__Marker__List.html#a1">Novelty_Marker_List</a>();
00469                         <a class="code" href="classNovelty__Marker__List.html#n0">Next</a>-&gt;<a class="code" href="classNovelty__Marker__List.html#a6">append</a>(n-1,ins);
00470                 }
00471 }
00472 
<a name="l00473"></a><a class="code" href="classNovelty__Marker__List.html#a7">00473</a> <font class="keywordtype">void</font> <a class="code" href="classNovelty__Marker__List.html#a7">Novelty_Marker_List::insert</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n, <a class="code" href="classNovelty__Marker.html">Novelty_Marker</a> &amp; ins) {
00474         <font class="keywordflow">if</font> (!n) { <a class="code" href="classNovelty__Marker__List.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classNovelty__Marker__List.html#a1">Novelty_Marker_List</a>(<a class="code" href="classNovelty__Marker__List.html#n1">s</a>,<a class="code" href="classNovelty__Marker__List.html#n0">Next</a>); <a class="code" href="classNovelty__Marker__List.html#n1">s</a> = ins; }
00475         <font class="keywordflow">else</font>
00476                 <font class="keywordflow">if</font> (Next) <a class="code" href="classNovelty__Marker__List.html#n0">Next</a>-&gt;<a class="code" href="classNovelty__Marker__List.html#a7">insert</a>(n-1,ins);
00477                 <font class="keywordflow">else</font> 
00478                         <font class="keywordflow">if</font> (n&gt;1) {
00479                                 <a class="code" href="classNovelty__Marker__List.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classNovelty__Marker__List.html#a1">Novelty_Marker_List</a>();
00480                                 <a class="code" href="classNovelty__Marker__List.html#n0">Next</a>-&gt;<a class="code" href="classNovelty__Marker__List.html#a7">insert</a>(n-1,ins);
00481                         } <font class="keywordflow">else</font> <a class="code" href="classNovelty__Marker__List.html#n0">Next</a> = <font class="keyword">new</font> <a class="code" href="classNovelty__Marker__List.html#a1">Novelty_Marker_List</a>(ins);
00482 }
00483 
<a name="l00484"></a><a class="code" href="classNovelty__Marker__List.html#a9">00484</a> <font class="keywordtype">long</font> <a class="code" href="classNovelty__Marker__List.html#a9">Novelty_Marker_List::iselement</a>(<a class="code" href="classNovelty__Marker.html">Novelty_Marker</a> &amp; el, <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> n = 0) {
00485         <font class="keywordflow">if</font> ((el.<a class="code" href="classNovelty__Marker.html#m1">source</a> == <a class="code" href="classNovelty__Marker__List.html#n1">s</a>.<a class="code" href="classNovelty__Marker.html#m1">source</a>) &amp;&amp; (el.<a class="code" href="classNovelty__Marker.html#m0">id</a> == <a class="code" href="classNovelty__Marker__List.html#n1">s</a>.<a class="code" href="classNovelty__Marker.html#m0">id</a>)) <font class="keywordflow">return</font> n;
00486         <font class="keywordflow">else</font> {
00487                 <font class="keywordflow">if</font> (Next) <font class="keywordflow">return</font> <a class="code" href="classNovelty__Marker__List.html#n0">Next</a>-&gt;<a class="code" href="classNovelty__Marker__List.html#a9">iselement</a>(el,n+1);
00488                 <font class="keywordflow">else</font> <font class="keywordflow">return</font> -1;
00489         }
00490 }
00491 
<a name="l00492"></a><a class="code" href="classNovelty__Marker__List.html#a10">00492</a> <font class="keywordtype">void</font> <a class="code" href="classNovelty__Marker__List.html#a10">Novelty_Marker_List::Get_Context_Ranks</a>(<a class="code" href="classStringList.html">StringList</a> &amp; cc, <a class="code" href="classLongList.html">LongList</a> &amp; ccr) {
00493 <font class="comment">// creates a list of concatenated contexts and a ranking according to their</font>
00494 <font class="comment">// average Novelty Item importance parameter values (rank 0 is highest)</font>
00495         <font class="keywordtype">int</font> cclen = 0, i; <a class="code" href="classString.html">String</a> <a class="code" href="classNovelty__Marker__List.html#n1">s</a>; <a class="code" href="classLongList.html">LongList</a> ccnum;
00496         <font class="keywordflow">for</font> (<a class="code" href="classNovelty__Marker__List.html">Novelty_Marker_List</a> * nml = <font class="keyword">this</font>; (nml); nml=nml-&gt;<a class="code" href="classNovelty__Marker__List.html#a5">get_Next</a>()) <font class="keywordflow">if</font> ((*nml)[0].nmtype==<a class="code" href="classNovelty__Marker.html#s8s0">Novelty_Marker::NM_NOVELTY_ITEM</a>) {
00497                 s = (*nml)[0].context.concatenate(<font class="stringliteral">", "</font>);
00498                 <font class="keywordflow">if</font> ((i=cc.<a class="code" href="classStringList.html#a11">iselement</a>(s))&lt;0) { <font class="comment">// add new concatenated context</font>
00499                         cc[cclen] = s; ccnum[cclen] = 0; i = cclen; cclen++;
00500                 }
00501                 ccnum[i]++;
00502                 <font class="keywordtype">float</font> imp = 0.0;
00503                 <font class="keywordflow">for</font> (<font class="keywordtype">int</font> j = 0; j&lt;(*nml)[0].impnum; j++) imp += (*nml)[0].imp[j];
00504                 <font class="keywordflow">if</font> ((*nml)[0].impnum&gt;1) imp /= (float) (*nml)[0].impnum; <font class="comment">// average importance of concatenated contexts of Novelty Item</font>
00505                 ccr[i] = (long) (imp*1000.0);
00506         }
00507         <font class="keywordflow">for</font> (i=0; i&lt;cclen; i++) ccr[i] /= ccnum[i]; <font class="comment">// average importances of concatenated contexts</font>
00508         <font class="keywordtype">long</font> biggest, rank = 0, cctodo = cclen;
00509         <font class="keywordflow">while</font> (cctodo&gt;0) {
00510                 <font class="comment">// find biggest</font>
00511                 biggest = -1;
00512                 <font class="keywordflow">for</font> (i=0; i&lt;cclen; i++) if (ccr[i]&gt;biggest) biggest = ccr[i];
00513                 <font class="keywordflow">if</font> (biggest&lt;0) <font class="keywordflow">break</font>;
00514                 <font class="comment">// set all at biggest size to next rank</font>
00515                 <font class="keywordflow">for</font> (i=0; i&lt;cclen; i++) <font class="keywordflow">if</font> (ccr[i]==biggest) {
00516                         ccnum[i] = rank; ccr[i] = -1; cctodo--;
00517                 }
00518                 rank++;
00519         }
00520         <font class="keywordflow">for</font> (i=0; i&lt;cclen; i++) ccr[i] = ccnum[i];
00521 }
00522 
<a name="l00523"></a><a class="code" href="classDIL__ID.html#a14">00523</a> <a class="code" href="classString.html">String</a> <a class="code" href="classDIL__ID.html#a14">DIL_ID::str</a>()<font class="keyword"> const </font>{
00524         <font class="keyword">static</font> <a class="code" href="classString.html">String</a> idstr; <font class="comment">// stored in function, not objects, static to avoid problems with lifetime of object that return value points to</font>
00525         idstr = <a class="code" href="classString.html">String</a>((<font class="keywordtype">long</font>) <a class="code" href="classDIL__ID.html#m0">idmajor</a>[1]);
00526         <font class="keywordflow">while</font> (idstr.<a class="code" href="classString.html#a105">length</a>()&lt;6) idstr.<a class="code" href="classString.html#a22">prepend</a>(<font class="charliteral">'0'</font>);
00527         idstr.<a class="code" href="classString.html#a22">prepend</a>(<a class="code" href="classString.html">String</a>((<font class="keywordtype">long</font>) <a class="code" href="classDIL__ID.html#m0">idmajor</a>[0]));
00528         idstr += <font class="charliteral">'.'</font> + <a class="code" href="classString.html">String</a>((<font class="keywordtype">long</font>) <a class="code" href="classDIL__ID.html#m1">idminor</a>);
00529 <font class="comment">/*cout &lt;&lt; "chars() RESULT at end of str() function: ";</font>
00530 <font class="comment">int i = 0;</font>
00531 <font class="comment">for (char * tp = (char *) idstr.chars(); (*tp!='\0') &amp;&amp; (i&lt;80); tp++, i++) cout &lt;&lt; (*tp) &lt;&lt; '{' &lt;&lt; (int) (*tp) &lt;&lt; '}';</font>
00532 <font class="comment">cout &lt;&lt; '\n';*/</font>
00533         <font class="keywordflow">return</font> idstr;
00534 }
00535 
<a name="l00536"></a><a class="code" href="classDIL__ID.html#a18">00536</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__ID.html#a18">DIL_ID::Write_DIL_ID_to_Binary_Cache</a>(ofstream &amp; cfl) {
00537   <font class="comment">// DIL_ID</font>
00538   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) <font class="keyword">this</font>, <font class="keyword">sizeof</font>(<a class="code" href="classDIL__ID.html">DIL_ID</a>));
00539   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00540 }
00541 
<a name="l00542"></a><a class="code" href="classDIL__ID.html#a19">00542</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__ID.html#a19">DIL_ID::Read_DIL_ID_from_Binary_Cache</a>(ifstream &amp; cfl) {
00543   <font class="comment">// DIL_ID</font>
00544   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) <font class="keyword">this</font>, <font class="keyword">sizeof</font>(<a class="code" href="classDIL__ID.html">DIL_ID</a>))).gcount()&lt;<font class="keyword">sizeof</font>(DIL_ID)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00545   <font class="comment">// alternative code:</font>
00546   <font class="comment">//  if ((cfl.read((READSOMETYPE) idmajor, sizeof(idnumber)*2)).gcount()&lt;(sizeof(idnumber)*2)) return false;</font>
00547   <font class="comment">//  if ((cfl.read((READSOMETYPE) (&amp;idminor), sizeof(idminor))).gcount()&lt;sizeof(idminor)) return false;</font>
00548   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00549 }
00550 
<a name="l00551"></a><a class="code" href="classPlan__entry__content.html#a4">00551</a> <font class="keywordtype">void</font> <a class="code" href="classPlan__entry__content.html#a4">Plan_entry_content::Parse_Entry_Content</a>(<font class="keywordtype">int</font> parsefrom = 0) {
00552   <font class="comment">// find plan specific information in DIL entry text content</font>
00553   <font class="keywordflow">if</font> (<a class="code" href="classPlan__entry__content.html#n1">planentrytype</a>==<a class="code" href="dil2al_8hh.html#a12">PLAN_ENTRY_TYPE_GOAL</a>) {
00554     <a class="code" href="classString.html">String</a> &amp; ctxt = *(<a class="code" href="classPlan__entry__content.html#n0">entry</a>-&gt;<a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#m4">text</a>);
00555     <font class="keywordtype">int</font> i;
00556     <font class="comment">// note: This assumes that action alternatives are elements of the first</font>
00557     <font class="comment">// ordered list in the text.</font>
00558     <font class="keywordflow">if</font> ((i=ctxt.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"&lt;OL&gt;"</font>,parsefrom))&gt;=0) {
00559       <a class="code" href="classString.html">String</a> listparams, listcontent;
00560       <font class="keywordflow">if</font> ((i=<a class="code" href="utilities_8cc.html#a56">HTML_get_list</a>(ctxt,i,listparams,listcontent))&gt;=0) {
00561         <a class="code" href="utilities_8cc.html#a61">HTML_remove_comments</a>(listcontent);
00562         <a class="code" href="classString.html">String</a> itemcontent; <font class="keywordtype">int</font> j = 0; <a class="code" href="classPlan__entry__content.html#n2">decision</a> = -1;
00563         <font class="keywordflow">while</font> ((j=<a class="code" href="utilities_8cc.html#a57">HTML_get_list_item</a>(listcontent,j,listparams,itemcontent))&gt;=0) {
00564           <a class="code" href="classPlan__entry__content.html#n2">decision</a>++;
00565           <font class="comment">// *** The decision tag has not yet been tested</font>
00566           <font class="keywordflow">if</font> (itemcontent.<a class="code" href="classString.html#a32">contains</a>(<a class="code" href="utilities_8cc.html#a4">PLAN_ENTRY_DECISION_TAG</a>)) {
00567             <a class="code" href="classString.html">String</a> hreftext;
00568             <font class="keywordflow">if</font> (<a class="code" href="utilities_8cc.html#a58">HTML_get_href</a>(itemcontent,0,listparams,hreftext)&gt;=0) {
00569               <a class="code" href="classPlan__entry__content.html#n3">decisionID</a> = hreftext;
00570               <font class="keywordflow">break</font>;
00571             }
00572           }
00573         }
00574         <font class="keywordflow">if</font> (<a class="code" href="classPlan__entry__content.html#n2">decision</a>==0) <font class="keywordflow">if</font> (<a class="code" href="utilities_8cc.html#a58">HTML_get_href</a>(itemcontent,0,listparams,listcontent)&gt;=0) <a class="code" href="classPlan__entry__content.html#n3">decisionID</a> = listcontent;
00575         <font class="keywordflow">if</font> ((<a class="code" href="classPlan__entry__content.html#n2">decision</a>&gt;0) &amp;&amp; (!<a class="code" href="classPlan__entry__content.html#n3">decisionID</a>.<a class="code" href="classDIL__ID.html#a17">valid</a>())) <a class="code" href="classPlan__entry__content.html#n2">decision</a> = -1; <font class="comment">// alternatives exist, but no decision specified</font>
00576       }
00577     }
00578   }
00579 }
00580 
<a name="l00581"></a><a class="code" href="classDIL__entry__content.html#a1">00581</a> <a class="code" href="classDIL__entry__content.html#a1">DIL_entry_content::DIL_entry_content</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a> &amp; e): entry(&amp;e), planentrytype(<a class="code" href="dil2al_8hh.html#a9">PLAN_ENTRY_TYPE_UNASSIGNED</a>), plancontent(NULL), started(0), required(0), completion(0.0), valuation(0.0), text(NULL) {}
00582 
<a name="l00583"></a><a class="code" href="classDIL__entry__content.html#a2">00583</a> <font class="keywordtype">int</font> <a class="code" href="classDIL__entry__content.html#a2">DIL_entry_content::Is_Plan_Entry</a>() {
00584   <font class="comment">// attempts to determine if the DIL entry content contains PLAN entry data</font>
00585   <font class="comment">// *** this should be upgraded to obtain the DIL entry content if it is</font>
00586   <font class="comment">//     not available</font>
00587   <font class="keywordflow">if</font> (<a class="code" href="classDIL__entry__content.html#n1">planentrytype</a>!=<a class="code" href="dil2al_8hh.html#a9">PLAN_ENTRY_TYPE_UNASSIGNED</a>) <font class="keywordflow">return</font> <a class="code" href="classDIL__entry__content.html#n1">planentrytype</a>;
00588   <font class="keywordflow">if</font> (!<a class="code" href="classDIL__entry__content.html#m4">text</a>) {
00589     <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Warning - no content-&gt;text available for DIL_entry_content::Is_Plan_Entry() --- obtaining content-&gt;text automatically is not yet implemented, continuing as is\n"</font>;
00590     <font class="keywordflow">return</font> <a class="code" href="dil2al_8hh.html#a9">PLAN_ENTRY_TYPE_UNASSIGNED</a>;
00591   }
00592   <a class="code" href="classString.html">String</a> &amp; ctxt = (*text);
00593   <font class="comment">// Note: The following expects a specific tag, including spaces.</font>
00594   <font class="keywordtype">int</font> j,k; <a class="code" href="classDIL__entry__content.html#n1">planentrytype</a> = <a class="code" href="dil2al_8hh.html#a10">PLAN_ENTRY_TYPE_NONE</a>;
00595   <font class="keywordflow">if</font> ((j=ctxt.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="utilities_8cc.html#a2">PLAN_ENTRY_IDENTIFIER_TAG</a>))&lt;0) <font class="keywordflow">return</font> <a class="code" href="dil2al_8hh.html#a10">PLAN_ENTRY_TYPE_NONE</a>;
00596   j += <a class="code" href="utilities_8cc.html#a3">PLAN_ENTRY_IDENTIFIER_TAG_LENGTH</a>;
00597   <font class="keywordflow">if</font> ((k=ctxt.<a class="code" href="classString.html#a26">index</a>(<font class="charliteral">'@'</font>,j))&lt;0) <font class="keywordflow">return</font> <a class="code" href="dil2al_8hh.html#a10">PLAN_ENTRY_TYPE_NONE</a>;
00598   <a class="code" href="classString.html">String</a> idtagstr(ctxt.<a class="code" href="classString.html#a51">at</a>(j,k-j));
00599   <font class="keywordflow">for</font> (j=0; j&lt;<a class="code" href="utilities_8cc.html#a10">NUM_PLAN_ENTRY_TYPES</a>; j++) <font class="keywordflow">if</font> (idtagstr==<a class="code" href="utilities_8cc.html#a11">plan_entry_type_strings</a>[j]) { <a class="code" href="classDIL__entry__content.html#n1">planentrytype</a>=j+1; <font class="keywordflow">break</font>; }
00600   <font class="comment">// provide other information</font>
00601   <font class="keywordflow">if</font> (<a class="code" href="classDIL__entry__content.html#n1">planentrytype</a>!=<a class="code" href="dil2al_8hh.html#a10">PLAN_ENTRY_TYPE_NONE</a>) <a class="code" href="classDIL__entry__content.html#n2">plancontent</a> = <font class="keyword">new</font> <a class="code" href="classPlan__entry__content.html">Plan_entry_content</a>(*<a class="code" href="classDIL__entry__content.html#n0">entry</a>,<a class="code" href="classDIL__entry__content.html#n1">planentrytype</a>,k);
00602   <font class="keywordflow">return</font> <a class="code" href="classDIL__entry__content.html#n1">planentrytype</a>;
00603 }
00604 
<a name="l00605"></a><a class="code" href="classDIL__entry__content.html#a4">00605</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry__content.html#a4">DIL_entry_content::Write_Topical_to_Binary_Cache</a>(ofstream &amp; cfl, <font class="keywordtype">bool</font> gottext) {
00606   <font class="comment">// started</font>
00607   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__entry__content.html#m0">started</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__entry__content.html#m0">started</a>));
00608   <font class="comment">// required</font>
00609   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__entry__content.html#m1">required</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__entry__content.html#m1">required</a>));
00610   <font class="comment">// completion</font>
00611   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__entry__content.html#m2">completion</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__entry__content.html#m2">completion</a>));
00612   <font class="comment">// valuation</font>
00613   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__entry__content.html#m3">valuation</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__entry__content.html#m3">valuation</a>));
00614   <font class="comment">// text</font>
00615   <font class="keywordflow">if</font> (gottext) {
00616     <font class="keywordtype">int</font> textlen = 0;
00617     <font class="keywordflow">if</font> (text) textlen = <a class="code" href="classDIL__entry__content.html#m4">text</a>-&gt;<a class="code" href="classString.html#a105">length</a>();
00618     cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;textlen), <font class="keyword">sizeof</font>(textlen));
00619     cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) <a class="code" href="classDIL__entry__content.html#m4">text</a>-&gt;<a class="code" href="classString.html#a104">chars</a>(), textlen);
00620   }
00621   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00622 }
00623 
<a name="l00624"></a><a class="code" href="classDIL__entry__content.html#a5">00624</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry__content.html#a5">DIL_entry_content::Read_Topical_from_Binary_Cache</a>(ifstream &amp; cfl, <font class="keywordtype">bool</font> gottext) {
00625   <font class="keyword">const</font> <font class="keywordtype">int</font> LLEN = 10240;
00626   <font class="keywordtype">char</font> lbuf[LLEN];
00627   <font class="comment">// started</font>
00628   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__entry__content.html#m0">started</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__entry__content.html#m0">started</a>))).gcount()&lt;<font class="keyword">sizeof</font>(started)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00629   <font class="comment">// required</font>
00630   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__entry__content.html#m1">required</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__entry__content.html#m1">required</a>))).gcount()&lt;<font class="keyword">sizeof</font>(required)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00631   <font class="comment">// completion</font>
00632   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__entry__content.html#m2">completion</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__entry__content.html#m2">completion</a>))).gcount()&lt;<font class="keyword">sizeof</font>(completion)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00633   <font class="comment">// valuation</font>
00634   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__entry__content.html#m3">valuation</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__entry__content.html#m3">valuation</a>))).gcount()&lt;<font class="keyword">sizeof</font>(valuation)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00635   <font class="comment">// text</font>
00636   <font class="keywordflow">if</font> (gottext) {
00637     <font class="keywordtype">int</font> textlen;
00638     <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;textlen), <font class="keyword">sizeof</font>(textlen))).gcount()&lt;<font class="keyword">sizeof</font>(textlen)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00639     <a class="code" href="utilities_8cc.html#a1">TEST_LBUF_BOUNDS</a>(textlen,<font class="stringliteral">"DIL_Topical_List::Read_from_Binary_Cache()"</font>)
00640       <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) lbuf, textlen)).gcount()&lt;textlen) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00641     lbuf[textlen]=<font class="charliteral">'\0'</font>;
00642     <font class="keyword">delete</font> <a class="code" href="classDIL__entry__content.html#m4">text</a>; <font class="comment">// remove prior allocation</font>
00643     <a class="code" href="classDIL__entry__content.html#m4">text</a> = <font class="keyword">new</font> <a class="code" href="classString.html">String</a>(lbuf);
00644   }
00645   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00646 }
00647 
<a name="l00648"></a><a class="code" href="classDIL__entry__content.html#a6">00648</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry__content.html#a6">DIL_entry_content::Binary_Cache_Diagnostic</a>(<a class="code" href="classDIL__entry__content.html">DIL_entry_content</a> * cached,<font class="keywordtype">int</font> &amp; testedbytes) {
00649   <font class="comment">// test if the quick load cache process works reliably</font>
00650   <font class="comment">// this is the original entry_content, cached is the one retrieved from the binary cache</font>
00651   <font class="keywordtype">int</font> localtestedbytes = 0;
00652   <font class="comment">// *** Add caching and diagnostics for Plan_entry_content</font>
00653   localtestedbytes += <font class="keyword">sizeof</font>(planentrytype) + <font class="keyword">sizeof</font>(plancontent);
00654   <font class="keywordflow">if</font> (plancontent) {
00655     localtestedbytes += <font class="keyword">sizeof</font>(Plan_entry_content);
00656     <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Implementation Warning - Plan_entry_content is not yet cached!\n"</font>;
00657   }
00658   <font class="keywordflow">if</font> ((*entry)!=(*(cached-&gt;<a class="code" href="classDIL__entry__content.html#n0">entry</a>))) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_entry_content entry mismatch\n"</font>; <font class="comment">// testing if DIL_ID==DIL_ID</font>
00659   localtestedbytes += <font class="keyword">sizeof</font>(entry);
00660   <font class="keywordflow">if</font> (<a class="code" href="classDIL__entry__content.html#m0">started</a>!=cached-&gt;<a class="code" href="classDIL__entry__content.html#m0">started</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_entry_content started mismatch\n"</font>;
00661   localtestedbytes += <font class="keyword">sizeof</font>(started);
00662   <font class="keywordflow">if</font> (<a class="code" href="classDIL__entry__content.html#m1">required</a>!=cached-&gt;<a class="code" href="classDIL__entry__content.html#m1">required</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_entry_content required mismatch\n"</font>;
00663   localtestedbytes += <font class="keyword">sizeof</font>(required);
00664   <font class="keywordflow">if</font> (<a class="code" href="classDIL__entry__content.html#m2">completion</a>!=cached-&gt;<a class="code" href="classDIL__entry__content.html#m2">completion</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_entry_content completion mismatch\n"</font>;
00665   localtestedbytes += <font class="keyword">sizeof</font>(completion);
00666   <font class="keywordflow">if</font> (<a class="code" href="classDIL__entry__content.html#m3">valuation</a>!=cached-&gt;<a class="code" href="classDIL__entry__content.html#m3">valuation</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_entry_content valuation mismatch\n"</font>;
00667   localtestedbytes += <font class="keyword">sizeof</font>(valuation);
00668   <font class="keywordflow">if</font> (text) {
00669     <font class="keywordflow">if</font> (cached-&gt;<a class="code" href="classDIL__entry__content.html#m4">text</a>) {
00670       <font class="keywordflow">if</font> ((*text)!=(*(cached-&gt;<a class="code" href="classDIL__entry__content.html#m4">text</a>))) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_entry_content text mismatch\n"</font>;
00671       localtestedbytes += <a class="code" href="classDIL__entry__content.html#m4">text</a>-&gt;<a class="code" href="classString.html#a105">length</a>();
00672     } <font class="keywordflow">else</font> <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_entry_content original has text, but cached does not\n"</font>;
00673   } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cached-&gt;<a class="code" href="classDIL__entry__content.html#m4">text</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_entry_content cached has text, but original does not\n"</font>;
00674   localtestedbytes += <font class="keyword">sizeof</font>(text);
00675   testedbytes += localtestedbytes;
00676   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00677 }
00678 
<a name="l00679"></a><a class="code" href="classDIL__Topical__List.html#a0">00679</a> <a class="code" href="classDIL__Topical__List.html#a0">DIL_Topical_List::DIL_Topical_List</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a> &amp; e): entry(&amp;e), relevance(0.0) {}
00680 
<a name="l00681"></a><a class="code" href="classDIL__Topical__List.html#a1">00681</a> <a class="code" href="classDIL__Topical__List.html#a0">DIL_Topical_List::DIL_Topical_List</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a> &amp; e, <a class="code" href="classString.html">String</a> tfile, <a class="code" href="classString.html">String</a> ttitle, <font class="keywordtype">float</font> trelevance): entry(&amp;e), relevance(trelevance) {
00682         <a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m0">file</a> = tfile;
00683         <a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m1">title</a> = ttitle;
00684 }
00685 
<a name="l00686"></a><a class="code" href="classDIL__Topical__List.html#a3">00686</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__Topical__List.html#a3">DIL_Topical_List::Write_to_Binary_Cache</a>(ofstream &amp; cfl) {
00687   <font class="comment">// dil.file</font>
00688   <font class="keywordtype">int</font> dilfilelen = <a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m0">file</a>.<a class="code" href="classString.html#a105">length</a>();
00689   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;dilfilelen), <font class="keyword">sizeof</font>(dilfilelen));
00690   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) <a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m0">file</a>.<a class="code" href="classString.html#a104">chars</a>(), dilfilelen);
00691   <font class="comment">// dil.title</font>
00692   <font class="keywordtype">int</font> diltitlelen = <a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m1">title</a>.<a class="code" href="classString.html#a105">length</a>();
00693   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;diltitlelen), <font class="keyword">sizeof</font>(diltitlelen));
00694   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) <a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m1">title</a>.<a class="code" href="classString.html#a104">chars</a>(), diltitlelen);
00695   <font class="comment">// relevance</font>
00696   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__Topical__List.html#m1">relevance</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__Topical__List.html#m1">relevance</a>));
00697   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00698 }
00699 
<a name="l00700"></a><a class="code" href="classDIL__Topical__List.html#a4">00700</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__Topical__List.html#a4">DIL_Topical_List::Read_from_Binary_Cache</a>(ifstream &amp; cfl) {
00701   <font class="keyword">const</font> <font class="keywordtype">int</font> LLEN = 1024;
00702   <font class="keywordtype">char</font> lbuf[LLEN];
00703   <font class="comment">// dil.file</font>
00704   <font class="keywordtype">int</font> dilfilelen;
00705   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;dilfilelen), <font class="keyword">sizeof</font>(dilfilelen))).gcount()&lt;<font class="keyword">sizeof</font>(dilfilelen)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00706   <a class="code" href="utilities_8cc.html#a1">TEST_LBUF_BOUNDS</a>(dilfilelen,<font class="stringliteral">"DIL_Topical_List::Read_from_Binary_Cache()"</font>)
00707   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) lbuf, dilfilelen)).gcount()&lt;dilfilelen) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00708   lbuf[dilfilelen]=<font class="charliteral">'\0'</font>;
00709   <a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m0">file</a> = lbuf;
00710   <font class="comment">// dil.title</font>
00711   <font class="keywordtype">int</font> diltitlelen;
00712   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;diltitlelen), <font class="keyword">sizeof</font>(diltitlelen))).gcount()&lt;<font class="keyword">sizeof</font>(diltitlelen)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00713   <a class="code" href="utilities_8cc.html#a1">TEST_LBUF_BOUNDS</a>(diltitlelen,<font class="stringliteral">"DIL_Topical_List::Read_from_Binary_Cache()"</font>)
00714   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) lbuf, diltitlelen)).gcount()&lt;diltitlelen) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00715   lbuf[diltitlelen]=<font class="charliteral">'\0'</font>;
00716   <a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m1">title</a> = lbuf;
00717   <font class="comment">// relevance</font>
00718   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__Topical__List.html#m1">relevance</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__Topical__List.html#m1">relevance</a>))).gcount()&lt;<font class="keyword">sizeof</font>(relevance)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00719   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00720 }
00721 
<a name="l00722"></a><a class="code" href="classDIL__Topical__List.html#a5">00722</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__Topical__List.html#a5">DIL_Topical_List::Binary_Cache_Diagnostic</a>(<a class="code" href="classDIL__Topical__List.html">DIL_Topical_List</a> * cached, <font class="keywordtype">int</font> &amp; testedbytes) {
00723   <font class="comment">// test if the quick load cache process works reliably</font>
00724   <font class="comment">// this is the original Topical_List, cached is the one retrieved from the binary cache</font>
00725   <font class="comment">//   start of this object test</font>
00726   <font class="keywordtype">int</font> localtestedbytes = <font class="keyword">sizeof</font>(<a class="code" href="classPLLHandle.html">PLLHandle&lt;DIL_Topical_List&gt;</a>);
00727   <font class="keywordflow">if</font> ((*entry)!=(*(cached-&gt;<a class="code" href="classDIL__Topical__List.html#n0">entry</a>))) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_Topical_List entry mismatch\n"</font>; <font class="comment">// testing if DIL_ID==DIL_ID</font>
00728   localtestedbytes += <font class="keyword">sizeof</font>(entry);
00729   <font class="keywordflow">if</font> (<a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m0">file</a>!=cached-&gt;<a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m0">file</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_Topical_List dil.file mismatch\n"</font>;
00730   <font class="keywordflow">if</font> (<a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m1">title</a>!=cached-&gt;<a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m1">title</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_Topical_List dil.title mismatch\n"</font>;
00731   localtestedbytes += <font class="keyword">sizeof</font>(dil);
00732   <font class="keywordflow">if</font> (<a class="code" href="classDIL__Topical__List.html#m1">relevance</a>!=cached-&gt;<a class="code" href="classDIL__Topical__List.html#m1">relevance</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_Topical_List relevance mismatch\n"</font>;
00733   localtestedbytes += <font class="keyword">sizeof</font>(relevance);
00734   <font class="comment">//   end of this object test</font>
00735   <font class="keywordflow">if</font> (localtestedbytes!=<font class="keyword">sizeof</font>(DIL_Topical_List)) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** testedbytes!=sizeof(DIL_Topical_List)\n"</font>;
00736   testedbytes += localtestedbytes;
00737   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00738 }
00739 
00740 <font class="comment">// *** Beware, I changed the default target date value from 0 to unspecified here!</font>
<a name="l00741"></a><a class="code" href="classDIL__AL__List.html#a0">00741</a> <a class="code" href="classDIL__AL__List.html#a0">DIL_AL_List::DIL_AL_List</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a> &amp; e): entry(&amp;e), superior(NULL), relevance(<a class="code" href="dil2al_8hh.html#a23">DILSUPS_REL_UNSPECIFIED</a>),
00742         unbounded(<a class="code" href="dil2al_8hh.html#a24">DILSUPS_UNB_UNSPECIFIED</a>), bounded(<a class="code" href="dil2al_8hh.html#a25">DILSUPS_BND_UNSPECIFIED</a>), _targetdate(<a class="code" href="dil2al_8hh.html#a26">DILSUPS_TD_UNSPECIFIED</a>),
00743         _tdproperty(0), urgency(<a class="code" href="dil2al_8hh.html#a27">DILSUPS_URG_UNSPECIFIED</a>), priority(<a class="code" href="dil2al_8hh.html#a28">DILSUPS_PRI_UNSPECIFIED</a>) {}
00744 
<a name="l00745"></a><a class="code" href="classDIL__AL__List.html#a1">00745</a> <a class="code" href="classDIL__AL__List.html#a0">DIL_AL_List::DIL_AL_List</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a> &amp; e, <a class="code" href="classString.html">String</a> pfile, <a class="code" href="classString.html">String</a> ptitle, <font class="keywordtype">float</font> prelevance, <font class="keywordtype">float</font> punbounded, <font class="keywordtype">float</font> pbounded, time_t ptargetdate, <font class="keywordtype">int</font> ptdprop, <font class="keywordtype">float</font> purgency, <font class="keywordtype">float</font> ppriority):
00746                 entry(&amp;e), superior(NULL), relevance(prelevance), unbounded(punbounded), bounded(pbounded), _targetdate(ptargetdate), _tdproperty(ptdprop), urgency(purgency), priority(ppriority) {
00747         <a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m0">file</a> = pfile;
00748         <a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m1">title</a> = ptitle;
00749 }
00750 
<a name="l00751"></a><a class="code" href="classDIL__AL__List.html#a9">00751</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__AL__List.html#a9">DIL_AL_List::Write_to_Binary_Cache</a>(ofstream &amp; cfl) {
00752   <font class="comment">// _targetdate</font>
00753   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__AL__List.html#n2">_targetdate</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#n2">_targetdate</a>));
00754   <font class="comment">// _tdproperty</font>
00755   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__AL__List.html#n3">_tdproperty</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#n3">_tdproperty</a>));
00756   <font class="comment">// al.file</font>
00757   <font class="keywordtype">int</font> alfilelen = <a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m0">file</a>.<a class="code" href="classString.html#a105">length</a>();
00758   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;alfilelen), <font class="keyword">sizeof</font>(alfilelen));
00759   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) <a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m0">file</a>.<a class="code" href="classString.html#a104">chars</a>(), alfilelen);
00760   <font class="comment">// al.title</font>
00761   <font class="keywordtype">int</font> altitlelen = <a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m1">title</a>.<a class="code" href="classString.html#a105">length</a>();
00762   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;altitlelen), <font class="keyword">sizeof</font>(altitlelen));
00763   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) <a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m1">title</a>.<a class="code" href="classString.html#a104">chars</a>(), altitlelen);
00764   <font class="comment">// relevance</font>
00765   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__AL__List.html#m1">relevance</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#m1">relevance</a>));
00766   <font class="comment">// unbounded</font>
00767   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__AL__List.html#m2">unbounded</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#m2">unbounded</a>));
00768   <font class="comment">// bounded</font>
00769   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__AL__List.html#m3">bounded</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#m3">bounded</a>));
00770   <font class="comment">// urgency</font>
00771   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__AL__List.html#m4">urgency</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#m4">urgency</a>));
00772   <font class="comment">// priority</font>
00773   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__AL__List.html#m5">priority</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#m5">priority</a>));
00774   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00775 }
00776 
<a name="l00777"></a><a class="code" href="classDIL__AL__List.html#a10">00777</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__AL__List.html#a10">DIL_AL_List::Read_from_Binary_Cache</a>(ifstream &amp; cfl) {
00778   <font class="keyword">const</font> <font class="keywordtype">int</font> LLEN = 1024;
00779   <font class="keywordtype">char</font> lbuf[LLEN];
00780   <font class="comment">// _targetdate</font>
00781   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__AL__List.html#n2">_targetdate</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#n2">_targetdate</a>))).gcount()&lt;<font class="keyword">sizeof</font>(_targetdate)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00782   <font class="comment">// _tdproperty</font>
00783   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__AL__List.html#n3">_tdproperty</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#n3">_tdproperty</a>))).gcount()&lt;<font class="keyword">sizeof</font>(_tdproperty)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00784 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
00785 <font class="preprocessor"></font>  <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; _targetdate = "</font> &lt;&lt; <a class="code" href="classDIL__AL__List.html#n2">_targetdate</a> &lt;&lt; <font class="stringliteral">", _tdproperty = "</font> &lt;&lt; <a class="code" href="classDIL__AL__List.html#n3">_tdproperty</a> &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
00786 <font class="preprocessor">#endif</font>
00787 <font class="preprocessor"></font>  <font class="comment">// al.file</font>
00788   <font class="keywordtype">int</font> alfilelen;
00789   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;alfilelen), <font class="keyword">sizeof</font>(alfilelen))).gcount()&lt;<font class="keyword">sizeof</font>(alfilelen)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00790 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
00791 <font class="preprocessor"></font>  <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; alfilelen = "</font> &lt;&lt; alfilelen &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
00792 <font class="preprocessor">#endif</font>
00793 <font class="preprocessor"></font>  <a class="code" href="utilities_8cc.html#a1">TEST_LBUF_BOUNDS</a>(alfilelen,<font class="stringliteral">"DIL_AL_List::Read_from_Binary_Cache()"</font>)
00794   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) lbuf, alfilelen)).gcount()&lt;alfilelen) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00795   lbuf[alfilelen]=<font class="charliteral">'\0'</font>;
00796   <a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m0">file</a> = lbuf;
00797 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
00798 <font class="preprocessor"></font>  <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; al.file = "</font> &lt;&lt; <a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m0">file</a> &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
00799 <font class="preprocessor">#endif</font>
00800 <font class="preprocessor"></font>  <font class="comment">// al.title</font>
00801   <font class="keywordtype">int</font> altitlelen;
00802   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;altitlelen), <font class="keyword">sizeof</font>(altitlelen))).gcount()&lt;<font class="keyword">sizeof</font>(altitlelen)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00803   <a class="code" href="utilities_8cc.html#a1">TEST_LBUF_BOUNDS</a>(altitlelen,<font class="stringliteral">"DIL_AL_List::Read_from_Binary_Cache()"</font>)
00804   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) lbuf, altitlelen)).gcount()&lt;altitlelen) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00805   lbuf[altitlelen]=<font class="charliteral">'\0'</font>;
00806   <a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m1">title</a> = lbuf;
00807   <font class="comment">// relevance</font>
00808   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__AL__List.html#m1">relevance</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#m1">relevance</a>))).gcount()&lt;<font class="keyword">sizeof</font>(relevance)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00809   <font class="comment">// unbounded</font>
00810   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__AL__List.html#m2">unbounded</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#m2">unbounded</a>))).gcount()&lt;<font class="keyword">sizeof</font>(unbounded)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00811   <font class="comment">// bounded</font>
00812   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__AL__List.html#m3">bounded</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#m3">bounded</a>))).gcount()&lt;<font class="keyword">sizeof</font>(bounded)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00813   <font class="comment">// urgency</font>
00814   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__AL__List.html#m4">urgency</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#m4">urgency</a>))).gcount()&lt;<font class="keyword">sizeof</font>(urgency)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00815   <font class="comment">// priority</font>
00816   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__AL__List.html#m5">priority</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__AL__List.html#m5">priority</a>))).gcount()&lt;<font class="keyword">sizeof</font>(priority)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00817   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00818 }
00819 
<a name="l00820"></a><a class="code" href="classDIL__AL__List.html#a11">00820</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__AL__List.html#a11">DIL_AL_List::Binary_Cache_Diagnostic</a>(<a class="code" href="classDIL__AL__List.html">DIL_AL_List</a> * cached, <font class="keywordtype">int</font> &amp; testedbytes) {
00821   <font class="comment">// test if the quick load cache process works reliably</font>
00822   <font class="comment">// this is the original AL_List, cached is the one retrieved from the binary cache</font>
00823   <font class="comment">//   start of this object test</font>
00824   <font class="keywordtype">int</font> localtestedbytes = <font class="keyword">sizeof</font>(<a class="code" href="classPLLHandle.html">PLLHandle&lt;DIL_AL_List&gt;</a>) + <font class="keyword">sizeof</font>(superior);
00825   <font class="keywordflow">if</font> ((*entry)!=(*(cached-&gt;<a class="code" href="classDIL__AL__List.html#n0">entry</a>))) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_AL_List entry mismatch\n"</font>; <font class="comment">// testing if DIL_ID==DIL_ID</font>
00826   localtestedbytes += <font class="keyword">sizeof</font>(entry);
00827   <font class="keywordflow">if</font> (<a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m0">file</a>!=cached-&gt;<a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m0">file</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_AL_List al.file mismatch\n"</font>;
00828   <font class="keywordflow">if</font> (<a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m1">title</a>!=cached-&gt;<a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m1">title</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_AL_List al.title mismatch\n"</font>;
00829   localtestedbytes += <font class="keyword">sizeof</font>(al);
00830   <font class="keywordflow">if</font> (<a class="code" href="classDIL__AL__List.html#n2">_targetdate</a>!=cached-&gt;<a class="code" href="classDIL__AL__List.html#n2">_targetdate</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_AL_List targetdate mismatch\n"</font>;
00831   localtestedbytes += <font class="keyword">sizeof</font>(_targetdate);
00832   <font class="keywordflow">if</font> (<a class="code" href="classDIL__AL__List.html#n3">_tdproperty</a>!=cached-&gt;<a class="code" href="classDIL__AL__List.html#n3">_tdproperty</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_AL_List _tdproperty mismatch\n"</font>;
00833   localtestedbytes += <font class="keyword">sizeof</font>(_tdproperty);
00834   <font class="keywordflow">if</font> (<a class="code" href="classDIL__AL__List.html#m1">relevance</a>!=cached-&gt;<a class="code" href="classDIL__AL__List.html#m1">relevance</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_AL_List relevance mismatch\n"</font>;
00835   localtestedbytes += <font class="keyword">sizeof</font>(relevance);
00836   <font class="keywordflow">if</font> (<a class="code" href="classDIL__AL__List.html#m2">unbounded</a>!=cached-&gt;<a class="code" href="classDIL__AL__List.html#m2">unbounded</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_AL_List unbounded mismatch\n"</font>;
00837   localtestedbytes += <font class="keyword">sizeof</font>(unbounded);
00838   <font class="keywordflow">if</font> (<a class="code" href="classDIL__AL__List.html#m3">bounded</a>!=cached-&gt;<a class="code" href="classDIL__AL__List.html#m3">bounded</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_AL_List hounded mismatch\n"</font>;
00839   localtestedbytes += <font class="keyword">sizeof</font>(bounded);
00840   <font class="keywordflow">if</font> (<a class="code" href="classDIL__AL__List.html#m4">urgency</a>!=cached-&gt;<a class="code" href="classDIL__AL__List.html#m4">urgency</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_AL_List urgency mismatch\n"</font>;
00841   localtestedbytes += <font class="keyword">sizeof</font>(urgency);
00842   <font class="keywordflow">if</font> (<a class="code" href="classDIL__AL__List.html#m5">priority</a>!=cached-&gt;<a class="code" href="classDIL__AL__List.html#m5">priority</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_AL_List priority mismatch\n"</font>;
00843   localtestedbytes += <font class="keyword">sizeof</font>(priority);
00844   <font class="comment">//   end of this object test</font>
00845   <font class="keywordflow">if</font> (localtestedbytes!=<font class="keyword">sizeof</font>(DIL_AL_List)) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** testedbytes!=sizeof(DIL_AL_List)\n"</font>;
00846   testedbytes += localtestedbytes;
00847   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00848 }
00849 
<a name="l00850"></a><a class="code" href="classDIL__entry__parameters.html#a6">00850</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry__parameters.html#a6">DIL_entry_parameters::Write_to_Binary_Cache</a>(ofstream &amp; cfl) {
00851   <font class="comment">// origloc</font>
00852   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;<a class="code" href="classDIL__entry__parameters.html#n1">origloc</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__entry__parameters.html#n1">origloc</a>));
00853   <font class="comment">// topics</font>
00854   <font class="keywordtype">int</font> numtopics = <a class="code" href="classDIL__entry__parameters.html#m0">topics</a>.<a class="code" href="classPLLRoot.html#a6">length</a>();
00855   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;numtopics), <font class="keyword">sizeof</font>(numtopics));
00856   <font class="keywordflow">if</font> (numtopics&gt;0) <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__Topical__List.html">DIL_Topical_List</a>,<a class="code" href="classDIL__entry__parameters.html#m0">topics</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(),1) <font class="keywordflow">if</font> (!e-&gt;Write_to_Binary_Cache(cfl)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00857   <font class="comment">// projects</font>
00858   <font class="keywordtype">int</font> numprojects = <a class="code" href="classDIL__entry__parameters.html#m1">projects</a>.<a class="code" href="classPLLRoot.html#a6">length</a>();
00859   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;numprojects), <font class="keyword">sizeof</font>(numprojects));
00860   <font class="keywordflow">if</font> (numprojects&gt;0) <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__AL__List.html">DIL_AL_List</a>,<a class="code" href="classDIL__entry__parameters.html#m1">projects</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(),1) <font class="keywordflow">if</font> (!e-&gt;Write_to_Binary_Cache(cfl)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00861   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00862 }
00863 
<a name="l00864"></a><a class="code" href="classDIL__entry__parameters.html#a7">00864</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry__parameters.html#a7">DIL_entry_parameters::Read_from_Binary_Cache</a>(ifstream &amp; cfl) {
00865   <font class="comment">// origloc</font>
00866   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;<a class="code" href="classDIL__entry__parameters.html#n1">origloc</a>), <font class="keyword">sizeof</font>(<a class="code" href="classDIL__entry__parameters.html#n1">origloc</a>))).gcount()&lt;<font class="keyword">sizeof</font>(origloc)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00867   <font class="comment">// topics</font>
00868   <font class="keywordtype">int</font> numtopics;
00869   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;numtopics), <font class="keyword">sizeof</font>(numtopics))).gcount()&lt;<font class="keyword">sizeof</font>(numtopics)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00870 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
00871 <font class="preprocessor"></font>  <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; numtopics = "</font> &lt;&lt; numtopics &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
00872 <font class="preprocessor">#endif</font>
00873 <font class="preprocessor"></font>  <font class="keywordflow">if</font> (numtopics&gt;0) <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i&lt;numtopics; i++) {
00874     <a class="code" href="classDIL__Topical__List.html">DIL_Topical_List</a> * dtl = <font class="keyword">new</font> <a class="code" href="classDIL__Topical__List.html">DIL_Topical_List</a>(*<a class="code" href="classDIL__entry__parameters.html#n0">entry</a>);
00875     <font class="keywordflow">if</font> (!dtl-&gt;<a class="code" href="classDIL__Topical__List.html#a4">Read_from_Binary_Cache</a>(cfl)) { <font class="keyword">delete</font> dtl; <font class="keywordflow">return</font> <font class="keyword">false</font>; }
00876     <a class="code" href="classDIL__entry__parameters.html#m0">topics</a>.<a class="code" href="classPLLRoot.html#a8">link_before</a>(dtl);
00877   }
00878   <font class="comment">// projects</font>
00879   <font class="keywordtype">int</font> numprojects;
00880   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;numprojects), <font class="keyword">sizeof</font>(numprojects))).gcount()&lt;<font class="keyword">sizeof</font>(numprojects)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00881 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
00882 <font class="preprocessor"></font>  <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; numprojects = "</font> &lt;&lt; numtopics &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
00883 <font class="preprocessor">#endif</font>
00884 <font class="preprocessor"></font>  <font class="keywordflow">if</font> (numprojects&gt;0) <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i&lt;numprojects; i++) {
00885     <a class="code" href="classDIL__AL__List.html">DIL_AL_List</a> * dal = <font class="keyword">new</font> <a class="code" href="classDIL__AL__List.html">DIL_AL_List</a>(*<a class="code" href="classDIL__entry__parameters.html#n0">entry</a>);
00886     <font class="keywordflow">if</font> (!dal-&gt;<a class="code" href="classDIL__AL__List.html#a10">Read_from_Binary_Cache</a>(cfl)) { <font class="keyword">delete</font> dal; <font class="keywordflow">return</font> <font class="keyword">false</font>; }
00887     <a class="code" href="classDIL__entry__parameters.html#m1">projects</a>.<a class="code" href="classPLLRoot.html#a8">link_before</a>(dal);
00888   }
00889   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00890 }
00891 
<a name="l00892"></a><a class="code" href="classDIL__entry__parameters.html#a8">00892</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry__parameters.html#a8">DIL_entry_parameters::Binary_Cache_Diagnostic</a>(<a class="code" href="classDIL__entry__parameters.html">DIL_entry_parameters</a> * cached, <font class="keywordtype">int</font> &amp; testedbytes) {
00893   <font class="comment">// test if the quick load cache process works reliably</font>
00894   <font class="comment">// this is the original entry_parameters, cached is the one retrieved from the binary cache</font>
00895   <font class="comment">//   start of this object test</font>
00896   <font class="keywordtype">int</font> localtestedbytes = 0;
00897   <font class="keywordflow">if</font> ((*entry)!=(*(cached-&gt;<a class="code" href="classDIL__entry__parameters.html#n0">entry</a>))) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_entry_parameters entry mismatch\n"</font>; <font class="comment">// testing if DIL_ID==DIL_ID</font>
00898   localtestedbytes += <font class="keyword">sizeof</font>(entry);
00899   <font class="keywordflow">if</font> (<a class="code" href="classDIL__entry__parameters.html#n1">origloc</a>!=cached-&gt;<a class="code" href="classDIL__entry__parameters.html#n1">origloc</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_entry_parameters origloc mismatch\n"</font>;
00900   localtestedbytes += <font class="keyword">sizeof</font>(origloc);
00901   <font class="keywordflow">if</font> (<a class="code" href="classDIL__entry__parameters.html#m0">topics</a>.<a class="code" href="classPLLRoot.html#a6">length</a>()!=cached-&gt;<a class="code" href="classDIL__entry__parameters.html#m0">topics</a>.<a class="code" href="classPLLRoot.html#a6">length</a>()) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_entry_parameters topics length mismatch, "</font> &lt;&lt; <a class="code" href="classDIL__entry__parameters.html#m0">topics</a>.<a class="code" href="classPLLRoot.html#a6">length</a>() &lt;&lt; <font class="stringliteral">" vs. "</font> &lt;&lt; cached-&gt;<a class="code" href="classDIL__entry__parameters.html#m0">topics</a>.<a class="code" href="classPLLRoot.html#a6">length</a>() &lt;&lt; <font class="charliteral">'\n'</font>;;
00902   localtestedbytes += <font class="keyword">sizeof</font>(topics);
00903   <font class="keywordflow">if</font> (<a class="code" href="classDIL__entry__parameters.html#m1">projects</a>.<a class="code" href="classPLLRoot.html#a6">length</a>()!=cached-&gt;<a class="code" href="classDIL__entry__parameters.html#m1">projects</a>.<a class="code" href="classPLLRoot.html#a6">length</a>()) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_entry_parameters projects length mismatch, "</font> &lt;&lt; <a class="code" href="classDIL__entry__parameters.html#m1">projects</a>.<a class="code" href="classPLLRoot.html#a6">length</a>() &lt;&lt; <font class="stringliteral">" vs. "</font> &lt;&lt; cached-&gt;<a class="code" href="classDIL__entry__parameters.html#m1">projects</a>.<a class="code" href="classPLLRoot.html#a6">length</a>() &lt;&lt; <font class="charliteral">'\n'</font>;;
00904   localtestedbytes += <font class="keyword">sizeof</font>(projects);
00905   <font class="comment">//   end of this object test</font>
00906   <font class="keywordflow">if</font> (localtestedbytes!=<font class="keyword">sizeof</font>(DIL_entry_parameters)) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** testedbytes!=sizeof(DIL_entry_parameters)\n"</font>;
00907   <font class="keywordflow">for</font> (<a class="code" href="classDIL__Topical__List.html">DIL_Topical_List</a> * e = <a class="code" href="classDIL__entry__parameters.html#m0">topics</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(), * c = cached-&gt;<a class="code" href="classDIL__entry__parameters.html#m0">topics</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(); ((e) &amp;&amp; (c)); e=e-&gt;<a class="code" href="classPLLHandle.html#a1">Next</a>(), c=c-&gt;<a class="code" href="classPLLHandle.html#a1">Next</a>()) <font class="keywordflow">if</font> (!e-&gt;<a class="code" href="classDIL__Topical__List.html#a5">Binary_Cache_Diagnostic</a>(c,testedbytes)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00908   <font class="keywordflow">for</font> (<a class="code" href="classDIL__AL__List.html">DIL_AL_List</a> * e = <a class="code" href="classDIL__entry__parameters.html#m1">projects</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(), * c = cached-&gt;<a class="code" href="classDIL__entry__parameters.html#m1">projects</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(); ((e) &amp;&amp; (c)); e=e-&gt;<a class="code" href="classPLLHandle.html#a1">Next</a>(), c=c-&gt;<a class="code" href="classPLLHandle.html#a1">Next</a>()) <font class="keywordflow">if</font> (!e-&gt;<a class="code" href="classDIL__AL__List.html#a11">Binary_Cache_Diagnostic</a>(c,testedbytes)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00909   testedbytes += localtestedbytes;
00910   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00911 }
00912 
<a name="l00913"></a><a class="code" href="classDIL__entry.html#a0">00913</a> <a class="code" href="classDIL__entry.html#a0">DIL_entry::DIL_entry</a>(<a class="code" href="classText__File__Buffers.html">Text_File_Buffers</a> &amp; t): tfb(&amp;t), <a class="code" href="classDIL__ID.html">DIL_ID</a>(), content(NULL), parameters(NULL) {}
00914 
<a name="l00915"></a><a class="code" href="classDIL__entry.html#a1">00915</a> <a class="code" href="classDIL__entry.html#a0">DIL_entry::DIL_entry</a>(<a class="code" href="classText__File__Buffers.html">Text_File_Buffers</a> &amp; t, <a class="code" href="classString.html">String</a> &amp; idstr): tfb(&amp;t), <a class="code" href="classDIL__ID.html">DIL_ID</a>(idstr), content(NULL), parameters(NULL) {}
00916 
<a name="l00917"></a><a class="code" href="classDIL__entry.html#a2">00917</a> <a class="code" href="classDIL__entry.html#a0">DIL_entry::DIL_entry</a>(<a class="code" href="classText__File__Buffers.html">Text_File_Buffers</a> &amp; t, <font class="keyword">const</font> <a class="code" href="classSubString.html">SubString</a> &amp; idstr): tfb(&amp;t), <a class="code" href="classDIL__ID.html">DIL_ID</a>(idstr), content(NULL), parameters(NULL) {}
00918 
<a name="l00919"></a><a class="code" href="classDIL__entry.html#a4">00919</a> <a class="code" href="classDIL__entry.html">DIL_entry</a> * <a class="code" href="classDIL__entry.html#a4">DIL_entry::elbyid</a>(<font class="keyword">const</font> <a class="code" href="classDIL__ID.html">DIL_ID</a> &amp; id)<font class="keyword"> const </font>{
00920 <font class="comment">// return pointer to list element with DIL ID id</font>
00921 <font class="comment">//      if ((*const_cast&lt;DIL_entry *&gt;(this))==id) return const_cast&lt;DIL_entry *&gt;(this);</font>
00922         <font class="keywordflow">if</font> ((*this)==id) <font class="keywordflow">return</font> const_cast&lt;DIL_entry *&gt;(this);
00923         <font class="keywordflow">for</font> (<a class="code" href="classDIL__entry.html">DIL_entry</a> * de=<a class="code" href="classPLLHandle.html#a1">Next</a>(); de; de=de-&gt;<a class="code" href="classPLLHandle.html#a1">Next</a>()) <font class="keywordflow">if</font> (*de==id) <font class="keywordflow">return</font> de;
00924         <font class="keywordflow">for</font> (<a class="code" href="classDIL__entry.html">DIL_entry</a> * de=<a class="code" href="classPLLHandle.html#a2">Prev</a>(); de; de=de-&gt;<a class="code" href="classPLLHandle.html#a2">Prev</a>()) <font class="keywordflow">if</font> (*de==id) <font class="keywordflow">return</font> de;
00925         <font class="keywordflow">return</font> NULL;
00926 }
00927 
00928 <font class="preprocessor">#ifdef LOOP_PROTECT</font>
<a name="l00929"></a><a class="code" href="classDIL__entry.html#a11">00929</a> <font class="preprocessor"></font>time_t <a class="code" href="classDIL__entry.html#a11">DIL_entry::Propagated_Target_Date</a>(<font class="keywordtype">bool</font> warn, <font class="keywordtype">bool</font> top = <font class="keyword">true</font>)<font class="keyword"> const </font>{
00930 <font class="preprocessor">#else</font>
00931 <font class="preprocessor"></font>time_t <a class="code" href="classDIL__entry.html#a11">DIL_entry::Propagated_Target_Date</a>(<font class="keywordtype">bool</font> warn)<font class="keyword"> const </font>{
00932 <font class="preprocessor">#endif</font>
00933 <font class="preprocessor"></font><font class="comment">// return nearest target date, as given for this DIL entry in</font>
00934 <font class="comment">// relation to one of its project superiors, or as given for its</font>
00935 <font class="comment">// project superiors, or MAXTIME_T</font>
00936 <font class="comment">// *** could implement a local buffer for superior target date</font>
00937 <font class="comment">//     look-ups, but such a buffer must be refreshed if local</font>
00938 <font class="comment">//     or relevant superior target dates are changed</font>
00939 <font class="preprocessor">#ifdef LOOP_PROTECT</font>
00940 <font class="preprocessor"></font>        <font class="keywordflow">if</font> ((!top) &amp;&amp; (!<a class="code" href="classDIL__entry.html#n0">semaphore</a>)) {
00941                 <font class="keywordflow">if</font> (warn) {
00942                         <font class="keywordflow">if</font> (!looplist) looplist = <font class="keyword">new</font> <a class="code" href="classDetailed__Items__List.html">Detailed_Items_List</a>();
00943                         <a class="code" href="classDIL__entry.html">DIL_entry</a> * lhde = looplist-&gt;list.head();
00944                         <font class="keywordflow">if</font> ((!lhde) || (!lhde-&gt;<a class="code" href="classDIL__entry.html#a4">elbyid</a>(*<font class="keyword">this</font>))) { <font class="comment">// add to looplist</font>
00945 <font class="comment">//                      if ((!lhde) || (!lhde-&gt;elbyid(*(static_cast&lt;DIL_ID *&gt;(this))))) { // add to looplist</font>
00946                                 <a class="code" href="classString.html">String</a> ldeid(<a class="code" href="classDIL__ID.html#a15">chars</a>());
00947                                 <a class="code" href="classDIL__entry.html">DIL_entry</a> * lde = <font class="keyword">new</font> <a class="code" href="classDIL__entry.html#a0">DIL_entry</a>(*looplist,ldeid);
00948                                 looplist-&gt;list.link_before(lde);
00949                         }
00950                 }
00951                 <font class="keywordflow">return</font> <a class="code" href="dil2al_8hh.html#a3">MAXTIME_T</a>;
00952         }
00953 <font class="preprocessor">#endif</font>
00954 <font class="preprocessor"></font>        <a class="code" href="classDIL__entry.html">DIL_entry</a> * sup;
00955         time_t t = <a class="code" href="dil2al_8hh.html#a3">MAXTIME_T</a>; <font class="comment">// default where no target date is known</font>
00956         <font class="comment">// priority target dates are target dates specific to this DIL entry</font>
00957         <font class="keywordflow">if</font> (parameters) <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__AL__List.html">DIL_AL_List</a>,<a class="code" href="classDIL__entry.html#m1">parameters</a>-&gt;<a class="code" href="classDIL__entry__parameters.html#m1">projects</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(),1) {
00958                 time_t tdate = e-&gt;targetdate();
00959                 <font class="keywordflow">if</font> (tdate&lt;0) { <font class="comment">// missing target dates are obtained from the corresponding project superior</font>
00960                         <font class="comment">// *** this can be made more efficient once the pointers to</font>
00961                         <font class="comment">//     superiors are implemented</font>
00962                         <font class="keywordflow">if</font> (<a class="code" href="classDIL__ID.html#a14">str</a>()!=e-&gt;al.title) { <font class="comment">// not self-referential</font>
00963                                 <a class="code" href="classDIL__ID.html">DIL_ID</a> did(e-&gt;al.title);
00964                                 <font class="keywordflow">if</font> (did.<a class="code" href="classDIL__ID.html#a17">valid</a>()) {
00965                                         sup = <a class="code" href="classDIL__entry.html#a4">elbyid</a>(did);
00966                                         <font class="keywordflow">if</font> (sup) {
00967 <font class="preprocessor">#ifdef LOOP_PROTECT</font>
00968 <font class="preprocessor"></font>                                                <font class="keywordflow">if</font> (top) <a class="code" href="classPLLHandle.html#a3">head</a>()-&gt;<a class="code" href="classDIL__entry.html#a10">Set_Semaphores</a>(<a class="code" href="dil2al_8hh.html#a31">TD_PROTECT</a>);
00969                                                 <a class="code" href="classDIL__entry.html#n0">semaphore</a> = 0; <font class="comment">// set this one parsed</font>
00970                                                 tdate = sup-&gt;<a class="code" href="classDIL__entry.html#a12">Target_Date</a>(<font class="keyword">false</font>);
00971 <font class="preprocessor">#else</font>
00972 <font class="preprocessor"></font>                                                tdate = sup-&gt;<a class="code" href="classDIL__entry.html#a12">Target_Date</a>();
00973 <font class="preprocessor">#endif</font>
00974 <font class="preprocessor"></font>                                        } <font class="keywordflow">else</font> {
00975                                                 <font class="keywordflow">if</font> (warn) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Warning - Superior DIL#"</font> &lt;&lt; did.<a class="code" href="classDIL__ID.html#a15">chars</a>() &lt;&lt; <font class="stringliteral">" not found in Target_Date() at DIL#"</font> &lt;&lt; <a class="code" href="classDIL__ID.html#a15">chars</a>() &lt;&lt; <font class="charliteral">'\n'</font>;
00976                                                 tdate = <a class="code" href="dil2al_8hh.html#a3">MAXTIME_T</a>;
00977                                         }
00978                                 } <font class="keywordflow">else</font> {
00979                                         <font class="keywordflow">if</font> (warn) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Warning - Invalid superior reference detected in Target_Date() at DIL#"</font> &lt;&lt; <a class="code" href="classDIL__ID.html#a15">chars</a>() &lt;&lt; <font class="charliteral">'\n'</font>;
00980                                         tdate = <a class="code" href="dil2al_8hh.html#a3">MAXTIME_T</a>;
00981                                 }
00982                         } <font class="keywordflow">else</font> {
00983                                 <font class="keywordflow">if</font> (warn) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Warning - Self-reference without specific target date detected in Target_Date() at DIL#"</font> &lt;&lt; <a class="code" href="classDIL__ID.html#a15">chars</a>() &lt;&lt; <font class="charliteral">'\n'</font>;
00984                                 tdate = <a class="code" href="dil2al_8hh.html#a3">MAXTIME_T</a>;
00985                         }
00986                 }
00987                 <font class="keywordflow">if</font> (tdate&lt;t) t = tdate;
00988         }
00989         <font class="keywordflow">return</font> t;
00990 }
00991 
<a name="l00992"></a><a class="code" href="classDIL__entry.html#a17">00992</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry.html#a17">DIL_entry::Get_Entry_Parameters</a>(<a class="code" href="classString.html">String</a> &amp; parstr) {
00993 <font class="comment">// parstr contains entry parameters to be parsed and stored</font>
00994         <font class="keywordtype">int</font> parstart = -1; <font class="keywordtype">double</font> pars[4];
00995         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> parnum = 0; parnum&lt;4; parnum++) {
00996                 <font class="keywordflow">if</font> ((parstart=parstr.<a class="code" href="classString.html#a26">index</a>(<font class="charliteral">':'</font>,parstart+1))&lt;0) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00997                 pars[parnum] = atof(<a class="code" href="classString.html">String</a>(parstr.<a class="code" href="classString.html#a76">after</a>(parstart)));
00998         }
00999         <font class="keywordflow">if</font> (!<a class="code" href="classDIL__entry.html#m0">content</a>) <a class="code" href="classDIL__entry.html#m0">content</a> = <font class="keyword">new</font> <a class="code" href="classDIL__entry__content.html">DIL_entry_content</a>(*<font class="keyword">this</font>);
01000         <a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#m0">started</a>  = <a class="code" href="utilities_8cc.html#a27">double2time</a>(pars[0]); <font class="comment">// *** can remove this (see dil2al.hh)</font>
01001         <a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#m1">required</a> = (time_t) (ceil(pars[1]*60.0)*60.0); <font class="comment">// convert hours to seconds</font>
01002         <a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#m2">completion</a> = pars[2];
01003         <a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#m3">valuation</a> = pars[3];
01004         <font class="keywordflow">return</font> <font class="keyword">true</font>;
01005 }
01006 
<a name="l01007"></a><a class="code" href="classDIL__entry.html#a18">01007</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry.html#a18">DIL_entry::Is_Direct_Dependency_Of</a>(<font class="keyword">const</font> <a class="code" href="classDIL__entry.html">DIL_entry</a> * superior) {
01008 <font class="comment">// checks if this DIL entry points to superior through one of its</font>
01009 <font class="comment">// DIL_AL_List references</font>
01010 <font class="comment">// A self-reference is not reported as a direct dependency.</font>
01011         <font class="keywordflow">if</font> (superior==<font class="keyword">this</font>) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01012         <font class="keywordflow">if</font> (<a class="code" href="classDIL__entry.html#a7">Projects</a>(0)) <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__AL__List.html">DIL_AL_List</a>,<a class="code" href="classDIL__entry.html#a7">Projects</a>(0),1) <font class="keywordflow">if</font> (e-&gt;Superiorbyid()==superior) <font class="keywordflow">return</font> <font class="keyword">true</font>;
01013         <font class="keywordflow">return</font> <font class="keyword">false</font>;
01014 }
01015 
<a name="l01016"></a><a class="code" href="classDIL__entry.html#a19">01016</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry.html#a19">DIL_entry::Is_Dependency_Of</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a> * superior) {
01017 <font class="comment">// checks if this DIL entry is a dependency of superior</font>
01018 <font class="comment">// superior==NULL is interpreted as "all"</font>
01019 <font class="comment">// dependencies do not need to be direct</font>
01020         <font class="keywordflow">if</font> (!superior) <font class="keywordflow">return</font> <font class="keyword">true</font>;
01021 <font class="comment">// *** Implement DIL hierarchy, use the Set_Semaphores</font>
01022 <font class="comment">//     recursive approach as in Target_Date()</font>
01023         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"WARNING: DIL_entry::Is_Dependency_Of() is not yet implemented!\n"</font>;
01024         <font class="keywordflow">return</font> <font class="keyword">true</font>;
01025 }
01026 
<a name="l01027"></a><a class="code" href="classDIL__entry.html#a20">01027</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry.html#a20">DIL_entry::Has_Superiors</a>(<font class="keywordtype">bool</font> taggedonly = <font class="keyword">false</font>) {
01028   <font class="comment">// superior references to the DIL entry itself do not count</font>
01029   <font class="comment">// if taggedonly==true then only superiors with a set semaphore count</font>
01030   <font class="keywordflow">if</font> (taggedonly) {
01031     <font class="keywordflow">if</font> (<a class="code" href="classDIL__entry.html#a7">Projects</a>(0)) <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__AL__List.html">DIL_AL_List</a>,<a class="code" href="classDIL__entry.html#a7">Projects</a>(0),1) {
01032       <a class="code" href="classDIL__entry.html">DIL_entry</a> * dilsup = e-&gt;Superiorbyid();
01033       <font class="keywordflow">if</font> ((!(dilsup==<font class="keyword">this</font>)) &amp;&amp; (dilsup-&gt;<a class="code" href="classDIL__entry.html#a9">Get_Semaphore</a>()&gt;0)) <font class="keywordflow">return</font> <font class="keyword">true</font>;
01034     }
01035   } <font class="keywordflow">else</font> {
01036     <font class="keywordflow">if</font> (<a class="code" href="classDIL__entry.html#a7">Projects</a>(0)) <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__AL__List.html">DIL_AL_List</a>,<a class="code" href="classDIL__entry.html#a7">Projects</a>(0),1) <font class="keywordflow">if</font> (!(e-&gt;Superiorbyid()==<font class="keyword">this</font>)) <font class="keywordflow">return</font> <font class="keyword">true</font>;
01037   }
01038   <font class="keywordflow">return</font> <font class="keyword">false</font>;
01039 }
01040 
<a name="l01041"></a><a class="code" href="classDIL__entry.html#a21">01041</a> <font class="keywordtype">int</font> <a class="code" href="classDIL__entry.html#a21">DIL_entry::Is_Plan_Entry</a>() {
01042   <font class="comment">// attempts to determine if the DIL entry content contains PLAN entry data</font>
01043   <font class="keywordflow">if</font> (!<a class="code" href="classDIL__entry.html#m0">content</a>) {
01044     <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Warning - no content available for DIL_entry::Is_Plan_Entry() --- obtaining content automatically is not yet implemented, continuing as is\n"</font>;
01045     <font class="keywordflow">return</font> <a class="code" href="dil2al_8hh.html#a9">PLAN_ENTRY_TYPE_UNASSIGNED</a>;
01046   }
01047   <font class="keywordflow">return</font> <a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#a2">Is_Plan_Entry</a>();
01048 }
01049 
<a name="l01050"></a><a class="code" href="classDIL__entry.html#a22">01050</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry.html#a22">DIL_entry::Write_to_Binary_Cache</a>(ofstream &amp; cfl) {
01051   <font class="comment">// DIL_ID</font>
01052   <font class="keywordflow">if</font> (!<a class="code" href="classDIL__ID.html#a18">Write_DIL_ID_to_Binary_Cache</a>(cfl)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01053   <font class="keywordtype">bool</font> hasparameters = (<a class="code" href="classDIL__entry.html#m1">parameters</a>!=NULL);
01054   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;hasparameters), <font class="keyword">sizeof</font>(hasparameters));
01055   <font class="keywordflow">if</font> (!hasparameters) <font class="keywordflow">return</font> <font class="keyword">true</font>;
01056   <font class="comment">// parameters</font>
01057   <font class="keywordflow">return</font> <a class="code" href="classDIL__entry.html#m1">parameters</a>-&gt;<a class="code" href="classDIL__entry__parameters.html#a6">Write_to_Binary_Cache</a>(cfl);
01058 }
01059 
<a name="l01060"></a><a class="code" href="classDIL__entry.html#a23">01060</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry.html#a23">DIL_entry::Write_Topical_to_Binary_Cache</a>(ofstream &amp; cfl, <font class="keywordtype">bool</font> gottext) {
01061   <font class="comment">// DIL_ID</font>
01062   <font class="keywordflow">if</font> (!<a class="code" href="classDIL__ID.html#a18">Write_DIL_ID_to_Binary_Cache</a>(cfl)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01063   <font class="keywordtype">bool</font> hascontent = (<a class="code" href="classDIL__entry.html#m0">content</a>!=NULL);
01064   cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;hascontent), <font class="keyword">sizeof</font>(hascontent));
01065   <font class="keywordflow">if</font> (!hascontent) <font class="keywordflow">return</font> <font class="keyword">true</font>;
01066   <font class="comment">// content</font>
01067   <font class="keywordflow">return</font> <a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#a4">Write_Topical_to_Binary_Cache</a>(cfl,gottext);
01068 }
01069 
<a name="l01070"></a><a class="code" href="classDIL__entry.html#a24">01070</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry.html#a24">DIL_entry::Read_from_Binary_Cache</a>(ifstream &amp; cfl) {
01071   <font class="comment">// Reads a DIL entry from a binary cache file and sets the DIL ID</font>
01072   <font class="comment">// DIL_ID</font>
01073   <font class="keywordflow">if</font> (!<a class="code" href="classDIL__ID.html#a19">Read_DIL_ID_from_Binary_Cache</a>(cfl)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01074   <font class="keywordtype">bool</font> hasparameters;
01075   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;hasparameters), <font class="keyword">sizeof</font>(hasparameters))).gcount()&lt;<font class="keyword">sizeof</font>(hasparameters)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01076   <font class="keywordflow">if</font> (!hasparameters) <font class="keywordflow">return</font> <font class="keyword">true</font>;
01077   <font class="comment">// parameters</font>
01078   <font class="keyword">delete</font> <a class="code" href="classDIL__entry.html#m1">parameters</a>; <font class="comment">// clear any previous allocation and parameter values</font>
01079   <a class="code" href="classDIL__entry.html#m1">parameters</a> = <font class="keyword">new</font> <a class="code" href="classDIL__entry__parameters.html">DIL_entry_parameters</a>(*<font class="keyword">this</font>);
01080 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
01081 <font class="preprocessor"></font>  <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; parameters = "</font> &lt;&lt; (long) <a class="code" href="classDIL__entry.html#m1">parameters</a> &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
01082 <font class="preprocessor">#endif</font>
01083 <font class="preprocessor"></font>  <font class="keywordflow">return</font> <a class="code" href="classDIL__entry.html#m1">parameters</a>-&gt;<a class="code" href="classDIL__entry__parameters.html#a7">Read_from_Binary_Cache</a>(cfl);
01084 }
01085 
<a name="l01086"></a><a class="code" href="classDIL__entry.html#a25">01086</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry.html#a25">DIL_entry::Read_Topical_from_Binary_Cache</a>(ifstream &amp; cfl, <font class="keywordtype">bool</font> gottext) {
01087   <font class="comment">// Reads a DIL entry from a binary cache file and sets the DIL ID</font>
01088   <font class="comment">// DIL_ID</font>
01089   <font class="comment">// done in outer loop: if (!Read_DIL_ID_from_Binary_Cache(cfl)) return false;</font>
01090   <font class="keywordtype">bool</font> hascontent;
01091   <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;hascontent), <font class="keyword">sizeof</font>(hascontent))).gcount()&lt;<font class="keyword">sizeof</font>(hascontent)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01092 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
01093 <font class="preprocessor"></font>  <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; hascontent = "</font> &lt;&lt; hascontent &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
01094 <font class="preprocessor">#endif</font>
01095 <font class="preprocessor"></font>  <font class="keywordflow">if</font> (!hascontent) <font class="keywordflow">return</font> <font class="keyword">true</font>;
01096   <font class="comment">// content</font>
01097 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
01098 <font class="preprocessor"></font>  <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; content (before clearing) = "</font> &lt;&lt; (long) <a class="code" href="classDIL__entry.html#m0">content</a> &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
01099 <font class="preprocessor">#endif</font>
01100 <font class="preprocessor"></font>  <font class="keyword">delete</font> <a class="code" href="classDIL__entry.html#m0">content</a>; <font class="comment">// clear any previous allocation and content</font>
01101   <a class="code" href="classDIL__entry.html#m0">content</a> = <font class="keyword">new</font> <a class="code" href="classDIL__entry__content.html">DIL_entry_content</a>(*<font class="keyword">this</font>);
01102 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
01103 <font class="preprocessor"></font>  <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; content (after clearing) = "</font> &lt;&lt; (long) <a class="code" href="classDIL__entry.html#m0">content</a> &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
01104 <font class="preprocessor">#endif</font>
01105 <font class="preprocessor"></font>  <font class="keywordflow">return</font> <a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#a5">Read_Topical_from_Binary_Cache</a>(cfl,gottext);
01106 }
01107 
<a name="l01108"></a><a class="code" href="classDIL__entry.html#a26">01108</a> <font class="keywordtype">bool</font> <a class="code" href="classDIL__entry.html#a26">DIL_entry::Binary_Cache_Diagnostic</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a> * cached, <font class="keywordtype">int</font> &amp; testedbytes) {
01109   <font class="comment">// test if the quick load cache process works reliably</font>
01110   <font class="comment">// this is the original entry, cached is the one retrieved from the binary cache</font>
01111   <font class="comment">//   start of this object test</font>
01112   <font class="keywordtype">int</font> localtestedbytes = 0;
01113   <font class="keywordflow">if</font> ((*this)!=(*cached)) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** DIL_ID mismatch\n"</font>; <font class="comment">// testing if DIL_ID==DIL_ID</font>
01114   localtestedbytes += <font class="keyword">sizeof</font>(DIL_ID) + <font class="keyword">sizeof</font>(<a class="code" href="classPLLHandle.html">PLLHandle&lt;DIL_entry&gt;</a>) + <font class="keyword">sizeof</font>(semaphore) + <font class="keyword">sizeof</font>(tfb) + <font class="keyword">sizeof</font>(content) + <font class="keyword">sizeof</font>(parameters);
01115   <font class="comment">//   end of this object test</font>
01116   <font class="keywordflow">if</font> (localtestedbytes!=<font class="keyword">sizeof</font>(DIL_entry)) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** testedbytes!=sizeof(DIL_entry)\n"</font>;
01117   <font class="keywordflow">if</font> (content) {
01118     <font class="keywordflow">if</font> (cached-&gt;<a class="code" href="classDIL__entry.html#m0">content</a>) {
01119       <font class="keywordflow">if</font> (!<a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#a6">Binary_Cache_Diagnostic</a>(cached-&gt;<a class="code" href="classDIL__entry.html#m0">content</a>,testedbytes)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01120     } <font class="keywordflow">else</font> <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** entry has content, cached does not\n"</font>;
01121   } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cached-&gt;<a class="code" href="classDIL__entry.html#m0">content</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** entry has no content, cached does\n"</font>;
01122   <font class="keywordflow">if</font> (parameters) {
01123     <font class="keywordflow">if</font> (cached-&gt;<a class="code" href="classDIL__entry.html#m1">parameters</a>) {
01124       <font class="keywordflow">if</font> (!<a class="code" href="classDIL__entry.html#m1">parameters</a>-&gt;<a class="code" href="classDIL__entry__parameters.html#a8">Binary_Cache_Diagnostic</a>(cached-&gt;<a class="code" href="classDIL__entry.html#m1">parameters</a>,testedbytes)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01125     } <font class="keywordflow">else</font> <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** entry has parameters, cached does not\n"</font>;
01126   } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cached-&gt;<a class="code" href="classDIL__entry.html#m1">parameters</a>) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** entry has no parameters, cached does\n"</font>;
01127   testedbytes += localtestedbytes;
01128   <font class="keywordflow">return</font> <font class="keyword">true</font>;
01129 }
01130  
<a name="l01131"></a><a class="code" href="classDetailed__Items__List.html#a0">01131</a> <font class="keywordtype">bool</font> <a class="code" href="classDetailed__Items__List.html#a0">Detailed_Items_List::Entry_Has_Dependencies</a>(<font class="keyword">const</font> <a class="code" href="classDIL__entry.html">DIL_entry</a> * de, <font class="keywordtype">bool</font> taggedonly = <font class="keyword">false</font>) {
01132   <font class="comment">// if taggedonly==true then only dependencies with a set semaphore count</font>
01133   <font class="keywordflow">if</font> (!de) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01134   <font class="keywordflow">if</font> (taggedonly) {
01135     <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a>,<a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(),1) <font class="keywordflow">if</font> (e-&gt;Get_Semaphore()&gt;0) <font class="keywordflow">if</font> (e-&gt;Is_Direct_Dependency_Of(de)) <font class="keywordflow">return</font> <font class="keyword">true</font>;
01136   } <font class="keywordflow">else</font> {
01137     <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a>,<a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(),1) <font class="keywordflow">if</font> (e-&gt;Is_Direct_Dependency_Of(de)) <font class="keywordflow">return</font> <font class="keyword">true</font>;
01138   }
01139   <font class="keywordflow">return</font> <font class="keyword">false</font>;
01140 }
01141 
<a name="l01142"></a><a class="code" href="classDetailed__Items__List.html#a1">01142</a> <font class="keywordtype">int</font> <a class="code" href="classDetailed__Items__List.html#a1">Detailed_Items_List::Get_Project_Data</a>(<a class="code" href="classString.html">String</a> &amp; dildata, <font class="keywordtype">int</font> projloc, <a class="code" href="classString.html">String</a> &amp; hrefurl, <a class="code" href="classString.html">String</a> &amp; hreftext, <a class="code" href="classDIL__entry__parameters.html">DIL_entry_parameters</a> &amp; dilentrypars) {
01143 <font class="comment">// dildata contains the DIL entry project data</font>
01144 <font class="comment">// projloc indicates how much of dildata has already been parsed</font>
01145 <font class="comment">// hrefurl and hreftext have already been obtained</font>
01146 <font class="comment">// dilentrypars receives the DIL entry project related parameters</font>
01147 <font class="comment">// *** Modify this if the data format changes</font>
01148         <font class="keywordtype">int</font> nextproj, dataloc, dataend;
01149         <font class="comment">// insure prior to next project URL</font>
01150         <font class="keywordflow">if</font> ((nextproj = dildata.<a class="code" href="classString.html#a26">index</a>(<font class="charliteral">'&lt;'</font>,projloc))&lt;0) nextproj=dildata.<a class="code" href="classString.html#a105">length</a>();
01151         <font class="comment">// start of project data</font>
01152         <font class="keywordflow">if</font> ((dataloc = <a class="code" href="utilities_8cc.html#a43">find_delimiter</a>(dildata,projloc,nextproj,<font class="charliteral">'('</font>))&lt;0) <font class="keywordflow">return</font> -1;
01153         dataloc++;
01154         <font class="comment">// find relevance data</font>
01155         <font class="keywordflow">if</font> ((dataend = <a class="code" href="utilities_8cc.html#a43">find_delimiter</a>(dildata,dataloc,nextproj,<font class="charliteral">','</font>))&lt;0) <font class="keywordflow">return</font> -1;
01156         <font class="keywordtype">double</font> relevance = atof(<a class="code" href="classString.html">String</a>(dildata.<a class="code" href="classString.html#a51">at</a>(dataloc,dataend-dataloc)));
01157         dataloc=dataend+1;
01158         <font class="comment">// find unbounded importance data</font>
01159         <font class="keywordflow">if</font> ((dataend = <a class="code" href="utilities_8cc.html#a43">find_delimiter</a>(dildata,dataloc,nextproj,<font class="charliteral">','</font>))&lt;0) <font class="keywordflow">return</font> -1;
01160         <font class="keywordtype">double</font> unbounded = atof(<a class="code" href="classString.html">String</a>(dildata.<a class="code" href="classString.html#a51">at</a>(dataloc,dataend-dataloc)));
01161         dataloc=dataend+1;
01162         <font class="comment">// find bounded importance data</font>
01163         <font class="keywordflow">if</font> ((dataend = <a class="code" href="utilities_8cc.html#a43">find_delimiter</a>(dildata,dataloc,nextproj,<font class="charliteral">','</font>))&lt;0) <font class="keywordflow">return</font> -1;
01164         <font class="keywordtype">double</font> bounded = atof(<a class="code" href="classString.html">String</a>(dildata.<a class="code" href="classString.html#a51">at</a>(dataloc,dataend-dataloc)));
01165         dataloc=dataend+1;
01166         <font class="comment">// find target date and target date properties</font>
01167         <font class="keywordflow">if</font> ((dataend = <a class="code" href="utilities_8cc.html#a43">find_delimiter</a>(dildata,dataloc,nextproj,<font class="charliteral">','</font>))&lt;0) <font class="keywordflow">return</font> -1;
01168         <a class="code" href="classString.html">String</a> ymdHM = dildata.<a class="code" href="classString.html#a51">at</a>(dataloc,dataend-dataloc);
01169         <font class="keywordtype">int</font> tdprop = 0;
01170         <font class="keywordflow">if</font> ((ymdHM.<a class="code" href="classString.html#a105">length</a>()&gt;0) &amp;&amp; (ymdHM[0]==<font class="charliteral">'F'</font>)) {
01171                 tdprop = <a class="code" href="dil2al_8hh.html#a29">DILSUPS_TDPROP_FIXED</a>;
01172                 ymdHM.<a class="code" href="classString.html#a83">del</a>(0,1);
01173         }
01174         <font class="keywordflow">if</font> (ymdHM.<a class="code" href="classString.html#a105">length</a>()&lt;12) ymdHM += <font class="stringliteral">"0000"</font>; <font class="comment">// year, month, day, hour, minute</font>
01175         time_t targetdate = <a class="code" href="utilities_8cc.html#a23">time_stamp_time</a>(ymdHM); <font class="comment">// local time stamp stored in calendar time</font>
01176         dataloc=dataend+1;
01177         <font class="comment">// find urgency data</font>
01178         <font class="keywordflow">if</font> ((dataend = <a class="code" href="utilities_8cc.html#a43">find_delimiter</a>(dildata,dataloc,nextproj,<font class="charliteral">','</font>))&lt;0) <font class="keywordflow">return</font> -1;
01179         <font class="keywordtype">double</font> urgency = atof(<a class="code" href="classString.html">String</a>(dildata.<a class="code" href="classString.html#a51">at</a>(dataloc,dataend-dataloc)));
01180         dataloc=dataend+1;
01181         <font class="comment">// find priority data</font>
01182         <font class="keywordflow">if</font> ((dataend = <a class="code" href="utilities_8cc.html#a43">find_delimiter</a>(dildata,dataloc,nextproj,<font class="charliteral">')'</font>))&lt;0) <font class="keywordflow">return</font> -1;
01183         <font class="keywordtype">double</font> priority = atof(<a class="code" href="classString.html">String</a>(dildata.<a class="code" href="classString.html#a51">at</a>(dataloc,dataend-dataloc)));
01184         <font class="comment">// store project data</font>
01185         dilentrypars.<a class="code" href="classDIL__entry__parameters.html#a3">project_append</a>(hrefurl,hreftext,relevance,unbounded,bounded,targetdate,tdprop,urgency,priority);
01186         <font class="keywordflow">return</font> dataend+1;
01187 }       
01188 
<a name="l01189"></a><a class="code" href="classDetailed__Items__List.html#a2">01189</a> <font class="keywordtype">int</font> <a class="code" href="classDetailed__Items__List.html#a2">Detailed_Items_List::Get_All_DIL_ID_File_Parameters</a>(<a class="code" href="classString.html">String</a> * dilid = NULL) {
01190 <font class="comment">// Obtain parameters from the DIL by ID file for all DIL entries</font>
01191 <font class="comment">// or for the specific DIL entry dilid if dilid!=NULL</font>
01192 <font class="comment">// Note: deletes any previous linked list at listhead and refreshes</font>
01193 <font class="comment">// the DIL status</font>
01194 
01195 <font class="comment">/*</font>
01196 <font class="comment">INCREASING PARSING SPEED:</font>
01197 <font class="comment"></font>
01198 <font class="comment">A.</font>
01199 <font class="comment"></font>
01200 <font class="comment">To insure that the functionality is preserved, first properly comment each</font>
01201 <font class="comment">step done in the current version of the code.</font>
01202 <font class="comment"></font>
01203 <font class="comment">B.</font>
01204 <font class="comment"></font>
01205 <font class="comment">1. Can translate all A-Z characters to a-z to avoid capitalization issues.</font>
01206 <font class="comment"></font>
01207 <font class="comment">2. Can search for "&lt;!--", then "--&gt;", then test if find right tag between.</font>
01208 <font class="comment">   You can also still use the Regex search here, since it is only one search.</font>
01209 <font class="comment"></font>
01210 <font class="comment">3. Can do the same for the end tag and copy that part of the text for parsing.</font>
01211 <font class="comment"></font>
01212 <font class="comment">4. Can find all chunks between &lt;TR&gt; &lt;TR&gt; and copy each to a separate String.</font>
01213 <font class="comment"></font>
01214 <font class="comment">5. Try to avoid Regex operations wherever possible.</font>
01215 <font class="comment">*/</font>
01216 
01217         <font class="keywordflow">if</font> (<a class="code" href="classDetailed__Items__List.html#b1">Read_from_Binary_Cache</a>(dilid)) <font class="keywordflow">return</font> <a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a6">length</a>();
01218 
01219         <font class="keywordtype">int</font> ididx, idloc, entrynum = 0;
01220         <font class="keywordflow">if</font> ((ididx=<a class="code" href="utilities_8cc.html#a40">get_file_in_list</a>(idfile,<a class="code" href="classText__File__Buffers.html#m0">tf</a>,<a class="code" href="classText__File__Buffers.html#m1">tfname</a>,<a class="code" href="classText__File__Buffers.html#m2">tfnum</a>))&lt;0) <font class="keywordflow">return</font> -1;
01221         <font class="keywordflow">if</font> ((idloc=<a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx].index(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[    ]*dil2al:[      ]*DIL ID begin[         ]*--[&gt;]"</font>),<a class="code" href="classString.html#s2s1">String::SEARCH_END</a>))&lt;0) <font class="keywordflow">return</font> -1;
01222         <a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a16">clear</a>();
01223         <font class="comment">// find next entry and obtain ID</font>
01224         <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"PARs: "</font>; <a class="code" href="dil2al_8hh.html#a108">VOUT</a>.flush();
01225         <a class="code" href="classString.html">String</a> idfilter(<font class="stringliteral">"[^\"]*"</font>); <font class="keywordflow">if</font> (dilid) idfilter = (*dilid);
01226         <a class="code" href="classBigRegex.html">BigRegex</a> entryid((<font class="stringliteral">"[&lt;]TR[&gt;][^&lt;]*[&lt;]TD[&gt;][^&lt;]*[&lt;]A[      ]+NAME[         ]*=[    ]*\"\\("</font>+idfilter)+<font class="stringliteral">"\\)\"[^\n]*\n"</font>);
01227         <font class="keywordflow">while</font> ((idloc=<a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx].index(entryid,<a class="code" href="classString.html#s2s1">String::SEARCH_END</a>,idloc))&gt;=0) {
01228                 <font class="keywordtype">int</font> sp,ml;
01229                 <font class="keywordflow">if</font> (!entryid.<a class="code" href="classBigRegex.html#a4">match_info</a>(sp,ml,1)) {
01230                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing ID in DIL entry "</font> &lt;&lt; entrynum &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Get_All_DIL_ID_File_Parameters(), continuing\n"</font>;
01231                         <font class="keywordflow">continue</font>;
01232                 }
01233                 <a class="code" href="classDIL__entry.html">DIL_entry</a> * de = <font class="keyword">new</font> <a class="code" href="classDIL__entry.html">DIL_entry</a>(*<font class="keyword">this</font>,<a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx].at(sp,ml)); <font class="comment">// create candidate entry</font>
01234                 <font class="keywordflow">if</font> (!de-&gt;<a class="code" href="classDIL__ID.html#a17">valid</a>()) {
01235                         <font class="keyword">delete</font> de;
01236                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Invalid ID in DIL entry "</font> &lt;&lt; entrynum &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Get_All_DIL_ID_File_Parameters(), continuing\n"</font>;
01237                         <font class="keywordflow">continue</font>;
01238                 }
01239 <font class="preprocessor">#ifdef DIAGNOSTIC_OUTPUT</font>
01240 <font class="preprocessor"></font>                <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"ID = "</font> &lt;&lt; de-&gt;<a class="code" href="classDIL__ID.html#a15">chars</a>() &lt;&lt; <font class="charliteral">'\n'</font>;
01241 <font class="preprocessor">#endif</font>
01242 <font class="preprocessor"></font>                <font class="comment">// find comma separated list of topics</font>
01243                 <a class="code" href="classString.html">String</a> topicline(<a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx].at(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]TD[&gt;][^\n]*\n"</font>),idloc)); <font class="comment">// topic data line</font>
01244                 <font class="keywordflow">if</font> (topicline.<a class="code" href="classString.html#a105">length</a>()==0) {
01245                         <font class="keyword">delete</font> de;
01246                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing topical DIL reference in DIL entry "</font> &lt;&lt; entrynum &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Get_All_DIL_ID_File_Parameters(), continuing\n"</font>;
01247                         <font class="keywordflow">continue</font>;
01248                 }
01249                 idloc += topicline.<a class="code" href="classString.html#a105">length</a>(); <font class="comment">// position after data line</font>
01250                 de-&gt;<a class="code" href="classDIL__entry.html#m1">parameters</a> = <font class="keyword">new</font> <a class="code" href="classDIL__entry__parameters.html">DIL_entry_parameters</a>(*de,entryid.<a class="code" href="classBigRegex.html#a5">subpos</a>());
01251                 <font class="keywordtype">int</font> topicloc = 0, numtopics = 0;
01252                 <a class="code" href="classBigRegex.html">BigRegex</a> entrytopic(<font class="stringliteral">"\\([&lt;]TD[&gt;]\\|,\\)[^&lt;]*[&lt;]A[       ]+HREF[         ]*=[    ]*\"\\([^#]*\\)#[^\"]*\"[^&gt;]*[&gt;]\\([^&lt;]*\\)[&lt;]/A[&gt;][    ]*(\\([^)]*\\))"</font>);
01253                 <font class="keywordflow">while</font> ((topicloc=topicline.<a class="code" href="classString.html#a26">index</a>(entrytopic,<a class="code" href="classString.html#s2s1">String::SEARCH_END</a>,topicloc))&gt;=0) {
01254                         <font class="keywordtype">int</font> sp2, ml2, sp3, ml3;
01255                         <font class="keywordflow">if</font> (!(entrytopic.<a class="code" href="classBigRegex.html#a4">match_info</a>(sp,ml,2) &amp;&amp; entrytopic.<a class="code" href="classBigRegex.html#a4">match_info</a>(sp2,ml2,3) &amp;&amp; entrytopic.<a class="code" href="classBigRegex.html#a4">match_info</a>(sp3,ml3,4))) {
01256                                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Invalid topical DIL reference in DIL entry "</font> &lt;&lt; entrynum &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Get_All_Parameters(), continuing\n"</font>;
01257                                 <font class="keywordflow">continue</font>;
01258                         }
01259                         de-&gt;<a class="code" href="classDIL__entry.html#m1">parameters</a>-&gt;<a class="code" href="classDIL__entry__parameters.html#a1">topic_append</a>(<a class="code" href="utilities_8cc.html#a31">absurl</a>(idfile,topicline.<a class="code" href="classString.html#a51">at</a>(sp,ml)),topicline.<a class="code" href="classString.html#a51">at</a>(sp2,ml2),atof(<a class="code" href="classString.html">String</a>(topicline.<a class="code" href="classString.html#a51">at</a>(sp3,ml3))));
01260 <font class="preprocessor">#ifdef DIAGNOSTIC_OUTPUT</font>
01261 <font class="preprocessor"></font>                        <font class="keywordflow">if</font> (<a class="code" href="classDIL__Topical__List.html">DIL_Topical_List</a> * dtl = de-&gt;<a class="code" href="classDIL__entry.html#a6">Topics</a>(numtopics)) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"\ttopic file = "</font> &lt;&lt; dtl-&gt;<a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m0">file</a> &lt;&lt; <font class="stringliteral">", topic title = "</font> &lt;&lt; dtl-&gt;<a class="code" href="classDIL__Topical__List.html#m0">dil</a>.<a class="code" href="structfiletitle__t.html#m1">title</a> &lt;&lt; <font class="stringliteral">"\n\t\trelevance = "</font> &lt;&lt; dtl-&gt;<a class="code" href="classDIL__Topical__List.html#m1">relevance</a> &lt;&lt; <font class="charliteral">'\n'</font>;
01262 <font class="preprocessor">#endif</font>
01263 <font class="preprocessor"></font>                        numtopics++;
01264                 }
01265                 <font class="keywordflow">if</font> (!numtopics) {
01266                         <font class="keyword">delete</font> de;
01267                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing data in topical DIL field of DIL entry "</font> &lt;&lt; entrynum &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Get_All_DIL_ID_File_Parameters(), continuing\n"</font>;
01268                         <font class="keywordflow">continue</font>;
01269                 }
01270                 <font class="comment">// find comma separated list of projects</font>
01271                 <font class="keywordtype">int</font> nextidloc; <a class="code" href="classString.html">String</a> cellparams, dildata;
01272                 <font class="keywordflow">if</font> ((nextidloc=<a class="code" href="utilities_8cc.html#a54">HTML_get_table_cell</a>(<a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx],idloc,cellparams,dildata))&lt;0) {
01273                         <font class="keyword">delete</font> de;
01274                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing project reference in DIL entry "</font> &lt;&lt; entrynum &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Get_All_DIL_ID_File_Parameters(), continuing\n"</font>;
01275                         <font class="keywordflow">continue</font>;
01276                 }
01277                 idloc = nextidloc;
01278                 <a class="code" href="utilities_8cc.html#a61">HTML_remove_comments</a>(dildata);
01279                 <font class="keywordtype">int</font> projloc = 0, numprojects = 0; <a class="code" href="classString.html">String</a> hrefurl, hreftext;
01280                 <font class="keywordflow">while</font> ((projloc=<a class="code" href="utilities_8cc.html#a58">HTML_get_href</a>(dildata,projloc,hrefurl,hreftext))&gt;=0) {
01281                         <font class="keywordtype">int</font> projidx;
01282                         hrefurl = <a class="code" href="utilities_8cc.html#a31">absurl</a>(idfile,hrefurl);
01283                         <font class="keywordflow">if</font> ((projidx=<a class="code" href="classDetailed__Items__List.html#a1">Get_Project_Data</a>(dildata,projloc,hrefurl,hreftext,*(de-&gt;<a class="code" href="classDIL__entry.html#m1">parameters</a>)))&lt;0) {
01284                                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing project data in DIL entry "</font> &lt;&lt; entrynum &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Get_All_DIL_ID_File_Parameters(), continuing\n"</font>;
01285                                 <font class="keywordflow">continue</font>;
01286                         }
01287                         projloc = projidx;
01288                         <font class="comment">// (currently ignoring whether or not comma separates project references)</font>
01289 <font class="preprocessor">#ifdef DIAGNOSTIC_OUTPUT</font>
01290 <font class="preprocessor"></font>                        <font class="keywordflow">if</font> (<a class="code" href="classDIL__AL__List.html">DIL_AL_List</a> * dal = de-&gt;<a class="code" href="classDIL__entry.html#a7">Projects</a>(numprojects)) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"\tproject file = "</font> &lt;&lt; dal-&gt;<a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m0">file</a> &lt;&lt; <font class="stringliteral">", project title = "</font> &lt;&lt; dal-&gt;<a class="code" href="classDIL__AL__List.html#m0">al</a>.<a class="code" href="structfiletitle__t.html#m1">title</a> &lt;&lt; <font class="stringliteral">"\n\t\trelevance = "</font> &lt;&lt; dal-&gt;<a class="code" href="classDIL__AL__List.html#m1">relevance</a> &lt;&lt; <font class="stringliteral">", unb.imp. = "</font> &lt;&lt; dal-&gt;<a class="code" href="classDIL__AL__List.html#m2">unbounded</a> &lt;&lt; <font class="stringliteral">", bound.imp. = "</font> &lt;&lt; dal-&gt;<a class="code" href="classDIL__AL__List.html#m3">bounded</a> &lt;&lt; <font class="stringliteral">"\n\t\ttarget date = "</font> &lt;&lt; dal-&gt;<a class="code" href="classDIL__AL__List.html#a5">targetdate</a>() &lt;&lt; <font class="stringliteral">", urgency = "</font> &lt;&lt; dal-&gt;<a class="code" href="classDIL__AL__List.html#m4">urgency</a> &lt;&lt; <font class="stringliteral">", priority = "</font> &lt;&lt; dal-&gt;<a class="code" href="classDIL__AL__List.html#m5">priority</a> &lt;&lt; <font class="charliteral">'\n'</font>;
01291 <font class="preprocessor">#endif</font>
01292 <font class="preprocessor"></font>                        numprojects++;
01293                 }
01294 <font class="comment">// *** Currently we tolerate missing project related data</font>
01295 <font class="comment">/*              if (!numprojects) {</font>
01296 <font class="comment">                        delete de;</font>
01297 <font class="comment">                        EOUT &lt;&lt; "dil2al: Missing data in project reference of DIL entry " &lt;&lt; entrynum &lt;&lt; " in Detailed_Items_List::Get_All_Parameters(), continuing\n";</font>
01298 <font class="comment">                        continue;</font>
01299 <font class="comment">                }</font>
01300 <font class="comment">*/</font>
01301                 <font class="comment">// attach to list</font>
01302                 <a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a8">link_before</a>(de);
01303                 entrynum++;
01304                 <font class="keywordflow">if</font> ((entrynum % 10)==0) { <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="charliteral">'.'</font>; <a class="code" href="dil2al_8hh.html#a108">VOUT</a>.flush(); }
01305         }
01306         <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="charliteral">'\n'</font>; <a class="code" href="dil2al_8hh.html#a108">VOUT</a>.flush();
01307 <font class="preprocessor">#ifdef DIAGNOSTIC_OUTPUT</font>
01308 <font class="preprocessor"></font>        <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"Number of entries = "</font> &lt;&lt; entrynum &lt;&lt; <font class="charliteral">'\n'</font>;
01309 <font class="preprocessor">#endif</font>
01310 <font class="preprocessor"></font>
01311         <font class="keywordflow">if</font> (!<a class="code" href="classDetailed__Items__List.html#b0">Write_to_Binary_Cache</a>()) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to write to binary cache file "</font> &lt;&lt; cacheidfile &lt;&lt; <font class="stringliteral">"in Detailed_Items_List::Get_All_DIL_ID_File_Parameters(), continuing as is\n"</font>;
01312 
01313         <font class="keywordflow">return</font> entrynum;
01314 }
01315 
<a name="l01316"></a><a class="code" href="classDetailed__Items__List.html#a3">01316</a> <font class="keywordtype">int</font> <a class="code" href="classDetailed__Items__List.html#a3">Detailed_Items_List::Get_All_Topical_DIL_Parameters</a>(<font class="keywordtype">bool</font> gettext = <font class="keyword">false</font>, <font class="keywordtype">bool</font> cacherefresh = <font class="keyword">false</font>) {
01317 <font class="comment">// Obtain parameters from the Topical DIL files for all DIL entries</font>
01318 <font class="comment">// Note: calls Get_All_DIL_ID_File_Parameters() if necessary</font>
01319 <font class="comment">// to link data to a linked list of DIL entries</font>
01320 <font class="comment">// *** could add options to either overwrite prior data</font>
01321 <font class="comment">//     (current state) or skip duplicate occurrances</font>
01322   <font class="keywordtype">int</font> ididx,idloc,entrynum,topicalentrynum = 0;
01323   <a class="code" href="classPLLRoot.html">PLLRoot&lt;DIL_entry_Pointer&gt;</a> dep; <font class="comment">// used to note DIL entries per cache</font>
01324   <font class="keywordflow">if</font> (!<a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a2">head</a>()) entrynum=<a class="code" href="classDetailed__Items__List.html#a2">Get_All_DIL_ID_File_Parameters</a>();
01325   <font class="keywordflow">else</font> entrynum=<a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a6">length</a>();
01326   <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"DILs: "</font>; <a class="code" href="dil2al_8hh.html#a108">VOUT</a>.flush();
01327   <font class="keywordflow">for</font> (<font class="keywordtype">int</font> n=0; (dil[n]); n++) {
01328     <font class="keywordflow">if</font> ((usequickloadcache) &amp;&amp; (!cacherefresh)) <font class="keywordflow">if</font> (<a class="code" href="classDetailed__Items__List.html#b3">Read_Topical_from_Binary_Cache</a>(n,gettext)) <font class="keywordflow">continue</font>;
01329 
01330     dep.<a class="code" href="classPLLRoot.html#a16">clear</a>();
01331     <font class="keywordflow">if</font> ((ididx=<a class="code" href="utilities_8cc.html#a40">get_file_in_list</a>(*(dil[n]),<a class="code" href="classText__File__Buffers.html#m0">tf</a>,<a class="code" href="classText__File__Buffers.html#m1">tfname</a>,<a class="code" href="classText__File__Buffers.html#m2">tfnum</a>))&lt;0) <font class="keywordflow">return</font> -1;
01332     <font class="keywordflow">if</font> ((idloc=<a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx].index(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[        ]*dil2al:[      ]*DIL begin[    ]*--[&gt;]"</font>),<a class="code" href="classString.html#s2s1">String::SEARCH_END</a>))&lt;0) <font class="keywordflow">return</font> -1;
01333     <font class="comment">// find next entry and obtain ID</font>
01334     <a class="code" href="classDIL__ID.html">DIL_ID</a> dilid; <a class="code" href="classString.html">String</a> markparams, rowcontent, cellcontent, reftext; <font class="keywordtype">int</font> rowloc,cellloc, topicalDILentrynum = 0;
01335     <font class="keywordflow">while</font> ((idloc=<a class="code" href="utilities_8cc.html#a55">HTML_get_table_row</a>(<a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx],idloc,markparams,rowcontent))&gt;=0) {
01336       <font class="keywordflow">if</font> ((rowloc=<a class="code" href="utilities_8cc.html#a54">HTML_get_table_cell</a>(rowcontent,0,markparams,cellcontent))&lt;0) {
01337         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing DIL ID in "</font> &lt;&lt; *(dil[n]) &lt;&lt; <font class="stringliteral">" at entry "</font> &lt;&lt; topicalDILentrynum &lt;&lt; <font class="stringliteral">" in Get_All_Topical_DIL_Parameters()\n"</font>;
01338         <font class="keywordflow">return</font> -1;
01339       }
01340       <font class="keywordflow">if</font> ((cellloc=<a class="code" href="utilities_8cc.html#a59">HTML_get_name</a>(cellcontent,0,markparams,reftext))&lt;0) {
01341         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing DIL ID name in "</font> &lt;&lt; *(dil[n]) &lt;&lt; <font class="stringliteral">" at entry "</font> &lt;&lt; topicalDILentrynum &lt;&lt; <font class="stringliteral">" in Get_All_Topical_DIL_Parameters()\n"</font>;
01342         <font class="keywordflow">return</font> -1;
01343       }
01344       dilid = markparams; <font class="comment">// obtain DIL entry ID</font>
01345       <a class="code" href="classDIL__entry.html">DIL_entry</a> * de;
01346       <font class="keywordflow">if</font> ((de = <a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a2">head</a>()-&gt;<a class="code" href="classDIL__entry.html#a4">elbyid</a>(dilid))==NULL) { <font class="comment">// find ID in DIL</font>
01347         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: DIL ID "</font> &lt;&lt; dilid.<a class="code" href="classDIL__ID.html#a15">chars</a>() &lt;&lt; <font class="stringliteral">" in "</font> &lt;&lt; *(dil[n]) &lt;&lt; <font class="stringliteral">" not found in "</font> &lt;&lt; idfile &lt;&lt; <font class="stringliteral">" in Get_All_Topical_DIL_Parameters()\n"</font>;
01348 <font class="comment">//#define FIND_DILID_LIST_ERROR</font>
01349 <font class="preprocessor">#ifdef FIND_DILID_LIST_ERROR</font>
01350 <font class="preprocessor"></font>        <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"List of DIL entries:\n"</font>;
01351         <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a>,<a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(),1) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; e-&gt;chars() &lt;&lt; <font class="charliteral">'\n'</font>;
01352 <font class="preprocessor">#endif</font>
01353 <font class="preprocessor"></font>        <font class="keywordflow">return</font> -1;
01354       }
01355       <font class="comment">// obtain parameters</font>
01356       <font class="keywordflow">if</font> ((rowloc=<a class="code" href="utilities_8cc.html#a54">HTML_get_table_cell</a>(rowcontent,rowloc,markparams,cellcontent))&lt;0) {
01357         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing parameters in "</font> &lt;&lt; *(dil[n]) &lt;&lt; <font class="stringliteral">" at entry "</font> &lt;&lt; topicalDILentrynum &lt;&lt; <font class="stringliteral">" in Get_All_Topical_DIL_Parameters()\n"</font>;
01358         <font class="keywordflow">return</font> -1;
01359       }
01360       <a class="code" href="utilities_8cc.html#a62">HTML_remove_tags</a>(cellcontent);
01361       <font class="keywordflow">if</font> (!de-&gt;<a class="code" href="classDIL__entry.html#a17">Get_Entry_Parameters</a>(cellcontent)) {
01362         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Invalid entry parameters in "</font> &lt;&lt; *(dil[n]) &lt;&lt; <font class="stringliteral">" at entry "</font> &lt;&lt; topicalDILentrynum &lt;&lt; <font class="stringliteral">" in Get_All_Topical_DIL_Parameters()\n"</font>;
01363         <font class="keywordflow">return</font> -1;
01364       }
01365       <font class="comment">// obtain text</font>
01366       <font class="keywordflow">if</font> ((idloc=<a class="code" href="utilities_8cc.html#a55">HTML_get_table_row</a>(<a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx],idloc,markparams,rowcontent))&lt;0) {
01367         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing DIL text row in "</font> &lt;&lt; *(dil[n]) &lt;&lt; <font class="stringliteral">" at entry "</font> &lt;&lt; topicalDILentrynum &lt;&lt; <font class="stringliteral">" in Get_All_Topical_DIL_Parameters()\n"</font>;
01368         <font class="keywordflow">return</font> -1;
01369       }
01370       <font class="keywordflow">if</font> (gettext) {
01371         <font class="keywordflow">if</font> ((rowloc=<a class="code" href="utilities_8cc.html#a54">HTML_get_table_cell</a>(rowcontent,0,markparams,cellcontent))&lt;0) {
01372           <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing DIL text in "</font> &lt;&lt; *(dil[n]) &lt;&lt; <font class="stringliteral">" at entry "</font> &lt;&lt; topicalDILentrynum &lt;&lt; <font class="stringliteral">" in Get_All_Topical_DIL_Parameters()\n"</font>;
01373           <font class="keywordflow">return</font> -1;
01374         }
01375         <font class="comment">//HTML_remove_comments(cellcontent);</font>
01376         <font class="keywordflow">if</font> (!de-&gt;<a class="code" href="classDIL__entry.html#m0">content</a>) de-&gt;<a class="code" href="classDIL__entry.html#m0">content</a> = <font class="keyword">new</font> <a class="code" href="classDIL__entry__content.html">DIL_entry_content</a>(*de);
01377         <font class="keyword">delete</font> de-&gt;<a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#m4">text</a>; <font class="comment">// remove prior allocation</font>
01378         de-&gt;<a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#m4">text</a> = <font class="keyword">new</font> <a class="code" href="classString.html">String</a>(cellcontent);
01379       }
01380 <font class="preprocessor">#ifdef DIAGNOSTIC_OUTPUT</font>
01381 <font class="preprocessor"></font>      <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"ID = "</font> &lt;&lt; de-&gt;<a class="code" href="classDIL__ID.html#a15">chars</a>() &lt;&lt; <font class="stringliteral">" ("</font> &lt;&lt; de-&gt;<a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#m0">started</a> &lt;&lt; <font class="charliteral">','</font> &lt;&lt; de-&gt;<a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#m1">required</a> &lt;&lt; <font class="charliteral">','</font> &lt;&lt; de-&gt;<a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#m2">completion</a> &lt;&lt; <font class="charliteral">','</font> &lt;&lt; de-&gt;<a class="code" href="classDIL__entry.html#m0">content</a>-&gt;<a class="code" href="classDIL__entry__content.html#m3">valuation</a> &lt;&lt; <font class="stringliteral">")\n"</font>;
01382 <font class="preprocessor">#endif</font>
01383 <font class="preprocessor"></font>      <font class="keywordflow">if</font> (usequickloadcache) dep.<a class="code" href="classPLLRoot.html#a8">link_before</a>(<font class="keyword">new</font> <a class="code" href="classDIL__entry__Pointer.html">DIL_entry_Pointer</a>(de));
01384       topicalDILentrynum++;
01385     }
01386 
01387     <font class="keywordflow">if</font> (!<a class="code" href="classDetailed__Items__List.html#b2">Write_Topical_to_Binary_Cache</a>(n,dep,gettext)) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to write topical to binary cache file "</font> &lt;&lt; dil.File(n)-&gt;chars() &lt;&lt; <font class="stringliteral">".cache in Detailed_Items_List::Get_All_Topical_DIL_Parameters(), continuing as is\n"</font>;
01388 
01389     topicalentrynum += topicalDILentrynum;
01390     <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="charliteral">'#'</font>; <a class="code" href="dil2al_8hh.html#a108">VOUT</a>.flush();
01391   }
01392   <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="charliteral">'\n'</font>; <a class="code" href="dil2al_8hh.html#a108">VOUT</a>.flush();
01393 <font class="preprocessor">#ifdef DIAGNOSTIC_OUTPUT</font>
01394 <font class="preprocessor"></font>  <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"Number of topical entries = "</font> &lt;&lt; topicalentrynum &lt;&lt; <font class="charliteral">'\n'</font>;
01395 <font class="preprocessor">#endif</font>
01396 <font class="preprocessor"></font>  <font class="keywordflow">return</font> entrynum;
01397 }
01398 
<a name="l01399"></a><a class="code" href="utilities_8cc.html#a12">01399</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a12">Lock_File</a>(<a class="code" href="classString.html">String</a> lockfile, <a class="code" href="classString.html">String</a> msgstr) {
01400   <font class="comment">// check for lock file</font>
01401   <font class="keyword">struct </font>stat statbuf;
01402   <font class="keywordflow">if</font> (stat(lockfile,&amp;statbuf)!=-1) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Warning - lock file "</font> &lt;&lt; lockfile &lt;&lt;  <font class="stringliteral">" in use by other process, waiting for release of lock in Lock_File()\n"</font>;
01403   <font class="keywordflow">while</font> (stat(lockfile,&amp;statbuf)!=-1) sleep(5);
01404   <font class="comment">// lock and write to binary cache file</font>
01405   <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a35">prepare_temporary_file</a>(lockfile,msgstr);
01406 }
01407 
<a name="l01408"></a><a class="code" href="utilities_8cc.html#a13">01408</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a13">Unlock_File</a>(<a class="code" href="classString.html">String</a> lockfile) {
01409   <font class="keywordflow">if</font> (unlink(lockfile)&lt;0) {
01410     <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to remove lock file "</font> &lt;&lt; lockfile &lt;&lt; <font class="stringliteral">" in Unlock_File(), continuing as is\n"</font>;
01411     <font class="keywordflow">return</font> <font class="keyword">false</font>;
01412   }
01413   <font class="keywordflow">return</font> <font class="keyword">true</font>;
01414 }
01415 
<a name="l01416"></a><a class="code" href="classDetailed__Items__List.html#b0">01416</a> <font class="keywordtype">bool</font> <a class="code" href="classDetailed__Items__List.html#b0">Detailed_Items_List::Write_to_Binary_Cache</a>() {
01417   <font class="comment">// Write a binary copy of the DIL parameters list to a cache file for quick loading.</font>
01418   <font class="keywordtype">bool</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">true</font>;
01419   <font class="keywordflow">if</font> (usequickloadcache) {
01420     <font class="keywordflow">if</font> (<a class="code" href="utilities_8cc.html#a12">Lock_File</a>(lockidfile,idfile+<font class="stringliteral">" locked by Detailed_Items_List::Write_to_Binary_Cache()\n"</font>)) {
01421       <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Writing parameters to binary cache file\n"</font>;
01422       ofstream cfl(cacheidfile,ios::binary);
01423       <font class="keywordflow">if</font> (!cfl) {
01424         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to write to "</font> &lt;&lt; cacheidfile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Write_to_Binary_Cache()\n"</font>;
01425         <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<font class="keyword">false</font>;
01426       } <font class="keywordflow">else</font> {
01427         <font class="keywordtype">int</font> numentries = <a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a6">length</a>();
01428         cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;numentries),<font class="keyword">sizeof</font>(numentries));
01429         <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a>,<a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(),1) <font class="keywordflow">if</font> (!e-&gt;Write_to_Binary_Cache(cfl)) { <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<font class="keyword">false</font>; <font class="keywordflow">break</font>; }
01430         cfl.close();
01431       }
01432       <font class="comment">// write new CRC for idfile and unlock</font>
01433       <font class="keywordflow">if</font> (res) <font class="keywordflow">if</font> (system(<font class="stringliteral">"cksum "</font>+idfile+<font class="stringliteral">" &gt; "</font>+crcidfile)==-1)  <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to write new CRC to "</font> &lt;&lt; crcidfile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Write_to_Binary_Cache(), continuing as is\n"</font>;
01434       <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a13">Unlock_File</a>(lockidfile)) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to remove lock file "</font> &lt;&lt; lockidfile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Write_to_Binary_Cache(), continuing as is\n"</font>;
01435     } <font class="keywordflow">else</font> {
01436       <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to prepare a Quick Load Cache in Detailed_Items_List::Write_to_Binary_Cache()\n"</font>;
01437       <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<font class="keyword">false</font>;
01438     }
01439   }
01440   <font class="keywordflow">return</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
01441 }
01442 
<a name="l01443"></a><a class="code" href="classDetailed__Items__List.html#b2">01443</a> <font class="keywordtype">bool</font> <a class="code" href="classDetailed__Items__List.html#b2">Detailed_Items_List::Write_Topical_to_Binary_Cache</a>(<font class="keywordtype">int</font> diln, <a class="code" href="classPLLRoot.html">PLLRoot&lt;DIL_entry_Pointer&gt;</a> &amp; dep, <font class="keywordtype">bool</font> gottext) {
01444   <font class="comment">// Write a binary copy of the DIL parameters list to a cache file for quick loading.</font>
01445   <font class="comment">/*</font>
01446 <font class="comment">    the structure in each cached topical content file is:</font>
01447 <font class="comment">    bool gottext</font>
01448 <font class="comment">    int DILentrynum</font>
01449 <font class="comment">    for each entry:</font>
01450 <font class="comment">      DIL_ID dilid</font>
01451 <font class="comment">      bool hascontent</font>
01452 <font class="comment">      time_t started</font>
01453 <font class="comment">      time_t required</font>
01454 <font class="comment">      float completion</font>
01455 <font class="comment">      float valuation</font>
01456 <font class="comment">      int textlen</font>
01457 <font class="comment">      char[] text</font>
01458 <font class="comment">  */</font>
01459   <font class="keywordtype">bool</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">true</font>;
01460   <font class="keywordflow">if</font> (usequickloadcache) {
01461     <a class="code" href="classString.html">String</a> filename((*dil.File(diln)));
01462     <a class="code" href="classString.html">String</a> lockfile(filename+<font class="stringliteral">".lock"</font>), cachefile(filename+<font class="stringliteral">".cache"</font>), crcfile(filename+<font class="stringliteral">".crc"</font>);
01463     <font class="keywordflow">if</font> (<a class="code" href="utilities_8cc.html#a12">Lock_File</a>(lockfile,filename+<font class="stringliteral">" locked by Detailed_Items_List::Write_Topical_to_Binary_Cache()\n"</font>)) {
01464       <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Writing topical content to binary cache file\n"</font>;
01465       ofstream cfl(cachefile,ios::binary);
01466       <font class="keywordflow">if</font> (!cfl) {
01467         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to write to "</font> &lt;&lt; cachefile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Write_Topical_to_Binary_Cache()\n"</font>;
01468         <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<font class="keyword">false</font>;
01469       } <font class="keywordflow">else</font> {
01470         cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;gottext),<font class="keyword">sizeof</font>(gottext));
01471         <font class="keywordtype">int</font> DILentrynum = dep.<a class="code" href="classPLLRoot.html#a6">length</a>();
01472         cfl.write((<font class="keyword">const</font> <font class="keywordtype">void</font> *) (&amp;DILentrynum),<font class="keyword">sizeof</font>(DILentrynum));
01473         <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__entry__Pointer.html">DIL_entry_Pointer</a>,dep.<a class="code" href="classPLLRoot.html#a2">head</a>(),1) <font class="keywordflow">if</font> (!e-&gt;Entry()-&gt;Write_Topical_to_Binary_Cache(cfl,gottext)) { <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<font class="keyword">false</font>; <font class="keywordflow">break</font>; }
01474         cfl.close();
01475       }
01476       <font class="comment">// write new CRC for filename and unlock</font>
01477       <font class="keywordflow">if</font> (res) <font class="keywordflow">if</font> (system(<font class="stringliteral">"cksum "</font>+filename+<font class="stringliteral">" &gt; "</font>+crcfile)==-1)  <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to write new CRC to "</font> &lt;&lt; crcfile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Write_topical_to_Binary_Cache(), continuing as is\n"</font>;
01478       <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a13">Unlock_File</a>(lockfile)) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to remove lock file "</font> &lt;&lt; lockfile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Write_Topical_to_Binary_Cache(), continuing as is\n"</font>;
01479     } <font class="keywordflow">else</font> {
01480       <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to prepare a Quick Load Cache in Detailed_Items_List::Write_Topical_to_Binary_Cache()\n"</font>;
01481       <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<font class="keyword">false</font>;
01482     }
01483   }
01484   <font class="keywordflow">return</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
01485 }
01486 
<a name="l01487"></a><a class="code" href="classDetailed__Items__List.html#b1">01487</a> <font class="keywordtype">bool</font> <a class="code" href="classDetailed__Items__List.html#b1">Detailed_Items_List::Read_from_Binary_Cache</a>(<a class="code" href="classString.html">String</a> * dilid = NULL) {
01488   <font class="comment">// Read a binary copy of the DIL parameters list from a cache file for quick loading.</font>
01489   <font class="keywordflow">if</font> (!usequickloadcache) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01490   <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a12">Lock_File</a>(lockidfile,idfile+<font class="stringliteral">" locked by Detailed_Items_List::Read_from_Binary_Cache()\n"</font>)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01491   <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Reading parameters from binary cache file\n"</font>;
01492   <font class="keywordtype">bool</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">true</font>;
01493   <font class="comment">// read and compare CRC for idfile</font>
01494   <font class="keywordtype">int</font> retstat;
01495   <font class="keywordflow">if</font> ((retstat=system(<font class="stringliteral">"cksum "</font>+idfile+<font class="stringliteral">" &gt; "</font>+crcidfile+<font class="stringliteral">".tmp"</font>))==-1) {
01496     <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to check CRC in Detailed_Items_List::Read_from_Binary_Cache()\n"</font>;
01497     <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01498   } <font class="keywordflow">else</font> {
01499     retstat = (((retstat) &amp; 0xff00) &gt;&gt; 8);
01500     <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"retstat = "</font> &lt;&lt; retstat &lt;&lt; <font class="charliteral">'\n'</font>;
01501     <font class="keywordflow">if</font> ((retstat=system(<font class="stringliteral">"diff -q "</font>+crcidfile+<font class="stringliteral">" "</font>+crcidfile+<font class="stringliteral">".tmp"</font>))!=0) {
01502       <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01503       <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"CRC difference - parsing of authoritative parameter file forced\n"</font>;
01504     }
01505     retstat = (((retstat) &amp; 0xff00) &gt;&gt; 8);
01506     <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"retstat = "</font> &lt;&lt; retstat &lt;&lt; <font class="charliteral">'\n'</font>;
01507     <font class="keywordflow">if</font> (unlink(crcidfile+<font class="stringliteral">".tmp"</font>)&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"Unable to remove temporary CRC file "</font> &lt;&lt; crcidfile &lt;&lt; <font class="stringliteral">".tmp in Detailed_Items_List::Read_from_Binary_Cache(), continuing as is\n"</font>;
01508   }
01509   <font class="keywordflow">if</font> (res) { <font class="comment">// read parameters from binary cache file</font>
01510     ifstream cfl(cacheidfile,ios::binary);
01511     <font class="keywordflow">if</font> (!cfl) {
01512       <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to read from "</font> &lt;&lt; cacheidfile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Read_from_Binary_Cache()\n"</font>;
01513       <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<font class="keyword">false</font>;
01514     } <font class="keywordflow">else</font> {
01515       <a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a16">clear</a>();
01516       <font class="keywordtype">int</font> numentries, numentriesread = 0;
01517       <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;numentries),<font class="keyword">sizeof</font>(numentries))).gcount()&lt;<font class="keyword">sizeof</font>(numentries)) <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01518 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
01519 <font class="preprocessor"></font>      <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; numentries = "</font> &lt;&lt; numentries &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
01520 <font class="preprocessor">#endif</font>
01521 <font class="preprocessor"></font>      <font class="keywordflow">while</font> (res) {
01522 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
01523 <font class="preprocessor"></font>        <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; numentriesread = "</font> &lt;&lt; numentriesread &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
01524 <font class="preprocessor">#endif</font>
01525 <font class="preprocessor"></font>        <a class="code" href="classDIL__entry.html">DIL_entry</a> * de = <font class="keyword">new</font> <a class="code" href="classDIL__entry.html">DIL_entry</a>(*<font class="keyword">this</font>);
01526         <font class="keywordflow">if</font> (!de-&gt;<a class="code" href="classDIL__entry.html#a24">Read_from_Binary_Cache</a>(cfl)) { 
01527           <font class="keyword">delete</font> de;
01528           <font class="keywordflow">if</font> (numentriesread&lt;numentries) {
01529             <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: WARNING - Insufficient data retrieved from binary cache file in Detailed_Items_List::Read_from_Binary_Cache()\n"</font>;
01530             <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01531           }
01532           <font class="keywordflow">break</font>;
01533         }
01534         <font class="keywordflow">if</font> (dilid) {
01535                 <font class="keywordflow">if</font> (de-&gt;<a class="code" href="classDIL__ID.html#a14">str</a>()==(*dilid)) <a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a8">link_before</a>(de); <font class="keywordflow">else</font> <font class="keyword">delete</font> de;
01536         } <font class="keywordflow">else</font> <a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a8">link_before</a>(de);
01537         numentriesread++;
01538         <font class="keywordflow">if</font> (numentriesread&gt;numentries) {
01539           <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: WARNING - Actual amount of data exceeds cached DIL length retrieved from binary cache file in Detailed_Items_List::Read_from_Binary_Cache()\n"</font>;
01540           <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01541         }
01542       }
01543       cfl.close();
01544       <font class="keywordflow">if</font> ((res) &amp;&amp; (numentriesread&lt;<a class="code" href="dil2al_8hh.html#a75">DILBYID_CACHE_NUMENTRIES_SUSPICIOUS</a>)) {
01545         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Number of cached entries read ("</font> &lt;&lt; numentriesread &lt;&lt; <font class="stringliteral">") deemed suspiciously few, parsing of authoritative parameter file forced\n"</font>;
01546         <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01547       }
01548     }
01549   }
01550   <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a13">Unlock_File</a>(lockidfile)) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to remove lock file "</font> &lt;&lt; lockidfile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Read_from_Binary_Cache(), continuing as is\n"</font>;
01551   <font class="keywordflow">return</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
01552 }
01553 
<a name="l01554"></a><a class="code" href="classDetailed__Items__List.html#b3">01554</a> <font class="keywordtype">bool</font> <a class="code" href="classDetailed__Items__List.html#b3">Detailed_Items_List::Read_Topical_from_Binary_Cache</a>(<font class="keywordtype">int</font> diln, <font class="keywordtype">bool</font> gettext) {
01555   <font class="comment">// Read a binary copy of the DIL Topical content from a cache file for quick loading.</font>
01556   <font class="keywordflow">if</font> (!usequickloadcache) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01557   <a class="code" href="classString.html">String</a> filename((*dil.File(diln)));
01558   <a class="code" href="classString.html">String</a> lockfile(filename+<font class="stringliteral">".lock"</font>), cachefile(filename+<font class="stringliteral">".cache"</font>), crcfile(filename+<font class="stringliteral">".crc"</font>);
01559   <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a12">Lock_File</a>(lockfile,filename+<font class="stringliteral">" locked by Detailed_Items_List::Read_Topical_from_Binary_Cache()\n"</font>)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01560   <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Reading topical content from binary cache file\n"</font>;
01561   <font class="keywordtype">bool</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">true</font>;
01562   <font class="comment">// read and compare CRC for filename</font>
01563   <font class="keywordflow">if</font> (system(<font class="stringliteral">"cksum "</font>+filename+<font class="stringliteral">" &gt; "</font>+crcfile+<font class="stringliteral">".tmp"</font>)==-1) {
01564     <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to check CRC in Detailed_Items_List::Read_Topical_from_Binary_Cache()\n"</font>;
01565     <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01566   } <font class="keywordflow">else</font> {
01567     <font class="keywordflow">if</font> (system(<font class="stringliteral">"diff -q "</font>+crcfile+<font class="stringliteral">" "</font>+crcfile+<font class="stringliteral">".tmp"</font>)!=0) {
01568       <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01569       <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"CRC difference - parsing of authoritative topical content file forced\n"</font>;
01570     }
01571     <font class="keywordflow">if</font> (unlink(crcfile+<font class="stringliteral">".tmp"</font>)&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"Unable to remove temporary CRC file "</font> &lt;&lt; crcfile &lt;&lt; <font class="stringliteral">".tmp in Detailed_Items_List::Read_Topical_from_Binary_Cache(), continuing as is\n"</font>;
01572   }
01573   <font class="keywordflow">if</font> (res) { <font class="comment">// read parameters from binary cache file</font>
01574     ifstream cfl(cachefile,ios::binary);
01575     <font class="keywordflow">if</font> (!cfl) {
01576       <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to read from "</font> &lt;&lt; cachefile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Read_Topical_from_Binary_Cache()\n"</font>;
01577       <a class="code" href="templates_8defines_8hh.html#a11">res</a>=<font class="keyword">false</font>;
01578     } <font class="keywordflow">else</font> {
01579       <font class="keywordtype">bool</font> gottext;
01580       <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;gottext),<font class="keyword">sizeof</font>(gottext))).gcount()&lt;<font class="keyword">sizeof</font>(gottext)) <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01581       <font class="keywordtype">int</font> numentries, numentriesread = 0;
01582       <font class="keywordflow">if</font> ((cfl.read((<a class="code" href="utilities_8cc.html#a0">READSOMETYPE</a>) (&amp;numentries),<font class="keyword">sizeof</font>(numentries))).gcount()&lt;<font class="keyword">sizeof</font>(numentries)) <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01583 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
01584 <font class="preprocessor"></font>      <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; numentries = "</font> &lt;&lt; numentries &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
01585 <font class="preprocessor">#endif</font>
01586 <font class="preprocessor"></font>      <font class="keywordflow">if</font> ((gettext) &amp;&amp; (!gottext)) {
01587         <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Text content needed and not available in cache, parsing of authoritative topical content file forced\n"</font>;
01588         <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01589       }
01590       <font class="keywordflow">while</font> (res) {
01591 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
01592 <font class="preprocessor"></font>        <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; numentriesread = "</font> &lt;&lt; numentriesread &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
01593 <font class="preprocessor">#endif</font>
01594 <font class="preprocessor"></font>        <a class="code" href="classDIL__ID.html">DIL_ID</a> did;
01595         <font class="keywordflow">if</font> (!did.<a class="code" href="classDIL__ID.html#a19">Read_DIL_ID_from_Binary_Cache</a>(cfl)) {
01596           <font class="keywordflow">if</font> (numentriesread&lt;numentries) {
01597             <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: WARNING - Insufficient data retrieved from binary cache file in Detailed_Items_List::Read_Topical_from_Binary_Cache()\n"</font>;
01598             <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01599           }
01600           <font class="keywordflow">break</font>;
01601         } <font class="keywordflow">else</font> {
01602 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
01603 <font class="preprocessor"></font>          <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; did = "</font> &lt;&lt; did.<a class="code" href="classDIL__ID.html#a15">chars</a>() &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
01604 <font class="preprocessor">#endif</font>
01605 <font class="preprocessor"></font>          <a class="code" href="classDIL__entry.html">DIL_entry</a> * de = <a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a2">head</a>()-&gt;<a class="code" href="classDIL__entry.html#a4">elbyid</a>(did);
01606 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
01607 <font class="preprocessor"></font>          <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; de = "</font> &lt;&lt; de-&gt;<a class="code" href="classDIL__ID.html#a15">chars</a>() &lt;&lt; <font class="charliteral">'\n'</font>; cout.flush();
01608 <font class="preprocessor">#endif</font>
01609 <font class="preprocessor"></font>          <font class="keywordflow">if</font> (!de) {
01610             <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: DIL ID "</font> &lt;&lt; did.<a class="code" href="classDIL__ID.html#a15">chars</a>() &lt;&lt; <font class="stringliteral">" not found in Detailed_Items_List::Read_Topical_from_Binary_Cache()\n"</font>;
01611             <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01612           } <font class="keywordflow">else</font> {
01613 <font class="preprocessor">#ifdef TEST_CACHE_READ</font>
01614 <font class="preprocessor"></font>            <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"&amp;&amp;&amp; de-&gt;Read_Topical_from_Binary_Cache(cfl,"</font> &lt;&lt; gottext &lt;&lt; <font class="stringliteral">")\n"</font>; cout.flush();
01615 <font class="preprocessor">#endif</font>
01616 <font class="preprocessor"></font>            <font class="keywordflow">if</font> (!de-&gt;<a class="code" href="classDIL__entry.html#a25">Read_Topical_from_Binary_Cache</a>(cfl,gottext)) { 
01617               <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to read topical content for "</font> &lt;&lt; did.<a class="code" href="classDIL__ID.html#a15">chars</a>() &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Read_Topical_from_Binary_Cache()\n"</font>;
01618               <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01619             } <font class="keywordflow">else</font> {
01620               <font class="comment">/*            if (dilid) {</font>
01621 <font class="comment">                            if (de-&gt;str()==(*dilid)) list.link_before(de); else delete de;</font>
01622 <font class="comment">                            } else list.link_before(de); */</font>
01623               numentriesread++;
01624               <font class="keywordflow">if</font> (numentriesread&gt;numentries) {
01625                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: WARNING - Actual amount of data exceeds cached DIL length retrieved from binary cache file in Detailed_Items_List::Read_Topical_from_Binary_Cache()\n"</font>;
01626                 <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01627               }
01628             }
01629           }
01630         }
01631       }
01632       cfl.close();
01633       <font class="keywordflow">if</font> ((res) &amp;&amp; (numentriesread&lt;1)) {
01634         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Number of cached entries read ("</font> &lt;&lt; numentriesread &lt;&lt; <font class="stringliteral">") deemed suspiciously few, parsing of authoritative topical content file forced\n"</font>;
01635         <a class="code" href="templates_8defines_8hh.html#a11">res</a> = <font class="keyword">false</font>;
01636       }
01637     }
01638   }
01639   <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a13">Unlock_File</a>(lockfile)) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to remove lock file "</font> &lt;&lt; lockfile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Read_Topical_from_Binary_Cache(), continuing as is\n"</font>;
01640   <font class="keywordflow">return</font> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
01641 }
01642 
<a name="l01643"></a><a class="code" href="classDetailed__Items__List.html#a6">01643</a> <font class="keywordtype">bool</font> <a class="code" href="classDetailed__Items__List.html#a6">Detailed_Items_List::Binary_Cache_Diagnostic</a>() {
01644   <font class="comment">// test if the quick load cache process works reliably</font>
01645   <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"dil2al::Detailed_Items_List::Binary_Cache_Diagnostic()\nTesting reliability of quick load cache process\n(Note that this is a good integrity test if modifications of the dilentry\nobjects necessitate corresponding modifications of the caching functions.)\n  flag `usequickloadcache' is "</font>;
01646   <font class="keywordflow">if</font> (usequickloadcache) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"set\n"</font>;
01647   <font class="keywordflow">else</font> <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"not set\n"</font>;
01648   <font class="comment">// parse the HTML file</font>
01649   <font class="keywordtype">bool</font> _usequickloadcache = usequickloadcache;
01650   usequickloadcache = <font class="keyword">false</font>;
01651   <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Parsing authoritative DIL parameters file\n"</font>;
01652   <font class="keywordflow">if</font> (<a class="code" href="classDetailed__Items__List.html#a2">Get_All_DIL_ID_File_Parameters</a>()&lt;0) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01653   <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Parsing authoritative DIL topical content files and writing to binary cache files\n"</font>;
01654   usequickloadcache = <font class="keyword">true</font>;
01655   <font class="keywordflow">if</font> (<a class="code" href="classDetailed__Items__List.html#a3">Get_All_Topical_DIL_Parameters</a>(<font class="keyword">true</font>,<font class="keyword">true</font>)&lt;0) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01656   <font class="comment">// save to cache</font>
01657   <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Writing to binary cache file "</font> &lt;&lt; cacheidfile &lt;&lt; <font class="charliteral">'\n'</font>;
01658   <font class="keywordflow">if</font> (!<a class="code" href="classDetailed__Items__List.html#b0">Write_to_Binary_Cache</a>()) {
01659     <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to write to binary cache file "</font> &lt;&lt; cacheidfile &lt;&lt; <font class="stringliteral">"in Detailed_Items_List::Binary_Cache_Diagnostic()\n"</font>;
01660     <font class="keywordflow">return</font> <font class="keyword">false</font>;
01661   }
01662   <font class="comment">// load from cache into temporary list</font>
01663   <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Reading from binary cache file into temporary list for comparison\n"</font>;
01664   <a class="code" href="classDetailed__Items__List.html">Detailed_Items_List</a> tmplist;
01665   <font class="keywordflow">if</font> (!tmplist.<a class="code" href="classDetailed__Items__List.html#b1">Read_from_Binary_Cache</a>()) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01666   <font class="keywordflow">for</font> (<font class="keywordtype">int</font> n = 0; (dil[n]); n++) <font class="keywordflow">if</font> (!tmplist.<a class="code" href="classDetailed__Items__List.html#b3">Read_Topical_from_Binary_Cache</a>(n,<font class="keyword">true</font>)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01667   <font class="comment">// compare the original and temporary lists</font>
01668   <font class="comment">//   start of this object test</font>
01669   <font class="keywordtype">int</font> testedbytes = <font class="keyword">sizeof</font>(Text_File_Buffers);
01670   <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Original length   = "</font> &lt;&lt; <a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a6">length</a>() &lt;&lt; <font class="charliteral">'\n'</font>;
01671   <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Cache read length = "</font> &lt;&lt; tmplist.<a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a6">length</a>() &lt;&lt; <font class="charliteral">'\n'</font>;
01672   testedbytes += <font class="keyword">sizeof</font>(list);
01673   <font class="comment">//   end of this object test</font>
01674   <font class="keywordflow">if</font> (testedbytes!=<font class="keyword">sizeof</font>(Detailed_Items_List)) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"*** testedbytes!=sizeof(Detailed_Items_List)\n"</font>;
01675   <font class="keywordflow">for</font> (<a class="code" href="classDIL__entry.html">DIL_entry</a> * e = <a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(), * c = tmplist.<a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(); ((e) &amp;&amp; (c)); e = e-&gt;<a class="code" href="classPLLHandle.html#a1">Next</a>(), c = c-&gt;<a class="code" href="classPLLHandle.html#a1">Next</a>()) <font class="keywordflow">if</font> (!e-&gt;<a class="code" href="classDIL__entry.html#a26">Binary_Cache_Diagnostic</a>(c,testedbytes)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01676   <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Total bytes tested: "</font> &lt;&lt; testedbytes &lt;&lt; <font class="charliteral">'\n'</font>;
01677   usequickloadcache = _usequickloadcache;
01678   <font class="keywordflow">return</font> <font class="keyword">true</font>;
01679 }
01680 
<a name="l01681"></a><a class="code" href="classDetailed__Items__List.html#a4">01681</a> <a class="code" href="classDIL__entry.html">DIL_entry</a> ** <a class="code" href="classDetailed__Items__List.html#a4">Detailed_Items_List::Sort_by_Target_Date</a>(<font class="keywordtype">bool</font> gettext = <font class="keyword">false</font>) {
01682 <font class="comment">// Create an array of pointers to DIL entries and sort it in</font>
01683 <font class="comment">// ascending order of target dates</font>
01684         <font class="keywordtype">int</font> entrynum,i = 0;
01685         <font class="keywordflow">if</font> (!<a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a2">head</a>()) entrynum=<a class="code" href="classDetailed__Items__List.html#a3">Get_All_Topical_DIL_Parameters</a>(gettext);
01686         <font class="keywordflow">else</font> entrynum=<a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a6">length</a>();
01687         <font class="keywordflow">if</font> (entrynum&lt;1) {
01688                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: No DIL to sort in Detailed_Items_List::Sort_by_Target_Date()\n"</font>;
01689                 <font class="keywordflow">return</font> NULL;
01690         }
01691         <font class="comment">// set up array</font>
01692         <a class="code" href="classDIL__entry.html">DIL_entry</a> ** dep = <font class="keyword">new</font> (<a class="code" href="classDIL__entry.html">DIL_entry</a> *)[entrynum];
01693         <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a>,<a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a2">head</a>(),(i&lt;entrynum)) { dep[i] = e; i++; }
01694         <font class="comment">// sort array</font>
01695         qsort(dep,entrynum,<font class="keyword">sizeof</font>(<a class="code" href="classDIL__entry.html">DIL_entry</a> *),<a class="code" href="utilities_8cc.html#a212">DIL_entry_target_date_qsort_compare</a>);
01696         <font class="keywordflow">return</font> dep;
01697 }
01698 
<a name="l01699"></a><a class="code" href="classDetailed__Items__List.html#a5">01699</a> <font class="keywordtype">bool</font> <a class="code" href="classDetailed__Items__List.html#a5">Detailed_Items_List::Write_to_File</a>() {
01700 <font class="comment">// writes a modified DIL-by-ID file</font>
01701 <font class="comment">// requires that Topic and Project/Superior parameters are available</font>
01702 <font class="comment">// (such as provided by a prior call to Get_All_DIL_ID_File_Parameters())</font>
01703 <font class="preprocessor">#ifdef CAUTIOUS_OBJECT_INTERFACES</font>
01704 <font class="preprocessor"></font>        <font class="keywordtype">int</font> ididx = <a class="code" href="classText__File__Buffers.html#a1">FileIndex</a>(idfile);
01705         <font class="keywordflow">if</font> (ididx&lt;0) <font class="keywordflow">return</font> <font class="keyword">false</font>;
01706 <font class="preprocessor">#else</font>
01707 <font class="preprocessor"></font>        <font class="keyword">const</font> <font class="keywordtype">int</font> ididx = 0;
01708 <font class="preprocessor">#endif</font>
01709 <font class="preprocessor"></font>        <font class="comment">// copy free-style header and table column headings</font>
01710         <font class="keywordtype">int</font> idloc;
01711         <font class="keywordflow">if</font> ((idloc=<a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx].index(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[    ]*dil2al:[      ]*DIL ID begin[         ]*--[&gt;]"</font>),<a class="code" href="classString.html#s2s1">String::SEARCH_END</a>))&lt;0) {
01712                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing header in "</font> &lt;&lt; idfile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Write_to_File(), continuing as is\n"</font>;
01713                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
01714         }
01715         <a class="code" href="classString.html">String</a> newidfile(<a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx].through(idloc)), rowparams, rowcontent;
01716         idloc = <a class="code" href="utilities_8cc.html#a55">HTML_get_table_row</a>(<a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx],idloc,rowparams,rowcontent);
01717         rowparams = <a class="code" href="utilities_8cc.html#a52">HTML_marker_arguments</a>(rowparams);
01718         newidfile += <font class="stringliteral">"\n\n"</font> + <a class="code" href="utilities_8cc.html#a64">HTML_put_table_row</a>(rowparams,rowcontent,<font class="keyword">true</font>);
01719         <font class="comment">// generate table</font>
01720         <a class="code" href="classDIL__entry.html">DIL_entry</a> * de = <a class="code" href="classDetailed__Items__List.html#m0">list</a>.<a class="code" href="classPLLRoot.html#a2">head</a>();
01721         <font class="keywordflow">if</font> (!de) {
01722                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: No DIL entries in list to write to "</font> &lt;&lt; idfile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Write_to_File(), continuing as is\n"</font>;
01723                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
01724         }
01725         <font class="keywordflow">if</font> (de-&gt;<a class="code" href="classDIL__entry.html#m1">parameters</a>) {
01726                 <a class="code" href="classString.html">String</a> topics, projects, tstamp;
01727                 <a class="code" href="templates_8classic_8hh.html#a1">PLL_LOOP_FORWARD</a>(<a class="code" href="classDIL__entry.html">DIL_entry</a>,de,1) {
01728                         topics = <font class="stringliteral">""</font>; <a class="code" href="templates_8classic_8hh.html#a2">PLL_LOOP_FORWARD_NESTED</a>(<a class="code" href="classDIL__Topical__List.html">DIL_Topical_List</a>,e-&gt;Topics(0),1,te) {
01729                                 <font class="keywordflow">if</font> (topics.<a class="code" href="classString.html#a105">length</a>()&gt;0) topics += <font class="stringliteral">", "</font>;
01730                                 topics += <a class="code" href="utilities_8cc.html#a68">HTML_put_href</a>(<a class="code" href="utilities_8cc.html#a30">relurl</a>(idfile,te-&gt;dil.file)+<font class="charliteral">'#'</font>+e-&gt;<a class="code" href="classString.html#a104">chars</a>(),te-&gt;dil.title)+<font class="stringliteral">" ("</font>;
01731                                 <font class="keywordflow">if</font> (te-&gt;relevance==<a class="code" href="dil2al_8hh.html#a21">DILTOPICS_REL_UNSPECIFIED</a>) topics += <font class="stringliteral">"?.?)"</font>;
01732                                 <font class="keywordflow">else</font> topics += <a class="code" href="classString.html">String</a>(te-&gt;relevance,<a class="code" href="dil2al_8hh.html#a95">DILBYID_FLOAT_FORMAT</a>)+<font class="charliteral">')'</font>;
01733                         }
01734                         <font class="keywordflow">if</font> (topics.<a class="code" href="classString.html#a105">length</a>()&lt;=0) {
01735                                 topics = <font class="stringliteral">"@MISSING TOPICAL CONTENT REFERENCE@"</font>;
01736                                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Warning - missing Topical Content Reference for DIL#"</font> &lt;&lt; e-&gt;chars() &lt;&lt; <font class="stringliteral">" in "</font> &lt;&lt; idfile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Write_to_File(), continuing\n"</font>;
01737                         }
01738                         projects = <font class="stringliteral">""</font>; <a class="code" href="templates_8classic_8hh.html#a2">PLL_LOOP_FORWARD_NESTED</a>(<a class="code" href="classDIL__AL__List.html">DIL_AL_List</a>,e-&gt;Projects(0),1,pe) {
01739                                 <font class="keywordflow">if</font> (projects.<a class="code" href="classString.html#a105">length</a>()&gt;0) projects += <font class="stringliteral">", "</font>;
01740                                 projects += <a class="code" href="utilities_8cc.html#a68">HTML_put_href</a>(<a class="code" href="utilities_8cc.html#a30">relurl</a>(idfile,pe-&gt;al.file),pe-&gt;al.title)+<font class="stringliteral">" ("</font>;
01741                                 <font class="keywordflow">if</font> (pe-&gt;relevance==<a class="code" href="dil2al_8hh.html#a23">DILSUPS_REL_UNSPECIFIED</a>) projects += <font class="stringliteral">"?.?,"</font>;
01742                                 <font class="keywordflow">else</font> projects += <a class="code" href="classString.html">String</a>(pe-&gt;relevance,<a class="code" href="dil2al_8hh.html#a95">DILBYID_FLOAT_FORMAT</a>)+<font class="charliteral">','</font>;
01743                                 <font class="keywordflow">if</font> (pe-&gt;unbounded==<a class="code" href="dil2al_8hh.html#a24">DILSUPS_UNB_UNSPECIFIED</a>) projects += <font class="stringliteral">"?.?,"</font>;
01744                                 <font class="keywordflow">else</font> projects += <a class="code" href="classString.html">String</a>(pe-&gt;unbounded,<a class="code" href="dil2al_8hh.html#a95">DILBYID_FLOAT_FORMAT</a>)+<font class="charliteral">','</font>;
01745                                 <font class="keywordflow">if</font> (pe-&gt;bounded==<a class="code" href="dil2al_8hh.html#a25">DILSUPS_BND_UNSPECIFIED</a>) projects += <font class="stringliteral">"?.?,"</font>;
01746                                 <font class="keywordflow">else</font> projects += <a class="code" href="classString.html">String</a>(pe-&gt;bounded,<a class="code" href="dil2al_8hh.html#a95">DILBYID_FLOAT_FORMAT</a>)+<font class="charliteral">','</font>;
01747                                 <font class="keywordflow">if</font> (pe-&gt;tdproperty()==<a class="code" href="dil2al_8hh.html#a29">DILSUPS_TDPROP_FIXED</a>) projects += <font class="charliteral">'F'</font>;
01748                                 <font class="keywordflow">if</font> (pe-&gt;targetdate()==<a class="code" href="dil2al_8hh.html#a26">DILSUPS_TD_UNSPECIFIED</a>) projects += <font class="stringliteral">"?,"</font>;
01749                                 <font class="keywordflow">else</font> {
01750                                         tstamp = <a class="code" href="utilities_8cc.html#a20">time_stamp</a>(<font class="stringliteral">"%Y%m%d%H%M"</font>,pe-&gt;targetdate());
01751                                         <font class="keywordflow">if</font> (tstamp.<a class="code" href="classString.html#a51">at</a>((<font class="keywordtype">int</font>) tstamp.<a class="code" href="classString.html#a105">length</a>()-4,4)==<font class="stringliteral">"0000"</font>) tstamp = tstamp.<a class="code" href="classString.html#a58">before</a>((<font class="keywordtype">int</font>) tstamp.<a class="code" href="classString.html#a105">length</a>()-4);
01752                                         projects += tstamp+<font class="charliteral">','</font>;
01753                                 }
01754                                 <font class="keywordflow">if</font> (pe-&gt;urgency==<a class="code" href="dil2al_8hh.html#a27">DILSUPS_URG_UNSPECIFIED</a>) projects += <font class="stringliteral">"?.?,"</font>;
01755                                 <font class="keywordflow">else</font> projects += <a class="code" href="classString.html">String</a>(pe-&gt;urgency,<a class="code" href="dil2al_8hh.html#a95">DILBYID_FLOAT_FORMAT</a>)+<font class="charliteral">','</font>;
01756                                 <font class="keywordflow">if</font> (pe-&gt;priority==<a class="code" href="dil2al_8hh.html#a28">DILSUPS_PRI_UNSPECIFIED</a>) projects += <font class="stringliteral">"?.?)"</font>;
01757                                 <font class="keywordflow">else</font> projects += <a class="code" href="classString.html">String</a>(pe-&gt;priority,<a class="code" href="dil2al_8hh.html#a95">DILBYID_FLOAT_FORMAT</a>)+<font class="charliteral">')'</font>;
01758                         }
01759                         <font class="keywordflow">if</font> (projects.<a class="code" href="classString.html#a105">length</a>()&lt;=0) projects = <font class="stringliteral">"&amp;nbsp;"</font>;
01760                         newidfile += <a class="code" href="utilities_8cc.html#a64">HTML_put_table_row</a>(<font class="stringliteral">""</font>,<font class="charliteral">'\n'</font>+<a class="code" href="utilities_8cc.html#a65">HTML_put_table_cell</a>(<font class="stringliteral">""</font>,<a class="code" href="utilities_8cc.html#a69">HTML_put_name</a>(e-&gt;chars(),e-&gt;chars()),<font class="keyword">true</font>)+<font class="charliteral">'\n'</font>+
01761                                                                                 <a class="code" href="utilities_8cc.html#a65">HTML_put_table_cell</a>(<font class="stringliteral">""</font>,topics,<font class="keyword">true</font>)+<font class="charliteral">'\n'</font>+
01762                                                                                 <a class="code" href="utilities_8cc.html#a65">HTML_put_table_cell</a>(<font class="stringliteral">""</font>,projects,<font class="keyword">true</font>),<font class="keyword">true</font>)+<font class="stringliteral">"\n\n"</font>;
01763                 }
01764         }
01765         <font class="comment">// copy free-style footer</font>
01766         <font class="keywordflow">if</font> ((idloc=<a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx].index(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[&lt;]!--[    ]*dil2al:[      ]*DIL ID end[   ]*--[&gt;]"</font>),idloc))&lt;0) {
01767                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing footer in "</font> &lt;&lt; idfile &lt;&lt; <font class="stringliteral">" in Detailed_Items_List::Write_to_File(), continuing as is\n"</font>;
01768                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
01769         }
01770         newidfile += <a class="code" href="classText__File__Buffers.html#m0">tf</a>[ididx].from(idloc);
01771         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a41">write_file_from_String</a>(idfile,newidfile,<font class="stringliteral">"DIL ID"</font>);
01772 }
01773 
<a name="l01774"></a><a class="code" href="utilities_8cc.html#a14">01774</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a14">DIL_entry_target_date_qsort_compare</a>(<font class="keyword">const</font> <font class="keywordtype">void</font> * vde1, <font class="keyword">const</font> <font class="keywordtype">void</font> * vde2) {
01775 <font class="comment">// used with qsort() (&lt;stdlib.h&gt;)</font>
01776 <font class="comment">// Treats unspecified self-referential target dates as MAXTIME</font>
01777 <font class="comment">// for the ordering of the corresponding DIL entry  - and avoids</font>
01778 <font class="comment">// the accompanying warning messages.</font>
01779 <font class="comment">// (This is useful when groups of DIL entries with desired</font>
01780 <font class="comment">// target dates are sorted, in which some DIL entries are marked</font>
01781 <font class="comment">// with -2 codes).</font>
01782 <font class="comment">// Note: ISO C++ is strict about providing the correct function</font>
01783 <font class="comment">// declaration in cases such as the call to qsort(). This function</font>
01784 <font class="comment">// was therefore rewritten from the original declaration,</font>
01785 <font class="comment">// DIL_entry_target_date_qsort_compare(DIL_entry ** de1, DIL_entry ** de2)</font>
01786 <font class="comment">// - please keep in mind that the elements are of type DIL_entry **,</font>
01787 <font class="comment">// i.e. arrays/pointers of pointers to objects.</font>
01788         <a class="code" href="classDIL__entry.html">DIL_entry</a> ** de1 = (<a class="code" href="classDIL__entry.html">DIL_entry</a> **) vde1;
01789         <a class="code" href="classDIL__entry.html">DIL_entry</a> ** de2 = (<a class="code" href="classDIL__entry.html">DIL_entry</a> **) vde2;
01790         time_t t1 = <a class="code" href="dil2al_8hh.html#a3">MAXTIME_T</a>, t2 = <a class="code" href="dil2al_8hh.html#a3">MAXTIME_T</a>;
01791         <font class="keywordflow">if</font> (*de1) t1 = (*de1)-&gt;Propagated_Target_Date(<font class="keyword">false</font>);
01792         <font class="keywordflow">if</font> (*de2) t2 = (*de2)-&gt;Propagated_Target_Date(<font class="keyword">false</font>);
01793         <font class="keywordflow">if</font> (t1==t2) <font class="keywordflow">return</font> 0;
01794         <font class="keywordflow">if</font> (t1&lt;t2) <font class="keywordflow">return</font> -1;
01795         <font class="keywordflow">return</font> 1;
01796 }
01797 
<a name="l01798"></a><a class="code" href="utilities_8cc.html#a15">01798</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a17">BigRegex_freq</a>(<a class="code" href="classString.html">String</a> &amp; str, <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> &amp; rx) {
01799         <font class="keywordtype">int</font> i = 0, cnt = 0;
01800         <font class="keywordflow">while</font> ((i=str.<a class="code" href="classString.html#a26">index</a>(rx,<a class="code" href="classString.html#s2s1">String::SEARCH_END</a>,i))&gt;=0) cnt++;
01801         <font class="keywordflow">return</font> cnt;
01802 }
01803 
<a name="l01804"></a><a class="code" href="utilities_8cc.html#a16">01804</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a17">BigRegex_freq</a>(<a class="code" href="classString.html">String</a> &amp; str, <a class="code" href="classString.html">String</a> rxstr) {
01805         <a class="code" href="classBigRegex.html">BigRegex</a> rx(rxstr);
01806         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a17">BigRegex_freq</a>(str,rx);
01807 }
01808 
<a name="l01809"></a><a class="code" href="utilities_8cc.html#a17">01809</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a17">BigRegex_freq</a>(<a class="code" href="classString.html">String</a> &amp; str, <font class="keyword">const</font> <font class="keywordtype">char</font> * rxstr) {
01810         <a class="code" href="classBigRegex.html">BigRegex</a> rx(rxstr);
01811         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a17">BigRegex_freq</a>(str,rx);
01812 }
01813 
<a name="l01814"></a><a class="code" href="utilities_8cc.html#a18">01814</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a18">RX_Search_Safe</a>(<a class="code" href="classString.html">String</a> s) {
01815 <font class="comment">// converts a regular string to that</font>
01816 <font class="comment">// string's match in a BigRegex search</font>
01817         s.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"["</font>,<font class="stringliteral">"[[]"</font>);
01818         s.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"]"</font>,<font class="stringliteral">"[]]"</font>);
01819         s.<a class="code" href="classString.html#a89">gsub</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[\\.*+?$]"</font>),<font class="stringliteral">"[_0]"</font>,<font class="charliteral">'_'</font>);
01820         <font class="keywordflow">if</font> ((s.<a class="code" href="classString.html#a105">length</a>()&gt;0) &amp;&amp; (s[0]==<font class="charliteral">'^'</font>)) s = <font class="stringliteral">"[^]"</font> + s.<a class="code" href="classString.html#a76">after</a>(0);
01821         <font class="keywordflow">return</font> s;
01822 }
01823 
<a name="l01824"></a><a class="code" href="utilities_8cc.html#a19">01824</a> time_t <a class="code" href="utilities_8cc.html#a19">Time</a>(time_t *tloc) {
01825 <font class="comment">// Local time() wrapper, allows emulation of different current time</font>
01826 <font class="comment">// returns time and sets (*tloc) to the same time if tloc!=NULL</font>
01827         <font class="keywordflow">if</font> (emulatedtime) {
01828                 <font class="keywordflow">if</font> (tloc) *tloc = emulatedtime;
01829                 <font class="keywordflow">return</font> emulatedtime;
01830         }
01831         <font class="keywordflow">return</font> time(tloc);
01832 }
01833 
<a name="l01834"></a><a class="code" href="utilities_8cc.html#a20">01834</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a20">time_stamp</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> * dateformat, time_t t = -1)  {
01835 <font class="comment">// time stamp in local time</font>
01836         <font class="keywordtype">char</font> dstr[80];
01837         <font class="keywordflow">if</font> (t&lt;0) t = <a class="code" href="utilities_8cc.html#a19">Time</a>(NULL);
01838         strftime(dstr,80,dateformat,localtime(&amp;t));
01839         <font class="keywordflow">return</font> <a class="code" href="classString.html">String</a>(dstr);
01840 }
01841 
<a name="l01842"></a><a class="code" href="utilities_8cc.html#a21">01842</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a21">time_stamp_GM</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> * dateformat, time_t t = -1) {
01843 <font class="comment">// Greenwich Meantime time stamp</font>
01844 <font class="comment">// Note: Use this when expressing time differences</font>
01845 <font class="comment">//       such as hours and minutes since 0.</font>
01846         <font class="keywordtype">char</font> dstr[80];
01847         <font class="keywordflow">if</font> (t&lt;0) t = <a class="code" href="utilities_8cc.html#a19">Time</a>(NULL);
01848         strftime(dstr,80,dateformat,gmtime(&amp;t));
01849         <font class="keywordflow">return</font> <a class="code" href="classString.html">String</a>(dstr);
01850 }
01851 
<a name="l01852"></a><a class="code" href="utilities_8cc.html#a22">01852</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a220">date_string</a>() {
01853         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a20">time_stamp</a>(<font class="stringliteral">"%Y%m%d"</font>);
01854 }
01855 
<a name="l01856"></a><a class="code" href="utilities_8cc.html#a23">01856</a> time_t <a class="code" href="utilities_8cc.html#a23">time_stamp_time</a>(<a class="code" href="classString.html">String</a> timestr) {
01857 <font class="comment">// local time string to calendar time time_t</font>
01858 <font class="comment">// negative numbers are returned as they are so that</font>
01859 <font class="comment">// special codes can be detected</font>
01860         <font class="keyword">struct </font>tm ts;
01861         <font class="keywordtype">int</font> tl = timestr.<a class="code" href="classString.html#a105">length</a>();
01862         <font class="keywordflow">if</font> (tl&gt;0) <font class="keywordflow">if</font> (timestr[0]==<font class="charliteral">'-'</font>) <font class="keywordflow">return</font> (time_t) atol((<font class="keyword">const</font> <font class="keywordtype">char</font> *) timestr);
01863         <font class="keywordflow">if</font> (tl&lt;9) <font class="keywordflow">return</font> (time_t) -1;
01864         ts.tm_sec = 0;
01865         ts.tm_min = atoi((<font class="keyword">const</font> <font class="keywordtype">char</font> *) <a class="code" href="classString.html">String</a>(timestr.<a class="code" href="classString.html#a51">at</a>(tl-2,2)));
01866         ts.tm_hour = atoi((<font class="keyword">const</font> <font class="keywordtype">char</font> *) <a class="code" href="classString.html">String</a>(timestr.<a class="code" href="classString.html#a51">at</a>(tl-4,2)));
01867         ts.tm_mday = atoi((<font class="keyword">const</font> <font class="keywordtype">char</font> *) <a class="code" href="classString.html">String</a>(timestr.<a class="code" href="classString.html#a51">at</a>(tl-6,2)));
01868         ts.tm_mon = atoi((<font class="keyword">const</font> <font class="keywordtype">char</font> *) <a class="code" href="classString.html">String</a>(timestr.<a class="code" href="classString.html#a51">at</a>(tl-8,2)))-1;
01869         ts.tm_year = atoi((<font class="keyword">const</font> <font class="keywordtype">char</font> *) <a class="code" href="classString.html">String</a>(timestr.<a class="code" href="classString.html#a51">at</a>(0,tl-8)))-1900;
01870         ts.tm_wday = 0;
01871         ts.tm_yday = 0;
01872         ts.tm_isdst = -1; <font class="comment">// computed by mktime since indicated "unknown" here</font>
01873         <font class="keywordflow">return</font> mktime(&amp;ts);
01874 }
01875 
<a name="l01876"></a><a class="code" href="utilities_8cc.html#a24">01876</a> time_t <a class="code" href="utilities_8cc.html#a24">time_stamp_time_of_day</a>(<a class="code" href="classString.html">String</a> timestr) {
01877         <font class="keywordtype">int</font> tl = timestr.<a class="code" href="classString.html#a105">length</a>();
01878         <a class="code" href="classString.html">String</a> h(timestr.<a class="code" href="classString.html#a51">at</a>(tl-4,2)),m(timestr.<a class="code" href="classString.html#a51">at</a>(tl-2,2));
01879         <font class="keywordflow">return</font> ((((time_t) atoi(h.<a class="code" href="classString.html#a104">chars</a>()))*60)+((time_t) atoi(m.chars())))*60;
01880 }
01881 
<a name="l01882"></a><a class="code" href="utilities_8cc.html#a25">01882</a> time_t <a class="code" href="utilities_8cc.html#a25">time_stamp_time_date</a>(<a class="code" href="classString.html">String</a> timestr) {
01883 <font class="comment">// local time string %Y%m%d%H%M set to 00:00 time of</font>
01884 <font class="comment">// day to calendar time</font>
01885         <font class="keywordtype">int</font> tl = timestr.<a class="code" href="classString.html#a105">length</a>() - 4;
01886         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a23">time_stamp_time</a>(<a class="code" href="classString.html">String</a>(timestr.<a class="code" href="classString.html#a58">before</a>(tl))+<font class="stringliteral">"0000"</font>);
01887 }
01888 
<a name="l01889"></a><a class="code" href="utilities_8cc.html#a26">01889</a> time_t <a class="code" href="utilities_8cc.html#a26">time_stamp_diff</a>(<a class="code" href="classString.html">String</a> oldtime,<a class="code" href="classString.html">String</a> newtime) {
01890         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a23">time_stamp_time</a>(newtime) - <a class="code" href="utilities_8cc.html#a23">time_stamp_time</a>(oldtime);
01891 }
01892 
<a name="l01893"></a><a class="code" href="utilities_8cc.html#a27">01893</a> time_t <a class="code" href="utilities_8cc.html#a27">double2time</a>(<font class="keywordtype">double</font> t) {
01894         <font class="keyword">struct </font>tm td;
01895         td.tm_sec = 0; <font class="comment">// seconds not explicit</font>
01896         td.tm_min = (int) fmod(t,100.0); t /= 100.0;
01897         td.tm_hour = (int) fmod(t,100.0); t /= 100.0;
01898         td.tm_mday = (int) fmod(t,100.0); t /= 100.0;
01899         td.tm_mon = ((int) fmod(t,100.0))-1; t /= 100.0;
01900         td.tm_year = ((int) t)-1900;
01901         td.tm_wday = 0;
01902         td.tm_yday = 0;
01903         td.tm_isdst = 0;
01904         <font class="keywordflow">return</font> mktime(&amp;td);
01905 }
01906 
<a name="l01907"></a><a class="code" href="utilities_8cc.html#a28">01907</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a28">confirmation</a>(<a class="code" href="classString.html">String</a> message, <font class="keywordtype">char</font> nondefault) {
01908 <font class="comment">// requests confirmation, returns false if the response is nondefault</font>
01909         <font class="keyword">const</font> <font class="keywordtype">int</font> LLEN = 16;
01910         <font class="keywordtype">char</font> lbuf[LLEN];
01911         cout &lt;&lt; message;
01912         cin.getline(lbuf,LLEN);
01913         <font class="keywordflow">return</font> (lbuf[0]!=nondefault);
01914 }
01915 
<a name="l01916"></a><a class="code" href="utilities_8cc.html#a29">01916</a> <font class="keywordtype">void</font> <a class="code" href="utilities_8cc.html#a29">auto_interactive</a>(<a class="code" href="classString.html">String</a> &amp; autostr, <a class="code" href="classString.html">String</a> message, <font class="keywordtype">char</font> * lbuf, <font class="keywordtype">int</font> llen) {
01917 <font class="comment">// enables interactive responses or takes responses from autostr if available</font>
01918         <font class="keywordflow">if</font> (autostr==<font class="stringliteral">""</font>) {
01919                 cout &lt;&lt; message;
01920                 cin.getline(lbuf,llen);
01921         } <font class="keywordflow">else</font> {
01922                 strcpy(lbuf,(<font class="keyword">const</font> <font class="keywordtype">char</font> *) autostr);
01923                 autostr.<a class="code" href="classString.html#a83">del</a>(0,1);
01924         }
01925 }
01926 
<a name="l01927"></a><a class="code" href="utilities_8cc.html#a30">01927</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a30">relurl</a>(<a class="code" href="classString.html">String</a> srcurl, <a class="code" href="classString.html">String</a> dsturl) {
01928         <a class="code" href="classString.html">String</a> tmp = <a class="code" href="BigString_8cc.html#a40">common_prefix</a>(srcurl.<a class="code" href="classString.html#a64">through</a>(<font class="charliteral">'/'</font>,-1),dsturl.<a class="code" href="classString.html#a64">through</a>(<font class="charliteral">'/'</font>,-1));
01929         <font class="keywordflow">if</font> ((!tmp.<a class="code" href="classString.html#a106">empty</a>()) &amp;&amp; (tmp.<a class="code" href="classString.html#a102">lastchar</a>()!=<font class="charliteral">'/'</font>)) tmp = tmp.<a class="code" href="classString.html#a64">through</a>(<font class="charliteral">'/'</font>,-1);
01930         <font class="keywordflow">if</font> (tmp!=<font class="stringliteral">""</font>) {
01931                 srcurl = srcurl.<a class="code" href="classString.html#a76">after</a>(tmp);
01932                 dsturl = dsturl.<a class="code" href="classString.html#a76">after</a>(tmp);
01933                 tmp = dsturl.<a class="code" href="classString.html#a70">from</a>(<font class="charliteral">'#'</font>); <font class="comment">// for dsturl references in srcurl file</font>
01934                 <font class="keywordflow">if</font> (tmp.<a class="code" href="classString.html#a105">length</a>()&gt;0) {
01935                         <a class="code" href="classString.html">String</a> tmp2 = srcurl.<a class="code" href="classString.html#a58">before</a>(<font class="charliteral">'#'</font>); <font class="keywordflow">if</font> (tmp2.<a class="code" href="classString.html#a105">length</a>()==0) tmp2 = srcurl;
01936                         <font class="keywordflow">if</font> (tmp2==dsturl.<a class="code" href="classString.html#a58">before</a>(<font class="charliteral">'#'</font>)) <font class="keywordflow">return</font> tmp;
01937                 }
01938                 <font class="keywordflow">while</font> (srcurl.<a class="code" href="classString.html#a58">before</a>(<font class="charliteral">'/'</font>)!=<font class="stringliteral">""</font>) { srcurl=srcurl.<a class="code" href="classString.html#a76">after</a>(<font class="charliteral">'/'</font>); dsturl.<a class="code" href="classString.html#a22">prepend</a>(<font class="stringliteral">"../"</font>); }
01939         }
01940         <font class="keywordflow">return</font> dsturl;
01941 }
01942 
<a name="l01943"></a><a class="code" href="utilities_8cc.html#a31">01943</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a31">absurl</a>(<a class="code" href="classString.html">String</a> srcurl, <a class="code" href="classString.html">String</a> relurl) {
01944 <font class="comment">// srcurl is an absolute filename or a directory path</font>
01945 <font class="comment">// ending with "/"</font>
01946 <font class="comment">// relurl is a URL relative to srcurl or an absolute URL</font>
01947 <font class="comment">// Note: This function may be confused by directory names</font>
01948 <font class="comment">//       of the form BigRegex(".+[.][.]")</font>
01949         <font class="keywordflow">if</font> (relurl==<font class="stringliteral">""</font>) <font class="keywordflow">return</font> srcurl;
01950         <font class="keywordflow">if</font> (relurl.<a class="code" href="classString.html#a32">contains</a>(<font class="stringliteral">"://"</font>)) relurl = relurl.<a class="code" href="classString.html#a76">after</a>(<font class="stringliteral">"://"</font>);
01951         <font class="keywordflow">if</font> (relurl[0]==<font class="charliteral">'/'</font>) <font class="keywordflow">return</font> relurl;
01952         <font class="keywordflow">if</font> (relurl[0]==<font class="charliteral">'#'</font>) <font class="keywordflow">return</font> srcurl+relurl;
01953         <font class="keywordtype">int</font> upcnt = relurl.<a class="code" href="classString.html#a47">freq</a>(<font class="stringliteral">"../"</font>);
01954         relurl.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"../"</font>,<font class="stringliteral">""</font>);
01955         srcurl = srcurl.<a class="code" href="classString.html#a58">before</a>(<font class="charliteral">'/'</font>,-1); <font class="comment">// prune source filename</font>
01956         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i &lt; upcnt; i++) srcurl = srcurl.<a class="code" href="classString.html#a58">before</a>(<font class="charliteral">'/'</font>,-1);
01957         <font class="keywordflow">return</font> srcurl+<font class="charliteral">'/'</font>+relurl;
01958 }
01959 
01960 <font class="comment">/*</font>
01961 <font class="comment">for every URL found in a file in the list of files</font>
01962 <font class="comment">1. determine if relative or absolute URL, remember that</font>
01963 <font class="comment">2. get absolute URL from HREF</font>
01964 <font class="comment">3. compare with URL to be replaced (ignoring # if # is not in the to-be-replaced)</font>
01965 <font class="comment">4. if matches, use new URL to create relative or absolute version, keeping # intact if not in to-be-replaced</font>
01966 <font class="comment">this should be applied to the files that are moved as well as to files referencing them</font>
01967 <font class="comment">and in the moved files all relative URLs have to be modified</font>
01968 <font class="comment">*/</font>
01969 
<a name="l01970"></a><a class="code" href="utilities_8cc.html#a32">01970</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a32">file_is_regular</a>(<a class="code" href="classString.html">String</a> filepath) {
01971         <font class="keyword">struct </font>stat fs;
01972         <font class="keywordflow">if</font> (stat(filepath,&amp;fs)!=0) {
01973                 <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Error reading file attributes of "</font> &lt;&lt; filepath &lt;&lt; <font class="stringliteral">" in file_is_regular()\n"</font>;
01974                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
01975         }
01976         <font class="keywordflow">return</font> S_ISREG(fs.st_mode);
01977 }
01978 
<a name="l01979"></a><a class="code" href="utilities_8cc.html#a33">01979</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a33">file_is_regular_or_symlink</a>(<a class="code" href="classString.html">String</a> filepath) {
01980         <font class="keyword">struct </font>stat fs;
01981         <font class="keywordflow">if</font> (stat(filepath,&amp;fs)!=0) {
01982                 <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Error reading file attributes of "</font> &lt;&lt; filepath &lt;&lt; <font class="stringliteral">"in file_is_regular_or_symlink()\n"</font>;
01983                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
01984         }
01985         <font class="keywordflow">return</font> (S_ISREG(fs.st_mode) || (S_ISLNK(fs.st_mode)));
01986 }
01987 
<a name="l01988"></a><a class="code" href="utilities_8cc.html#a34">01988</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a34">file_is_directory</a>(<a class="code" href="classString.html">String</a> filepath) {
01989         <font class="keyword">struct </font>stat fs;
01990         <font class="keywordflow">if</font> (stat(filepath,&amp;fs)!=0) {
01991                 <font class="keywordflow">if</font> (verbose) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Error reading file attributes of "</font> &lt;&lt; filepath &lt;&lt; <font class="stringliteral">"in file_is_directory()\n"</font>;
01992                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
01993         }
01994         <font class="keywordflow">return</font> S_ISDIR(fs.st_mode);
01995 }
01996 
<a name="l01997"></a><a class="code" href="utilities_8cc.html#a35">01997</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a35">prepare_temporary_file</a>(<a class="code" href="classString.html">String</a> tmpfile, <a class="code" href="classString.html">String</a> initstr) {
01998 <font class="comment">// Can be used to create temporary files (e.g. the dilref or,</font>
01999 <font class="comment">// note or DIL entry stubs), and automatically back up the</font>
02000 <font class="comment">// previous file if it exists. The stub is filled with the</font>
02001 <font class="comment">// content of initstr and closed.</font>
02002         <font class="keywordflow">if</font> (rename(tmpfile,tmpfile+<font class="stringliteral">".bak"</font>)&lt;0) <font class="keywordflow">if</font> (errno!=ENOENT) {
02003                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to rename "</font> &lt;&lt; tmpfile &lt;&lt; <font class="stringliteral">" to "</font> &lt;&lt; tmpfile+<font class="stringliteral">".bak in prepare_temporary_file()\n"</font>;
02004                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
02005         }
02006         ofstream ntf(tmpfile);
02007         <font class="keywordflow">if</font> (!ntf) {
02008                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to create temporary file "</font> &lt;&lt; tmpfile &lt;&lt; <font class="stringliteral">" in prepare_temporary_file()\n"</font>;
02009                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
02010         }
02011         <font class="keywordflow">if</font> (initstr!=<font class="stringliteral">""</font>) ntf &lt;&lt; initstr;
02012         ntf.close();
02013         <font class="keywordflow">return</font> <font class="keyword">true</font>;
02014 }
02015 
<a name="l02016"></a><a class="code" href="utilities_8cc.html#a36">02016</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a36">backup_and_rename</a>(<a class="code" href="classString.html">String</a> filename, <a class="code" href="classString.html">String</a> message, <font class="keywordtype">bool</font> isnew = <font class="keyword">false</font>) {
02017 <font class="comment">// Backup previous version of file with date stamp and make</font>
02018 <font class="comment">// new version current.</font>
02019         <a class="code" href="classString.html">String</a> backupname = filename+<font class="charliteral">'.'</font>+curdate+<font class="stringliteral">".bak"</font>;
02020         <font class="keywordflow">if</font> (!isnew) <font class="keywordflow">if</font> (rename(filename,backupname)&lt;0) {
02021                 <font class="keywordflow">if</font> (errno!=ENOENT) {
02022                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to rename "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">" to "</font> &lt;&lt; backupname &lt;&lt; <font class="stringliteral">" in backup_and_rename()\n(New version remains in "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">".new)\n"</font>;
02023                         <font class="keywordflow">return</font> <font class="keyword">false</font>;
02024                 } <font class="keywordflow">else</font> <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Warning - no old version of "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">" to backup in backup_and_rename()\n"</font>;
02025         }
02026         <font class="keywordflow">if</font> (rename(filename+<font class="stringliteral">".new"</font>,filename)&lt;0) {
02027                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to rename "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">".new to "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">" in backup_and_rename()\n(New version remains in "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">".new)\nRestoring previous "</font> &lt;&lt; filename &lt;&lt; <font class="charliteral">'\n'</font>;
02028                 <font class="keywordflow">if</font> (!isnew) <font class="keywordflow">if</font> (rename(backupname,filename)&lt;0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to restore "</font> &lt;&lt; backupname &lt;&lt; <font class="stringliteral">" to "</font> &lt;&lt; filename &lt;&lt; <font class="charliteral">'\n'</font>;
02029                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
02030         }
02031         <font class="keywordflow">if</font> (verbose) { <font class="comment">// *** perhaps this should be suppressed if errno==ENOENT was caught above</font>
02032                 <font class="keywordflow">if</font> (isnew) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; message &lt;&lt; <font class="stringliteral">" initialized as "</font> &lt;&lt; filename &lt;&lt; <font class="charliteral">'\n'</font>;
02033                 <font class="keywordflow">else</font> <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; <font class="stringliteral">"Old "</font> &lt;&lt; message &lt;&lt; <font class="stringliteral">" file moved to "</font> &lt;&lt; backupname &lt;&lt; <font class="charliteral">'\n'</font>;
02034         }
02035         <font class="keywordflow">return</font> <font class="keyword">true</font>;
02036 }
02037 
<a name="l02038"></a><a class="code" href="utilities_8cc.html#a37">02038</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a39">read_file_into_String</a>(ifstream &amp; sfl, <a class="code" href="classString.html">String</a> &amp; filestr, <font class="keywordtype">bool</font> warnnoopen = <font class="keyword">true</font>) {
02039 <font class="comment">// read from an open file stream into the string filestr,</font>
02040 <font class="comment">// optionally warning about the inability to open the file</font>
02041 <font class="comment">// returns true if file content was read into filestr</font>
02042         <font class="keywordflow">if</font> (sfl) {
02043                 filestr = sfl;
02044 <font class="comment">/*              sfl.seekg(0,ios::end); // seek to EOF</font>
02045 <font class="comment">                long int sflsize = sfl.tellg();</font>
02046 <font class="comment">                sfl.seekg(0);</font>
02047 <font class="comment">                char * s;</font>
02048 <font class="comment">                s = new char[sflsize+1];</font>
02049 <font class="comment">                sfl.read(s,sflsize);</font>
02050 <font class="comment">                s[sfl.gcount()]='\0';</font>
02051 <font class="comment">                filestr = s;</font>
02052 <font class="comment">                delete[] s;</font>
02053 <font class="comment">                if (sfl.gcount()!=sflsize) EOUT &lt;&lt; "dil2al: Characters read (" &lt;&lt; sfl.gcount() &lt;&lt; ") does not equal expected file size (" &lt;&lt; sflsize &lt;&lt; ") in read_file_into_String(), continuing as is\n";</font>
02054 <font class="comment">*/</font>              sfl.close();
02055                 <font class="keywordflow">return</font> <font class="keyword">true</font>;
02056         } <font class="keywordflow">else</font> {
02057                 <font class="keywordflow">if</font> (warnnoopen) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to open file in read_file_into_String()\n"</font>;
02058                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
02059         }
02060 }
02061 
<a name="l02062"></a><a class="code" href="utilities_8cc.html#a38">02062</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a39">read_file_into_String</a>(<a class="code" href="classString.html">String</a> filename, <a class="code" href="classString.html">String</a> &amp; filestr, <font class="keywordtype">bool</font> warnnoopen = <font class="keyword">true</font>) {
02063 <font class="comment">// read the file called filename into the string filestr,</font>
02064 <font class="comment">// optionally warning about the inability to open the file</font>
02065 <font class="comment">// returns true if file content was read into filestr</font>
02066         ifstream sfl(filename);
02067         <font class="keywordflow">if</font> (<a class="code" href="utilities_8cc.html#a39">read_file_into_String</a>(sfl,filestr,<font class="keyword">false</font>)) <font class="keywordflow">return</font> <font class="keyword">true</font>;
02068         <font class="keywordflow">else</font> {
02069                 <font class="keywordflow">if</font> (warnnoopen) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to open "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">" in read_file_into_String()\n"</font>;
02070                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
02071         }
02072 }
02073 
<a name="l02074"></a><a class="code" href="utilities_8cc.html#a39">02074</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a39">read_file_into_String</a>(<font class="keywordtype">bool</font> &amp; isnew, <a class="code" href="classString.html">String</a> filename, <a class="code" href="classString.html">String</a> &amp; filestr) {
02075 <font class="comment">// read the file called filename into filestr if it exists,</font>
02076 <font class="comment">// optionally offer to create the file if it does not exist,</font>
02077 <font class="comment">// or warn about the inability to open the file</font>
02078 <font class="comment">// returns true if file content was read into filestr</font>
02079 <font class="comment">// note that no file is created at this point, but the setting</font>
02080 <font class="comment">// of the isnew flag can be used later (e.g. by the function</font>
02081 <font class="comment">// write_string_to_file()) to anticipate new file creation</font>
02082         <font class="keywordflow">if</font> (<a class="code" href="utilities_8cc.html#a39">read_file_into_String</a>(filename,filestr,<font class="keyword">false</font>)) {
02083                 isnew = <font class="keyword">false</font>;
02084                 <font class="keywordflow">return</font> <font class="keyword">true</font>;
02085         } <font class="keywordflow">else</font> {
02086                 <font class="keywordflow">if</font> (offercreate) {
02087                         <font class="keyword">const</font> <font class="keywordtype">int</font> LLEN = 10;
02088                         <font class="keywordtype">char</font> lbuf[LLEN];
02089                         cout &lt;&lt; <font class="stringliteral">"File "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">"\ndoes not exist, create (y/N)? "</font>;
02090                         cin.getline(lbuf,LLEN);
02091                         <font class="keywordflow">if</font> ((lbuf[0]!=<font class="charliteral">'y'</font>) &amp;&amp; (lbuf[0]!=<font class="charliteral">'Y'</font>)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
02092                         isnew = <font class="keyword">true</font>;
02093                         <font class="keywordflow">return</font> <font class="keyword">true</font>;
02094                 } <font class="keywordflow">else</font> {
02095                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to open "</font> &lt;&lt; filename &lt;&lt; <font class="stringliteral">" in read_file_into_String()\n"</font>;
02096                         <font class="keywordflow">return</font> <font class="keyword">false</font>;
02097                 }
02098         }
02099 }
02100 
<a name="l02101"></a><a class="code" href="utilities_8cc.html#a40">02101</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a40">get_file_in_list</a>(<a class="code" href="classString.html">String</a> &amp; fname, <a class="code" href="classStringList.html">StringList</a> &amp; srcf, <a class="code" href="classStringList.html">StringList</a> &amp;srcfname, <font class="keywordtype">int</font> &amp; srcfnum) {
02102 <font class="comment">// load a file if it is not already in a list of file-strings</font>
02103         <font class="keywordtype">int</font> srcidx;
02104         <font class="keywordflow">if</font> ((srcidx = srcfname.<a class="code" href="classStringList.html#a11">iselement</a>(fname))&lt;0) {
02105                 <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a39">read_file_into_String</a>(fname,srcf[srcfnum])) {
02106                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to load source document "</font> &lt;&lt; fname &lt;&lt; <font class="stringliteral">" in get_file_in_list()\n"</font>;
02107                         <font class="keywordflow">return</font> -1;
02108                 }
02109                 srcfname[srcfnum] = fname;
02110                 srcidx = srcfnum;
02111                 srcfnum++;
02112         }
02113         <font class="keywordflow">return</font> srcidx;
02114 }
02115 
<a name="l02116"></a><a class="code" href="utilities_8cc.html#a41">02116</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a41">write_file_from_String</a>(<a class="code" href="classString.html">String</a> filename, <font class="keyword">const</font> <a class="code" href="classString.html">String</a> &amp; filestr, <a class="code" href="classString.html">String</a> message, <font class="keywordtype">bool</font> isnew = <font class="keyword">false</font>) {
02117 <font class="comment">// Write a file from string content, with automatic backup of</font>
02118 <font class="comment">// a previous version (if one exists).</font>
02119 <font class="preprocessor">#ifdef DEBUG</font>
02120 <font class="preprocessor"></font>        <font class="keywordtype">bool</font> b = (filename==taskloghead);
02121         <font class="keywordflow">if</font> (b) cout &lt;&lt; <font class="charliteral">'+'</font>;
02122 <font class="preprocessor">#endif</font>
02123 <font class="preprocessor"></font>        <a class="code" href="classString.html">String</a> newfilename = filename;
02124         <font class="keywordflow">if</font> (!isnew) newfilename += <font class="stringliteral">".new"</font>;
02125         ofstream ntl(newfilename);
02126         <font class="keywordflow">if</font> (!ntl) {
02127                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to create "</font> &lt;&lt; newfilename &lt;&lt; <font class="stringliteral">" in write_file_from_String()\n"</font>;
02128                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
02129         }
02130         ntl &lt;&lt; filestr;
02131         ntl.close();
02132 <font class="preprocessor">#ifdef DEBUG</font>
02133 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (b) cout &lt;&lt; <font class="charliteral">'+'</font>;
02134 <font class="preprocessor">#endif</font>
02135 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (isnew) { <font class="keywordflow">if</font> (verbose &amp;&amp; (!message.<a class="code" href="classString.html#a106">empty</a>())) <a class="code" href="dil2al_8hh.html#a108">VOUT</a> &lt;&lt; message &lt;&lt; <font class="stringliteral">" initialized as "</font> &lt;&lt; filename &lt;&lt; <font class="charliteral">'\n'</font>; }
02136         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (!<a class="code" href="utilities_8cc.html#a36">backup_and_rename</a>(filename,message)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
02137 <font class="preprocessor">#ifdef DEBUG</font>
02138 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (b) cout &lt;&lt; <font class="stringliteral">"+\n"</font>;
02139 <font class="preprocessor">#endif</font>
02140 <font class="preprocessor"></font>        <font class="keywordflow">return</font> <font class="keyword">true</font>;
02141 }
02142 
<a name="l02143"></a><a class="code" href="utilities_8cc.html#a42">02143</a> <font class="keywordtype">void</font> <a class="code" href="utilities_8cc.html#a42">read_data_from_stream</a>(istream &amp; ifs, <a class="code" href="classString.html">String</a> &amp; dstr, <font class="keyword">const</font> <font class="keywordtype">char</font> * terminate) {
02144 <font class="comment">// Reads data from a stream such as the data input stream</font>
02145 <font class="comment">// DIN line by line. Returns when end of file or a line</font>
02146 <font class="comment">// stating the terminate string is found.</font>
02147 <font class="comment">// *** This can be replaced by String::readtotag if LLEN=4096 is sufficient.</font>
02148         <font class="keyword">const</font> <font class="keywordtype">int</font> LLEN = 10240;
02149         <font class="keywordtype">char</font> lbuf[LLEN];
02150         <font class="keywordflow">while</font> (ifs) {
02151                 ifs.getline(lbuf,LLEN);
02152                 <font class="keywordflow">if</font> (ifs.eof()) <font class="keywordflow">break</font>;
02153                 <font class="keywordflow">if</font> (strcmp(lbuf,terminate)==0) <font class="keywordflow">break</font>;
02154                 dstr = (dstr + lbuf) + <font class="charliteral">'\n'</font>;
02155         }
02156 }
02157 
<a name="l02158"></a><a class="code" href="utilities_8cc.html#a43">02158</a> <font class="keyword">inline</font> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a43">find_delimiter</a>(<a class="code" href="classString.html">String</a> &amp; str, <font class="keywordtype">int</font> startpos, <font class="keywordtype">int</font> lenlimit, <font class="keywordtype">char</font> delimiter = <font class="charliteral">'\n'</font>) {
02159         <font class="keywordtype">int</font> delimpos = str.<a class="code" href="classString.html#a26">index</a>(delimiter,startpos);
02160         <font class="keywordflow">if</font> (delimpos&gt;=lenlimit) <font class="keywordflow">return</font> -1;
02161         <font class="keywordflow">return</font> delimpos;
02162 }
02163 
<a name="l02164"></a><a class="code" href="utilities_8cc.html#a44">02164</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a44">pattern_in_line</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> * pattern, <font class="keywordtype">char</font> * lbuf) {
02165         regex_t re;
02166         <font class="keywordtype">int</font> mres;
02167         <font class="keywordflow">if</font> (regcomp(&amp;re,pattern, REG_EXTENDED|REG_NOSUB) != 0) {
02168                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to compile regular expression in pattern_in_line()\n"</font>;
02169                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
02170         }
02171         mres = regexec(&amp;re,lbuf, (size_t) 0, NULL, 0);
02172         regfree(&amp;re);
02173         <font class="keywordflow">if</font> ((mres != 0) &amp;&amp; (mres != REG_NOMATCH)) {
02174                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Internal error while matching in pattern_in_line()\n"</font>;
02175                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
02176         }
02177         <font class="keywordflow">return</font> (mres==0);
02178 }
02179 
<a name="l02180"></a><a class="code" href="utilities_8cc.html#a45">02180</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a45">substring_from_line</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> * pattern, <font class="keywordtype">int</font> nsub, <a class="code" href="classString.html">String</a> * dilid, <font class="keyword">const</font> <font class="keywordtype">char</font> * lbuf) {
02181         <font class="keyword">const</font> <font class="keywordtype">int</font> SLEN = 1024;
02182         <font class="keywordtype">char</font> sbuf[SLEN];
02183         regex_t re;
02184         regmatch_t * rm;
02185         <font class="keywordtype">int</font> mres;
02186         <font class="keywordflow">if</font> (nsub) {
02187                 <font class="keywordflow">if</font> (regcomp(&amp;re,pattern, REG_EXTENDED) != 0) {
02188                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to compile regular expression in substring_from_line()\n"</font>;
02189                         <font class="keywordflow">return</font> <font class="keyword">false</font>;
02190                 }
02191                 rm = <font class="keyword">new</font> regmatch_t[nsub];
02192                 mres = regexec(&amp;re,lbuf, (size_t) nsub, rm, 0);
02193                 <font class="keywordflow">if</font> ((mres != 0) &amp;&amp; (mres != REG_NOMATCH)) {
02194                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Internal error while matching in substring_from_line()\n"</font>;
02195                 } <font class="keywordflow">else</font> {
02196                         <font class="keywordflow">if</font> (!mres) {
02197                                 <font class="keywordflow">if</font> (rm[nsub-1].rm_so==-1) {
02198                                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Wrong number of substring matches in substring_from_line()\n"</font>;
02199                                         mres = 3;
02200                                 } <font class="keywordflow">else</font> {
02201                                         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;nsub; i++) {
02202                                                 strncpy(sbuf,&amp;lbuf[rm[i].rm_so],rm[i].rm_eo-rm[i].rm_so);
02203                                                 sbuf[rm[i].rm_eo-rm[i].rm_so]=<font class="charliteral">'\0'</font>;
02204                                                 dilid[i] = sbuf;
02205                                         }
02206                                 }
02207                         }
02208                 }
02209                 <font class="keyword">delete</font>[] rm;
02210                 <font class="keywordflow">return</font> (mres==0);
02211         } <font class="keywordflow">else</font> {
02212                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: nsub==0 in substring_from_line()\n"</font>;
02213                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
02214         }
02215 }
02216 
<a name="l02217"></a><a class="code" href="utilities_8cc.html#a46">02217</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a46">find_line</a>(ifstream * lf, <font class="keyword">const</font> <font class="keywordtype">char</font> * pattern, <font class="keywordtype">char</font> * lbuf, <font class="keywordtype">int</font> llen) {
02218 <font class="comment">// takes an open ifstream and searches for the regex pattern</font>
02219         regex_t re;
02220         <font class="keywordtype">int</font> mres;
02221         <font class="keywordflow">if</font> (*lf) {
02222                 <font class="keywordflow">if</font> (regcomp(&amp;re,pattern, REG_EXTENDED|REG_NOSUB) != 0) {
02223                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to compile regular expression in find_line()\n"</font>;
02224                         <font class="keywordflow">return</font> <font class="keyword">false</font>;
02225                 }
02226                 mres = 1;
02227                 <font class="keywordflow">while</font> (mres!=0) {
02228                         <font class="keywordflow">if</font> (lf-&gt;eof()) {
02229                                 regfree(&amp;re);
02230                                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
02231                         }
02232                         lf-&gt;getline(lbuf,llen);
02233                         mres = regexec(&amp;re,lbuf, (size_t) 0, NULL, 0);
02234                         <font class="keywordflow">if</font> ((mres != 0) &amp;&amp; (mres != REG_NOMATCH)) {
02235                                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Internal error while matching in find_line()\n"</font>;
02236                                 regfree(&amp;re);
02237                                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
02238                         }
02239                 }
02240                 regfree(&amp;re);
02241                 <font class="keywordflow">return</font> <font class="keyword">true</font>;
02242         } <font class="keywordflow">else</font> {
02243                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: file not open in find_line()\n"</font>;
02244                 <font class="keywordflow">return</font> <font class="keyword">false</font>;
02245         }
02246 }
02247 
<a name="l02248"></a><a class="code" href="utilities_8cc.html#a47">02248</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a47">copy_until_line</a>(ifstream * lf, ofstream * of, <font class="keyword">const</font> <font class="keywordtype">char</font> * pattern, <font class="keywordtype">char</font> * lbuf, <font class="keywordtype">int</font> llen) {
02249 <font class="comment">// returns 1 if line was encountered, 0 if not, and &lt;0 for errors</font>
02250 <font class="comment">// the line containing pattern is not copied, but is returned in lbuf</font>
02251         regex_t re;
02252         <font class="keywordtype">int</font> mres;
02253         <font class="keywordflow">if</font> (!lf) {
02254                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: input file not open in copy_until_line()\n"</font>;
02255                 <font class="keywordflow">return</font> -1;
02256         }
02257         <font class="keywordflow">if</font> (!of) {
02258                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: output file not open in copy_until_line()\n"</font>;
02259                 <font class="keywordflow">return</font> -1;
02260         }
02261         <font class="keywordflow">if</font> (regcomp(&amp;re,pattern, REG_EXTENDED|REG_NOSUB) != 0) {
02262                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to compile regular expression in copy_until_line()\n"</font>;
02263                 <font class="keywordflow">return</font> -2;
02264         }
02265         mres = 1;
02266         cout &lt;&lt; <font class="stringliteral">"dil2al WARNING: copy_until_line(&lt;from&gt;,&lt;to&gt;,"</font> &lt;&lt; pattern &lt;&lt; <font class="stringliteral">",&lt;lbuf&gt;,&lt;llen&gt;) may be broken as EOF is not detected when line length exceeds llen="</font> &lt;&lt; llen &lt;&lt; <font class="stringliteral">", this code should use BigRegex functions instead!\n"</font>;
02267         <font class="keywordflow">while</font> (mres!=0) {
02268                 <font class="keywordflow">if</font> (lf-&gt;eof()) {
02269                         regfree(&amp;re);
02270                         <font class="keywordflow">return</font> 0;
02271                 }
02272                 lf-&gt;getline(lbuf,llen);
02273                 mres = regexec(&amp;re,lbuf, (size_t) 0, NULL, 0);
02274                 <font class="keywordflow">if</font> ((mres != 0) &amp;&amp; (mres != REG_NOMATCH)) {
02275                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Internal error while matching in copy_until_line()\n"</font>;
02276                         regfree(&amp;re);
02277                         <font class="keywordflow">return</font> -3;
02278                 }
02279                 <font class="keywordflow">if</font> (mres!=0) (*of) &lt;&lt; lbuf &lt;&lt; endl;
02280         }
02281         regfree(&amp;re);
02282         <font class="keywordflow">return</font> 1;
02283 }
02284 
<a name="l02285"></a><a class="code" href="utilities_8cc.html#a48">02285</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a48">find_in_line</a>(ifstream * lf, <font class="keyword">const</font> <font class="keywordtype">char</font> * pattern, <font class="keywordtype">int</font> nsub, <a class="code" href="classString.html">String</a> * dilid, <font class="keyword">const</font> <font class="keywordtype">char</font> * before, <font class="keywordtype">char</font> * lbuf, <font class="keywordtype">int</font> llen) {
02286 <font class="comment">// takes an open ifstream and searches for the regex pattern with nsub subexpressions</font>
02287 <font class="comment">// before a line with the ``before'' pattern (NULL = EOF)</font>
02288 <font class="comment">// returns substrings in dilid and the return value</font>
02289 <font class="comment">// 1 (found ``pattern''), 0 (found ``before''), -1 (EOF),</font>
02290 <font class="comment">// -2 (wrong #substrings), -3 (regex error) -4 (file not open)</font>
02291         <font class="keyword">const</font> <font class="keywordtype">int</font> SLEN = 1024;
02292         <font class="keywordtype">char</font> sbuf[SLEN];
02293         regex_t re,be;
02294         regmatch_t * rm;
02295         <font class="keywordtype">int</font> mres;
02296         <font class="keywordtype">bool</font> done;
02297         <font class="keywordflow">if</font> (*lf) {
02298                 <font class="keywordflow">if</font> (nsub) rm = <font class="keyword">new</font> regmatch_t[nsub];
02299                 <font class="keywordflow">else</font> rm = NULL;
02300                 <font class="keywordflow">if</font> (regcomp(&amp;re,pattern, REG_EXTENDED) != 0) {
02301                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to compile ``pattern'' regular expression in find_in_line()\n"</font>;
02302                         <font class="keywordflow">return</font> -3;
02303                 }
02304                 <font class="keywordflow">if</font> (before) {
02305                         <font class="keywordflow">if</font> (regcomp(&amp;be,before, REG_EXTENDED|REG_NOSUB) != 0) {
02306                                 regfree(&amp;re);
02307                                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to compile ``before'' regular expression in find_in_line()\n"</font>;
02308                                 <font class="keywordflow">return</font> -3;
02309                         }
02310                 }
02311                 done = <font class="keyword">false</font>;
02312                 <font class="keywordflow">while</font> (!done) {
02313                         <font class="keywordflow">if</font> (lf-&gt;eof()) { mres = 2; done=<font class="keyword">true</font>; }
02314                         <font class="keywordflow">else</font> {
02315                                 lf-&gt;getline(lbuf,llen);
02316                                 <font class="keywordflow">if</font> (before) mres = regexec(&amp;be,lbuf, (size_t) 0, NULL, 0);
02317                                 <font class="keywordflow">if</font> ((before) &amp;&amp; (mres != 0) &amp;&amp; (mres != REG_NOMATCH)) {
02318                                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Internal error while matching ``before'' in find_in_line()\n"</font>;
02319                                         mres = 4; done = <font class="keyword">true</font>;
02320                                 } <font class="keywordflow">else</font> {
02321                                         <font class="keywordflow">if</font> ((before) &amp;&amp; (mres==0)) { mres = 1; done = <font class="keyword">true</font>; }
02322                                         <font class="keywordflow">else</font> {
02323                                                 mres = regexec(&amp;re,lbuf, (size_t) nsub, rm, 0);
02324                                                 <font class="keywordflow">if</font> ((mres != 0) &amp;&amp; (mres != REG_NOMATCH)) {
02325                                                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Internal error while matching ``pattern'' in find_in_line()\n"</font>;
02326                                                         mres = 4; done = <font class="keyword">true</font>;
02327                                                 } <font class="keywordflow">else</font> {
02328                                                         <font class="keywordflow">if</font> (!mres) {
02329                                                                 done = <font class="keyword">true</font>;
02330                                                                 <font class="keywordflow">if</font> (nsub) {
02331                                                                         <font class="keywordflow">if</font> (rm[nsub-1].rm_so==-1) {
02332                                                                                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Wrong number of substring matches in find_in_line()\n"</font>;
02333                                                                                 mres = 3;
02334                                                                         } <font class="keywordflow">else</font> {
02335                                                                                 <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;nsub; i++) {
02336                                                                                         strncpy(sbuf,&amp;lbuf[rm[i].rm_so],rm[i].rm_eo-rm[i].rm_so);
02337                                                                                         sbuf[rm[i].rm_eo-rm[i].rm_so]=<font class="charliteral">'\0'</font>;
02338                                                                                         dilid[i] = sbuf;
02339                                                                                 }
02340                                                                         }
02341                                                                 }
02342                                                         }
02343                                                 }
02344                                         }
02345                                 }
02346                         }
02347                 }
02348                 regfree(&amp;re);
02349                 regfree(&amp;be);
02350                 <font class="keywordflow">if</font> (nsub) <font class="keyword">delete</font>[] rm;
02351                 <font class="keywordflow">return</font> (-mres) + 1;
02352         } <font class="keywordflow">else</font> {
02353                 <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: file not open in find_in_line()\n"</font>;
02354                 <font class="keywordflow">return</font> -4;
02355         }
02356 }
02357 
<a name="l02358"></a><a class="code" href="utilities_8cc.html#a49">02358</a> <font class="keywordtype">bool</font> <a class="code" href="utilities_8cc.html#a49">initialize_new_DIL_TL</a>(<a class="code" href="classString.html">String</a> initializecmd, <font class="keywordtype">bool</font> includeinput) {
02359 <font class="comment">// sends a DIL template with a new DIL ID, or a Task Log chunk or entry template to stdout</font>
02360         <font class="keywordflow">if</font> (initializecmd==<font class="stringliteral">"tc"</font>) { <font class="comment">// initialize Task Log chunk</font>
02361                 cout &lt;&lt; <a class="code" href="tladmin_8cc.html#a2">generate_TL_chunk_header</a>(<font class="stringliteral">"{"</font>+curtime+<font class="stringliteral">"}"</font>,<font class="stringliteral">"{relative-active-list-url}"</font>,<font class="stringliteral">"{Active List Title}"</font>,<font class="stringliteral">"{#tag-previous-AL-head}"</font>,<font class="stringliteral">"relative-DIL-url"</font>,<font class="stringliteral">"DIL Title/Non-DIL Identifying Comment"</font>,<font class="stringliteral">"#tag-previous-DIL-head"</font>,-1) &lt;&lt; <font class="stringliteral">"&lt;!-- edit items in ``{}'' brackets"</font>;
02362                 <font class="keywordflow">if</font> (!includeinput) cout &lt;&lt; <font class="stringliteral">" and add entries here"</font>;
02363                 cout &lt;&lt; <font class="stringliteral">" then close chunk --&gt;\n"</font>;
02364         } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (initializecmd==<font class="stringliteral">"te"</font>) { <font class="comment">// initialize Task Log entry</font>
02365                 cout &lt;&lt; <a class="code" href="tladmin_8cc.html#a3">generate_TL_entry_header</a>(<font class="stringliteral">"{"</font>+curtime+<font class="stringliteral">"}.{1}"</font>,<font class="stringliteral">"{relative-active-list-url}"</font>,<font class="stringliteral">"{Active List Title}"</font>,<font class="stringliteral">"{#tag-previous-AL-head}"</font>,<font class="stringliteral">"relative-DIL-url"</font>,<font class="stringliteral">"DIL Title/Non-DIL Identifying Comment"</font>,<font class="stringliteral">"#tag-previous-DIL-head"</font>) &lt;&lt; <font class="stringliteral">"&lt;!-- edit items in ``{}'' brackets"</font>;
02366                 <font class="keywordflow">if</font> (!includeinput) cout &lt;&lt; <font class="stringliteral">" and add content here"</font>;
02367                 cout &lt;&lt; <font class="stringliteral">" --&gt;\n"</font>;
02368         } <font class="keywordflow">else</font> { <font class="comment">// initialize DIL entry</font>
02369                 <a class="code" href="classString.html">String</a> newdilid = <a class="code" href="diladmin_8cc.html#a301">get_new_DIL_ID</a>();
02370                 <font class="keywordflow">if</font> (newdilid==<font class="stringliteral">""</font>) {
02371                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Unable to generate new DIL ID in initialize_new_DIL_TL()\n"</font>;
02372                         <font class="keywordflow">return</font> <font class="keyword">false</font>;
02373                 }
02374                 cout &lt;&lt; <font class="stringliteral">"&lt;TR BGCOLOR=\"#00005F\"&gt;\n&lt;TD WIDTH=\"15%\"&gt;&lt;A NAME=\""</font>
02375                         &lt;&lt; newdilid &lt;&lt; <font class="stringliteral">"\" HREF=\"detailed-items-by-ID.html#"</font>
02376                         &lt;&lt; newdilid &lt;&lt; <font class="stringliteral">"\"&gt;"</font> &lt;&lt; newdilid
02377                         &lt;&lt; <font class="stringliteral">"&lt;/A&gt;\n&lt;TD&gt;&lt;B&gt;time started:&lt;/B&gt; - &lt;B&gt;time required:&lt;/B&gt; ?.?hrs &lt;B&gt;completion ratio:&lt;/B&gt; 0.0 &lt;B&gt;valuation:&lt;/B&gt; ?.?\n&lt;TR&gt;\n&lt;TD COLSPAN=2&gt;"</font>;
02378         }
02379         <font class="keywordflow">if</font> (includeinput) {
02380                 <font class="keyword">const</font> <font class="keywordtype">int</font> LLEN = 10240;
02381                 <font class="keywordtype">char</font> lbuf[LLEN];
02382                 <a class="code" href="classString.html">String</a> dentrybuf;
02383                 <a class="code" href="utilities_8cc.html#a42">read_data_from_stream</a>(<a class="code" href="dil2al_8hh.html#a106">DIN</a>,dentrybuf,<font class="stringliteral">"@End of DIL entry@"</font>);
02384                 cout &lt;&lt; dentrybuf;
02385         }
02386         <font class="keywordflow">if</font> (initializecmd==<font class="stringliteral">"tc"</font>) { <font class="comment">// Task Log chunk</font>
02387                 cout &lt;&lt; <a class="code" href="tladmin_8cc.html#a2">generate_TL_chunk_header</a>(<font class="stringliteral">""</font>,<font class="stringliteral">""</font>,<font class="stringliteral">""</font>,<font class="stringliteral">""</font>,<font class="stringliteral">""</font>,<font class="stringliteral">""</font>,<font class="stringliteral">""</font>,1);
02388         } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (initializecmd==<font class="stringliteral">"te"</font>) { <font class="comment">// Task Log entry</font>
02389                 cout &lt;&lt; <font class="stringliteral">"&lt;P&gt;\n\n"</font>;
02390         } <font class="keywordflow">else</font> { <font class="comment">// DIL entry</font>
02391                 cout &lt;&lt; <font class="stringliteral">"\n\n"</font>;
02392         }
02393         <font class="keywordflow">return</font> <font class="keyword">true</font>;
02394 }
02395 
<a name="l02396"></a><a class="code" href="utilities_8cc.html#a50">02396</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a50">D2A_get_tag</a>(<a class="code" href="classString.html">String</a> &amp; d2astr, <font class="keywordtype">int</font> strloc, <a class="code" href="classString.html">String</a> d2atag, <a class="code" href="classString.html">String</a> &amp; tagtext) {
02397 <font class="comment">// searches for a dil2al standardized tag with the specific regex</font>
02398 <font class="comment">// id d2atag and returns the corresponding specific information</font>
02399 <font class="comment">// in tagtext, as well as the position in d2astr immediately</font>
02400 <font class="comment">// following the tag</font>
02401         <a class="code" href="classBigRegex.html">BigRegex</a> tm(<font class="charliteral">'@'</font>+d2atag+<font class="stringliteral">":\\([^@]*\\)@"</font>);
02402         <font class="keywordflow">if</font> ((strloc=d2astr.<a class="code" href="classString.html#a26">index</a>(tm,<a class="code" href="classString.html#s2s1">String::SEARCH_END</a>,strloc))&gt;=0) {
02403                 <font class="keywordtype">int</font> s,l;
02404                 <font class="keywordflow">if</font> (!tm.<a class="code" href="classBigRegex.html#a4">match_info</a>(s,l,1)) <font class="keywordflow">return</font> -1;
02405                 <font class="keywordflow">if</font> (l==0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Warning - Non-specific tag at "</font> &lt;&lt; s &lt;&lt; <font class="stringliteral">" in D2A_get_tag(), continuing\n"</font>;
02406                 tagtext = d2astr.<a class="code" href="classString.html#a51">at</a>(s,l);
02407         }
02408         <font class="keywordflow">return</font> strloc;
02409 }
02410 
<a name="l02411"></a><a class="code" href="utilities_8cc.html#a51">02411</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a51">HTML_get_marker</a>(<a class="code" href="classString.html">String</a> &amp; htmlstr, <font class="keywordtype">int</font> strloc, <a class="code" href="classString.html">String</a> &amp; marker,<font class="keywordtype">bool</font> locate = <font class="keyword">true</font>) {
02412         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> m(<font class="stringliteral">"[&lt;][^&gt;]+[&gt;]"</font>);
02413         <font class="comment">// find start of marker</font>
02414         <font class="keywordflow">if</font> (locate) {
02415                 <font class="keywordflow">if</font> ((strloc=htmlstr.<a class="code" href="classString.html#a26">index</a>(m,strloc))&lt;0) <font class="keywordflow">return</font> -1;
02416                 <font class="comment">// get marker</font>
02417                 <font class="keywordtype">int</font> s,l;
02418                 m.<a class="code" href="classBigRegex.html#a4">match_info</a>(s,l,0);
02419                 marker = htmlstr.<a class="code" href="classString.html#a51">at</a>(s,l);
02420                 <font class="keywordflow">return</font> strloc+l;
02421         }
02422         <font class="comment">// get marker</font>
02423         marker = htmlstr.<a class="code" href="classString.html#a51">at</a>(m,strloc); <font class="comment">// assumes marker starts at strloc</font>
02424         <font class="keywordflow">return</font> strloc+marker.<a class="code" href="classString.html#a105">length</a>();
02425 }
02426 
<a name="l02427"></a><a class="code" href="utilities_8cc.html#a52">02427</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a52">HTML_marker_arguments</a>(<a class="code" href="classString.html">String</a> &amp; marker) {
02428         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> a(<font class="stringliteral">"[     ]"</font>);
02429         <a class="code" href="classString.html">String</a> <a class="code" href="templates_8defines_8hh.html#a11">res</a> = marker.<a class="code" href="classString.html#a70">from</a>(a); <font class="keywordflow">if</font> (res.<a class="code" href="classString.html#a105">length</a>()&gt;=1) res = res.<a class="code" href="classString.html#a58">before</a>((<font class="keywordtype">int</font>) res.<a class="code" href="classString.html#a105">length</a>()-1);
02430         <font class="keywordflow">return</font> res;
02431 }
02432 
<a name="l02433"></a><a class="code" href="utilities_8cc.html#a53">02433</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a53">HTML_get_tagged_environment</a>(<font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> &amp; begintag, <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> &amp; endmatch, <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> &amp; endtag, <a class="code" href="classString.html">String</a> &amp; htmlstr, <font class="keywordtype">int</font> strloc, <a class="code" href="classString.html">String</a> &amp; envparams, <a class="code" href="classString.html">String</a> &amp; envcontent, <font class="keywordtype">int</font> * envstart = NULL) {
02434 <font class="comment">// searches for an environment beginning with a tag matching begintag,</font>
02435 <font class="comment">// determines the environment end according to possible matches in endmatch,</font>
02436 <font class="comment">// returns tag parameters in envparams, environment contents in envcontent,</font>
02437 <font class="comment">// optionally returns the start of the environment in envstart, and</font>
02438 <font class="comment">// returns the position directly after the environment and a potential</font>
02439 <font class="comment">// endtag</font>
02440         <font class="comment">// find start of environment</font>
02441         <font class="keywordflow">if</font> ((strloc=htmlstr.<a class="code" href="classString.html#a26">index</a>(begintag,strloc))&lt;0) <font class="keywordflow">return</font> -1;
02442         <font class="keywordflow">if</font> (envstart) (*envstart) = strloc;
02443         <font class="comment">// get environment tag parameters</font>
02444         <font class="keywordflow">if</font> ((strloc=<a class="code" href="utilities_8cc.html#a51">HTML_get_marker</a>(htmlstr,strloc,envparams,<font class="keyword">false</font>))&lt;0) <font class="keywordflow">return</font> -1;
02445         <font class="comment">// get environment content</font>
02446         <font class="keywordtype">int</font> envend = htmlstr.<a class="code" href="classString.html#a26">index</a>(endmatch,strloc);
02447         <font class="keywordflow">if</font> (envend&lt;0) envend = htmlstr.<a class="code" href="classString.html#a105">length</a>();
02448         envcontent = htmlstr.<a class="code" href="classString.html#a51">at</a>(strloc,envend-strloc);
02449         <font class="comment">// skip possible end tag</font>
02450         <font class="keywordtype">int</font> envendtagend = htmlstr.<a class="code" href="classString.html#a26">index</a>(endtag,<a class="code" href="classString.html#s2s1">String::SEARCH_END</a>,envend);
02451         <font class="keywordflow">if</font> (envendtagend&gt;=0) envend = envendtagend;
02452         <font class="keywordflow">return</font> envend;
02453 }
02454 
<a name="l02455"></a><a class="code" href="utilities_8cc.html#a54">02455</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a54">HTML_get_table_cell</a>(<a class="code" href="classString.html">String</a> &amp; htmlstr, <font class="keywordtype">int</font> strloc, <a class="code" href="classString.html">String</a> &amp; cellparams, <a class="code" href="classString.html">String</a> &amp; cellcontent, <font class="keywordtype">int</font> * cellstart = NULL) {
02456         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> cm(<font class="stringliteral">"[&lt;][Tt][Dd]"</font>);
02457         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> c(<font class="stringliteral">"\\([&lt;]/?[Tt][DdRr]\\|[&lt;]/[Tt][Aa][Bb][Ll][Ee]\\|[&lt;]/[Bb][Oo][Dd][Yy]\\|[&lt;]/[Hh][Tt][Mm][Ll]\\)"</font>);
02458         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> ce(<font class="stringliteral">"[&lt;]/[Tt][Dd][^&gt;]*[&gt;]"</font>);
02459         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a53">HTML_get_tagged_environment</a>(cm,c,ce,htmlstr,strloc,cellparams,cellcontent,cellstart);
02460 }
02461 
<a name="l02462"></a><a class="code" href="utilities_8cc.html#a55">02462</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a55">HTML_get_table_row</a>(<a class="code" href="classString.html">String</a> &amp; htmlstr, <font class="keywordtype">int</font> strloc, <a class="code" href="classString.html">String</a> &amp; rowparams, <a class="code" href="classString.html">String</a> &amp; rowcontent, <font class="keywordtype">int</font> * rowstart = NULL) {
02463         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> rm(<font class="stringliteral">"[&lt;][Tt][Rr]"</font>);
02464         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> r(<font class="stringliteral">"\\([&lt;]/?[Tt][Rr]\\|[&lt;]/[Tt][Aa][Bb][Ll][Ee]\\|[&lt;]/[Bb][Oo][Dd][Yy]\\|[&lt;]/[Hh][Tt][Mm][Ll]\\)"</font>);
02465         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> re(<font class="stringliteral">"[&lt;]/[Tt][Rr][^&gt;][&gt;]"</font>);
02466         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a53">HTML_get_tagged_environment</a>(rm,r,re,htmlstr,strloc,rowparams,rowcontent,rowstart);
02467 }
02468 
<a name="l02469"></a><a class="code" href="utilities_8cc.html#a56">02469</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a56">HTML_get_list</a>(<a class="code" href="classString.html">String</a> &amp; htmlstr, <font class="keywordtype">int</font> strloc, <a class="code" href="classString.html">String</a> &amp; listparams, <a class="code" href="classString.html">String</a> &amp; listcontent, <font class="keywordtype">int</font> * liststart = NULL) {
02470         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> lm(<font class="stringliteral">"[&lt;][UuOo][Ll]"</font>);
02471         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> l(<font class="stringliteral">"\\([&lt;]/[UuOo][Ll]\\|[&lt;]/[Tt][Aa][Bb][Ll][Ee]\\|[&lt;]/[Bb][Oo][Dd][Yy]\\|[&lt;]/[Hh][Tt][Mm][Ll]\\)"</font>);
02472         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> le(<font class="stringliteral">"[&lt;]/[UuOo][Ll][^&gt;][&gt;]"</font>); 
02473         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a53">HTML_get_tagged_environment</a>(lm,l,le,htmlstr,strloc,listparams,listcontent,liststart);
02474 }
02475 
<a name="l02476"></a><a class="code" href="utilities_8cc.html#a57">02476</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a57">HTML_get_list_item</a>(<a class="code" href="classString.html">String</a> &amp; htmlstr, <font class="keywordtype">int</font> strloc, <a class="code" href="classString.html">String</a> &amp; itemparams, <a class="code" href="classString.html">String</a> &amp; itemcontent, <font class="keywordtype">int</font> * itemstart = NULL) {
02477         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> im(<font class="stringliteral">"[&lt;][Ll][Ii]"</font>);
02478         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> i(<font class="stringliteral">"\\([&lt;]/?[Ll][Ii]\\|[&lt;]/[UuOo][Ll]\\|[&lt;]/[Tt][Aa][Bb][Ll][Ee]\\|[&lt;]/[Bb][Oo][Dd][Yy]\\|[&lt;]/[Hh][Tt][Mm][Ll]\\)"</font>);
02479         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> ie(<font class="stringliteral">"[&lt;]/[Ll][Ii][^&gt;][&gt;]"</font>);
02480         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a53">HTML_get_tagged_environment</a>(im,i,ie,htmlstr,strloc,itemparams,itemcontent,itemstart);
02481 }
02482 
<a name="l02483"></a><a class="code" href="utilities_8cc.html#a58">02483</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a58">HTML_get_href</a>(<a class="code" href="classString.html">String</a> &amp; htmlstr, <font class="keywordtype">int</font> strloc, <a class="code" href="classString.html">String</a> &amp; hrefurl, <a class="code" href="classString.html">String</a> &amp; hreftext, <font class="keywordtype">int</font> * hrefstart = NULL) {
02484 <font class="comment">// *** warning, this function can't deal properly yet with HREFs that contain</font>
02485 <font class="comment">//     HTML font formatting commands (e.g. &lt;B&gt;) in the reference text!</font>
02486         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> h(<font class="stringliteral">"[&lt;][Aa][      ]+[^&gt;]*[Hh][Rr][Ee][Ff][        ]*=[    ]*\"\\([^\"]*\\)\"[^&gt;]*[&gt;]\\([^&lt;]*\\)[&lt;]/[Aa][  ]?[^&gt;]*[&gt;]"</font>);
02487         <font class="keywordflow">if</font> ((strloc=htmlstr.<a class="code" href="classString.html#a26">index</a>(h,<a class="code" href="classString.html#s2s1">String::SEARCH_END</a>,strloc))&gt;=0) {
02488                 <font class="keywordtype">int</font> s,l;
02489                 <font class="keywordflow">if</font> (hrefstart) {
02490                   <font class="keywordflow">if</font> (!h.<a class="code" href="classBigRegex.html#a4">match_info</a>(s,l,0)) <font class="keywordflow">return</font> -1;
02491                   <font class="keywordflow">else</font> *hrefstart = s;
02492                 }
02493                 <font class="keywordflow">if</font> (!h.<a class="code" href="classBigRegex.html#a4">match_info</a>(s,l,1)) <font class="keywordflow">return</font> -1;
02494                 <font class="keywordflow">if</font> (l==0) {
02495                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing HREF URL at "</font> &lt;&lt; s &lt;&lt; <font class="stringliteral">" in HTML_get_href()\n"</font>;
02496                         <font class="keywordflow">return</font> -1;
02497                 }
02498                 hrefurl = htmlstr.<a class="code" href="classString.html#a51">at</a>(s,l);
02499                 <font class="keywordflow">if</font> (!h.<a class="code" href="classBigRegex.html#a4">match_info</a>(s,l,2)) <font class="keywordflow">return</font> -1;
02500                 <font class="keywordflow">if</font> (l==0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Warning - Invisible HREF anchor at "</font> &lt;&lt; s &lt;&lt; <font class="stringliteral">" in HTML_get_href(), continuing\n"</font>;
02501                 hreftext = htmlstr.<a class="code" href="classString.html#a51">at</a>(s,l);
02502         }
02503         <font class="keywordflow">return</font> strloc;
02504 }
02505 
<a name="l02506"></a><a class="code" href="utilities_8cc.html#a59">02506</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a59">HTML_get_name</a>(<a class="code" href="classString.html">String</a> &amp; htmlstr, <font class="keywordtype">int</font> strloc, <a class="code" href="classString.html">String</a> &amp; nametag, <a class="code" href="classString.html">String</a> &amp; nametext) {
02507         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> n(<font class="stringliteral">"[&lt;][Aa][      ]+[^&gt;]*[Nn][Aa][Mm][Ee][        ]*=[    ]*\"\\([^\"]*\\)\"[^&gt;]*[&gt;]\\([^&lt;]*\\)[&lt;]/[Aa][  ]?[^&gt;]*[&gt;]"</font>);
02508         <font class="keywordflow">if</font> ((strloc=htmlstr.<a class="code" href="classString.html#a26">index</a>(n,<a class="code" href="classString.html#s2s1">String::SEARCH_END</a>,strloc))&gt;=0) {
02509                 <font class="keywordtype">int</font> s,l;
02510                 <font class="keywordflow">if</font> (!n.<a class="code" href="classBigRegex.html#a4">match_info</a>(s,l,1)) <font class="keywordflow">return</font> -1;
02511                 <font class="keywordflow">if</font> (l==0) {
02512                         <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Missing NAME tag at "</font> &lt;&lt; s &lt;&lt; <font class="stringliteral">" in HTML_get_name()\n"</font>;
02513                         <font class="keywordflow">return</font> -1;
02514                 }
02515                 nametag = htmlstr.<a class="code" href="classString.html#a51">at</a>(s,l);
02516                 <font class="keywordflow">if</font> (!n.<a class="code" href="classBigRegex.html#a4">match_info</a>(s,l,2)) <font class="keywordflow">return</font> -1;
02517                 <font class="keywordflow">if</font> (l==0) <a class="code" href="dil2al_8hh.html#a107">EOUT</a> &lt;&lt; <font class="stringliteral">"dil2al: Warning - Invisible NAME anchor at "</font> &lt;&lt; s &lt;&lt; <font class="stringliteral">" in HTML_get_name(), continuing\n"</font>;
02518                 nametext = htmlstr.<a class="code" href="classString.html#a51">at</a>(s,l);
02519         }
02520         <font class="keywordflow">return</font> strloc;
02521 }
02522 
<a name="l02523"></a><a class="code" href="utilities_8cc.html#a60">02523</a> <a class="code" href="classString.html">String</a> * <a class="code" href="utilities_8cc.html#a60">HTML_safe</a>(<a class="code" href="classString.html">String</a> &amp; textstr) {
02524         textstr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&amp;"</font>,<font class="stringliteral">"&amp;amp;"</font>);
02525         textstr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&lt;"</font>,<font class="stringliteral">"&amp;lt;"</font>);
02526         textstr.<a class="code" href="classString.html#a89">gsub</a>(<font class="stringliteral">"&gt;"</font>,<font class="stringliteral">"&amp;gt;"</font>);
02527         <font class="keywordflow">return</font> &amp;textstr;
02528 }
02529 
<a name="l02530"></a><a class="code" href="utilities_8cc.html#a61">02530</a> <a class="code" href="classString.html">String</a> * <a class="code" href="utilities_8cc.html#a61">HTML_remove_comments</a>(<a class="code" href="classString.html">String</a> &amp; htmlstr) {
02531   <font class="keywordtype">int</font> cidx, cend = 0; <a class="code" href="classString.html">String</a> <a class="code" href="templates_8defines_8hh.html#a11">res</a>;
02532   res.<a class="code" href="classString.html#a107">alloc</a>(htmlstr.<a class="code" href="classString.html#a105">length</a>());
02533   <font class="keywordflow">while</font> ((cidx=htmlstr.<a class="code" href="classString.html#a26">index</a>(<font class="stringliteral">"&lt;!--"</font>,cend))&gt;=0) {
02534     <font class="keywordflow">if</font> (cidx&gt;cend) res += htmlstr.<a class="code" href="classString.html#a51">at</a>(cend,cidx-cend);
02535     <font class="keywordflow">if</font> ((cend=htmlstr.<a class="code" href="classString.html#a26">index</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"--[       ]*[&gt;]"</font>),<a class="code" href="classString.html#s2s1">String::SEARCH_END</a>,cidx))&lt;0) cend=htmlstr.<a class="code" href="classString.html#a105">length</a>();
02536   }
02537   cidx=htmlstr.<a class="code" href="classString.html#a105">length</a>();
02538   <font class="keywordflow">if</font> (cidx&gt;cend) res += htmlstr.<a class="code" href="classString.html#a51">at</a>(cend,cidx-cend);
02539   htmlstr = res;
02540   <font class="keywordflow">return</font> &amp;htmlstr;
02541 }
02542 
02543 <font class="comment">/*String * HTML_remove_comments(String &amp; htmlstr) {</font>
02544 <font class="comment">// *** Is there a problem with String::del()?</font>
02545 <font class="comment">  int cidx = 0, cend;</font>
02546 <font class="comment">  while ((cidx=htmlstr.index("&lt;!--",cidx))&gt;=0) {</font>
02547 <font class="comment">    if ((cend=htmlstr.index(BigRegex("--[       ]*[&gt;]"),String::SEARCH_END,cidx))&lt;0) cend=htmlstr.length();</font>
02548 <font class="comment">    </font>
02549 <font class="comment">    htmlstr.del(cidx,cend-cidx);</font>
02550 <font class="comment">    cidx=cend;</font>
02551 <font class="comment">  }</font>
02552 <font class="comment">  return &amp;htmlstr;</font>
02553 <font class="comment">  }*/</font>
02554 
<a name="l02555"></a><a class="code" href="utilities_8cc.html#a62">02555</a> <a class="code" href="classString.html">String</a> * <a class="code" href="utilities_8cc.html#a62">HTML_remove_tags</a>(<a class="code" href="classString.html">String</a> &amp; htmlstr) {
02556         <font class="keyword">const</font> <a class="code" href="classBigRegex.html">BigRegex</a> m(<font class="stringliteral">"[&lt;][^&gt;]+[&gt;]"</font>);
02557         htmlstr.<a class="code" href="classString.html#a89">gsub</a>(m,<font class="stringliteral">""</font>);
02558         <font class="keywordflow">return</font> &amp;htmlstr;
02559 }
02560 
<a name="l02561"></a><a class="code" href="utilities_8cc.html#a63">02561</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a63">HTML_put_structure</a>(<a class="code" href="classString.html">String</a> tag, <a class="code" href="classString.html">String</a> params, <a class="code" href="classString.html">String</a> content, <font class="keywordtype">bool</font> relaxedhtml = <font class="keyword">false</font>) {
02562         params.<a class="code" href="classString.html#a22">prepend</a>(<font class="charliteral">'&lt;'</font>+tag);
02563         params += <font class="charliteral">'&gt;'</font>+content;
02564         <font class="keywordflow">if</font> (relaxedhtml) <font class="keywordflow">return</font> params;
02565         params += <font class="stringliteral">"&lt;/"</font>+tag+<font class="stringliteral">"&gt;\n"</font>;
02566         <font class="keywordflow">return</font> params;
02567 }
02568 
<a name="l02569"></a><a class="code" href="utilities_8cc.html#a64">02569</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a64">HTML_put_table_row</a>(<a class="code" href="classString.html">String</a> rowparams, <a class="code" href="classString.html">String</a> rowcontent, <font class="keywordtype">bool</font> relaxedhtml = <font class="keyword">false</font>) {
02570         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a63">HTML_put_structure</a>(<font class="stringliteral">"TR"</font>,rowparams,rowcontent,relaxedhtml);
02571 }
02572 
<a name="l02573"></a><a class="code" href="utilities_8cc.html#a65">02573</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a65">HTML_put_table_cell</a>(<a class="code" href="classString.html">String</a> cellparams, <a class="code" href="classString.html">String</a> cellcontent, <font class="keywordtype">bool</font> relaxedhtml = <font class="keyword">false</font>) {
02574         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a63">HTML_put_structure</a>(<font class="stringliteral">"TD"</font>,cellparams,cellcontent,relaxedhtml);
02575 }
02576 
<a name="l02577"></a><a class="code" href="utilities_8cc.html#a66">02577</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a66">HTML_put_list</a>(<font class="keywordtype">char</font> listtype,<a class="code" href="classString.html">String</a> htmlstr) {
02578         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a63">HTML_put_structure</a>(listtype+<a class="code" href="classString.html">String</a>(<font class="stringliteral">"L"</font>),<font class="stringliteral">""</font>,htmlstr);
02579 }
02580 
<a name="l02581"></a><a class="code" href="utilities_8cc.html#a67">02581</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a67">HTML_put_list_item</a>(<a class="code" href="classString.html">String</a> htmlstr, <font class="keywordtype">bool</font> relaxedhtml = <font class="keyword">false</font>) {
02582         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a63">HTML_put_structure</a>(<font class="stringliteral">"LI"</font>,<font class="stringliteral">""</font>,htmlstr,relaxedhtml);
02583 }
02584 
<a name="l02585"></a><a class="code" href="utilities_8cc.html#a68">02585</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a68">HTML_put_href</a>(<a class="code" href="classString.html">String</a> hrefurl, <a class="code" href="classString.html">String</a> hreftext) {
02586         <font class="keywordflow">return</font> <font class="stringliteral">"&lt;A HREF=\""</font>+hrefurl+<font class="stringliteral">"\"&gt;"</font>+hreftext+<font class="stringliteral">"&lt;/A&gt;"</font>;
02587 }
02588 
<a name="l02589"></a><a class="code" href="utilities_8cc.html#a69">02589</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a69">HTML_put_name</a>(<a class="code" href="classString.html">String</a> nametag, <a class="code" href="classString.html">String</a> nametext) {
02590         <font class="keywordflow">return</font> <font class="stringliteral">"&lt;A NAME=\""</font>+nametag+<font class="stringliteral">"\"&gt;"</font>+nametext+<font class="stringliteral">"&lt;/A&gt;"</font>;
02591 }
02592 
<a name="l02593"></a><a class="code" href="utilities_8cc.html#a70">02593</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a70">HTML_put_form</a>(<a class="code" href="classString.html">String</a> formmethod, <a class="code" href="classString.html">String</a> formaction, <a class="code" href="classString.html">String</a> formcontent) {
02594         <font class="keywordflow">return</font> <font class="stringliteral">"&lt;FORM METHOD="</font>+formmethod+<font class="stringliteral">" ACTION=\""</font>+formaction+<font class="stringliteral">"\"&gt;"</font>+formcontent+<font class="stringliteral">"&lt;/FORM&gt;"</font>;
02595 }
02596 
<a name="l02597"></a><a class="code" href="utilities_8cc.html#a71">02597</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a71">HTML_put_form_input</a>(<a class="code" href="classString.html">String</a> inputtype, <a class="code" href="classString.html">String</a> inputargs) {
02598         <a class="code" href="classString.html">String</a> inputstr(<font class="stringliteral">"&lt;INPUT type=\""</font>+inputtype+<font class="charliteral">'"'</font>);
02599         <font class="keywordflow">if</font> (inputargs.<a class="code" href="classString.html#a105">length</a>()&gt;0) <font class="keywordflow">return</font> inputstr+<font class="charliteral">' '</font>+inputargs+<font class="charliteral">'&gt;'</font>;
02600         <font class="keywordflow">else</font> <font class="keywordflow">return</font> inputstr+<font class="charliteral">'&gt;'</font>;
02601 }
02602 
<a name="l02603"></a><a class="code" href="utilities_8cc.html#a72">02603</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a72">HTML_put_form_submit</a>(<a class="code" href="classString.html">String</a> submittext) {
02604         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a71">HTML_put_form_input</a>(<font class="stringliteral">"submit"</font>,<font class="stringliteral">"value=\""</font>+submittext+<font class="charliteral">'"'</font>);
02605 }
02606 
<a name="l02607"></a><a class="code" href="utilities_8cc.html#a73">02607</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a272">HTML_put_form_reset</a>() {
02608         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a71">HTML_put_form_input</a>(<font class="stringliteral">"reset"</font>,<font class="stringliteral">""</font>);
02609 }
02610 
<a name="l02611"></a><a class="code" href="utilities_8cc.html#a74">02611</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a74">HTML_put_form_radio</a>(<a class="code" href="classString.html">String</a> radioname, <a class="code" href="classString.html">String</a> radiovalue, <a class="code" href="classString.html">String</a> radiotext, <font class="keywordtype">bool</font> checked = <font class="keyword">false</font>) {
02612         <a class="code" href="classString.html">String</a> checkedstr;
02613         <font class="keywordflow">if</font> (checked) checkedstr = <font class="stringliteral">"\" checked"</font>; <font class="keywordflow">else</font> checkedstr = <font class="stringliteral">"\""</font>;
02614         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a71">HTML_put_form_input</a>(<font class="stringliteral">"radio"</font>,<font class="stringliteral">"name=\""</font>+radioname+<font class="stringliteral">"\" value=\""</font>+radiovalue+checkedstr)+<font class="charliteral">' '</font>+radiotext;
02615 }
02616 
<a name="l02617"></a><a class="code" href="utilities_8cc.html#a75">02617</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a75">HTML_put_form_checkbox</a>(<a class="code" href="classString.html">String</a> checkboxname, <a class="code" href="classString.html">String</a> checkboxvalue, <a class="code" href="classString.html">String</a> checkboxtext, <font class="keywordtype">bool</font> checked = <font class="keyword">false</font>) {
02618         <a class="code" href="classString.html">String</a> checkedstr;
02619         <font class="keywordflow">if</font> (checked) checkedstr = <font class="stringliteral">"\" checked"</font>; <font class="keywordflow">else</font> checkedstr = <font class="stringliteral">"\""</font>;
02620         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a71">HTML_put_form_input</a>(<font class="stringliteral">"checkbox"</font>,<font class="stringliteral">"name=\""</font>+checkboxname+<font class="stringliteral">"\" value=\""</font>+checkboxvalue+checkedstr)+<font class="charliteral">' '</font>+checkboxtext;
02621 }
02622 
<a name="l02623"></a><a class="code" href="utilities_8cc.html#a76">02623</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a77">HTML_put_form_text</a>(<a class="code" href="classString.html">String</a> textname, <a class="code" href="classString.html">String</a> textvalue, <font class="keywordtype">long</font> maxlen = -1) {
02624         textname += <font class="charliteral">'"'</font>;
02625         <font class="keywordflow">if</font> (textvalue.<a class="code" href="classString.html#a105">length</a>()&gt;0) textname += <font class="stringliteral">" value=\""</font> + textvalue + <font class="charliteral">'"'</font>;
02626         <font class="keywordflow">if</font> (maxlen&gt;0) textname += <font class="stringliteral">" maxlength="</font> + <a class="code" href="classString.html">String</a>(maxlen);
02627         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a71">HTML_put_form_input</a>(<font class="stringliteral">"text"</font>,<font class="stringliteral">"name=\""</font>+textname);
02628 }
02629 
<a name="l02630"></a><a class="code" href="utilities_8cc.html#a77">02630</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a77">HTML_put_form_text</a>(<a class="code" href="classString.html">String</a> textname, <font class="keywordtype">long</font> maxlen = -1) {
02631         <font class="keywordflow">return</font> <a class="code" href="utilities_8cc.html#a77">HTML_put_form_text</a>(textname,<font class="stringliteral">""</font>,maxlen);
02632 }
02633 
<a name="l02634"></a><a class="code" href="utilities_8cc.html#a78">02634</a> <font class="keywordtype">int</font> <a class="code" href="utilities_8cc.html#a78">Elipsis_At</a>(<a class="code" href="classString.html">String</a> &amp; s, <font class="keywordtype">int</font> maxsize) {
02635 <font class="comment">// returns the length of the resulting string</font>
02636         <font class="keywordflow">if</font> (s.<a class="code" href="classString.html#a105">length</a>()&gt;maxsize) {
02637                 s = s.<a class="code" href="classString.html#a58">before</a>(maxsize);
02638                 s = s.<a class="code" href="classString.html#a58">before</a>(<a class="code" href="classBigRegex.html">BigRegex</a>(<font class="stringliteral">"[        \n.,;:]"</font>),-1);
02639                 s += <font class="stringliteral">"..."</font>;
02640         }
02641         <font class="keywordflow">return</font> s.<a class="code" href="classString.html#a105">length</a>();
02642 }
02643 
<a name="l02644"></a><a class="code" href="utilities_8cc.html#a79">02644</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a79">URI_unescape</a>(<a class="code" href="classString.html">String</a> escapedURI) {
02645 <font class="comment">// convert URI strings with escaped characters to regular character strings</font>
02646         <a class="code" href="classString.html">String</a> s; <font class="keywordtype">char</font> c; <font class="keywordtype">int</font> d1,d2;
02647         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i&lt;escapedURI.<a class="code" href="classString.html#a105">length</a>(); i++) {
02648                 c = escapedURI[i];
02649                 <font class="keywordflow">if</font> (c==<font class="charliteral">'%'</font>) {
02650                         i++; c = escapedURI[i];
02651                         <font class="keywordflow">if</font> ((c&gt;=<font class="charliteral">'0'</font>) &amp;&amp; (c&lt;=<font class="charliteral">'9'</font>)) d1 = (int) (c - <font class="charliteral">'0'</font>);
02652                         <font class="keywordflow">else</font> <font class="keywordflow">if</font> ((c&gt;=<font class="charliteral">'A'</font>) &amp;&amp; (c&lt;=<font class="charliteral">'F'</font>)) d1 = ((int) (c - <font class="charliteral">'A'</font>)) + 10;
02653                         <font class="keywordflow">else</font> d1 = ((int) (c - <font class="charliteral">'a'</font>)) + 10;
02654                         i++; c = escapedURI[i];
02655                         <font class="keywordflow">if</font> ((c&gt;=<font class="charliteral">'0'</font>) &amp;&amp; (c&lt;=<font class="charliteral">'9'</font>)) d2 = (int) (c - <font class="charliteral">'0'</font>);
02656                         <font class="keywordflow">else</font> <font class="keywordflow">if</font> ((c&gt;=<font class="charliteral">'A'</font>) &amp;&amp; (c&lt;=<font class="charliteral">'F'</font>)) d2 = ((int) (c - <font class="charliteral">'A'</font>)) + 10;
02657                         <font class="keywordflow">else</font> d2 = ((int) (c - <font class="charliteral">'a'</font>)) + 10;
02658                         d1 *=16; d1 += d2;
02659                         c = (char) d1;
02660                 }
02661                 s += c;
02662         }
02663         <font class="keywordflow">return</font> s;
02664 }
02665 
<a name="l02666"></a><a class="code" href="utilities_8cc.html#a80">02666</a> <a class="code" href="classString.html">String</a> <a class="code" href="utilities_8cc.html#a80">Int2HexStr</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i) {
02667   <font class="comment">// convert integer to hexadecimal string</font>
02668   <a class="code" href="classString.html">String</a> s;
02669   <font class="keywordflow">if</font> (i==0) s = <font class="stringliteral">"0"</font>;
02670   <font class="keywordflow">else</font> {
02671     <font class="keywordflow">while</font> (i&gt;0) {
02672       <font class="keywordtype">int</font> j = i % 16; i = i / 16;
02673       <font class="keywordflow">if</font> (j&lt;10) s.<a class="code" href="classString.html#a22">prepend</a>((<font class="charliteral">'0'</font>+(<font class="keywordtype">char</font>) j));
02674       <font class="keywordflow">else</font> s.<a class="code" href="classString.html#a22">prepend</a>((<font class="charliteral">'A'</font>+(<font class="keywordtype">char</font>) (j-10)));
02675     }
02676   }
02677   <font class="keywordflow">return</font> s;
02678 }
02679 
<a name="l02680"></a><a class="code" href="utilities_8cc.html#a81">02680</a> <a class="code" href="classString.html">String</a> * <a class="code" href="utilities_8cc.html#a81">remove_whitespace</a>(<a class="code" href="classString.html">String</a> &amp; str) {
02681   str.<a class="code" href="classString.html#a89">gsub</a>(BRXwhite,<font class="stringliteral">" "</font>);
02682   <font class="keywordflow">return</font> &amp;str;
02683 }
02684 
<a name="l02685"></a><a class="code" href="utilities_8cc.html#a82">02685</a> <font class="keywordtype">double</font> <a class="code" href="utilities_8cc.html#a82">get_double</a>(<a class="code" href="classString.html">String</a> valstr, <font class="keywordtype">double</font> defval = 0.0, <font class="keywordtype">bool</font> * gotdouble = NULL) {
02686   <font class="comment">// attempts to extract a double variable value from a string</font>
02687   <font class="comment">// if no double variable value is found then the value defval is assigned</font>
02688   <font class="keywordtype">bool</font> gotdoubledummy;
02689   <font class="keywordflow">if</font> (!gotdouble) gotdouble = &amp;gotdoubledummy;
02690   <font class="keywordflow">if</font> (valstr.<a class="code" href="classString.html#a106">empty</a>()) { (*gotdouble) = <font class="keyword">false</font>; <font class="keywordflow">return</font> defval; }
02691   <font class="keywordflow">if</font> (((*gotdouble)=valstr.<a class="code" href="classString.html#a42">matches</a>(BRXdouble))==<font class="keyword">true</font>) <font class="keywordflow">return</font> atof((<font class="keyword">const</font> <font class="keywordtype">char</font> *) valstr);
02692   <font class="keywordflow">else</font> <font class="keywordflow">return</font> defval;
02693 }
</pre></div><hr><address align="right"><small>Generated on Mon Sep 13 14:53:11 2004 for dil2al by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
